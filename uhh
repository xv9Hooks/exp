--[[
    ╔═══════════════════════════════════════════════════════════════╗
    ║                     FlexsUI Library v3.0                      ║
    ║         Professional Mobile-Supported UI Library              ║
    ║                    Dark Theme | Executor Ready                ║
    ╚═══════════════════════════════════════════════════════════════╝
]]

local FlexsUI = {}
FlexsUI.Version = "3.0.0"
FlexsUI.Options = {}
FlexsUI.Themes = {}
FlexsUI.Unloaded = false
FlexsUI.OpenedFrames = {}

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local TextService = game:GetService("TextService")
local GuiService = game:GetService("GuiService")

local Player = Players.LocalPlayer
local Mouse = Player:GetMouse()

-- Platform Detection
local IsMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
local IsConsole = GuiService:IsTenFootInterface()

-- Default Themes
FlexsUI.Themes = {
    Dark = {
        Name = "Dark",
        
        -- Main Colors
        Background = Color3.fromRGB(15, 15, 20),
        BackgroundSecondary = Color3.fromRGB(20, 20, 28),
        BackgroundTertiary = Color3.fromRGB(25, 25, 35),
        
        -- Accent
        Accent = Color3.fromRGB(90, 120, 255),
        AccentDark = Color3.fromRGB(70, 100, 220),
        AccentLight = Color3.fromRGB(120, 150, 255),
        
        -- Text
        Text = Color3.fromRGB(240, 240, 245),
        TextSecondary = Color3.fromRGB(160, 160, 175),
        TextDisabled = Color3.fromRGB(100, 100, 115),
        
        -- Elements
        ElementBackground = Color3.fromRGB(28, 28, 38),
        ElementBackgroundHover = Color3.fromRGB(35, 35, 48),
        ElementBorder = Color3.fromRGB(45, 45, 60),
        
        -- Status Colors
        Success = Color3.fromRGB(80, 200, 120),
        Warning = Color3.fromRGB(255, 180, 60),
        Error = Color3.fromRGB(255, 80, 80),
        Info = Color3.fromRGB(80, 180, 255),
        
        -- Toggle
        ToggleBackground = Color3.fromRGB(40, 40, 55),
        ToggleEnabled = Color3.fromRGB(90, 120, 255),
        ToggleDisabled = Color3.fromRGB(60, 60, 80),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        -- Slider
        SliderBackground = Color3.fromRGB(35, 35, 50),
        SliderFill = Color3.fromRGB(90, 120, 255),
        
        -- Dropdown
        DropdownBackground = Color3.fromRGB(22, 22, 32),
        DropdownOptionHover = Color3.fromRGB(35, 35, 50),
        
        -- Scrollbar
        ScrollbarBackground = Color3.fromRGB(25, 25, 35),
        ScrollbarThumb = Color3.fromRGB(60, 60, 80),
        
        -- Transparency
        BackgroundTransparency = 0.05,
        ElementTransparency = 0.02
    },
    
    Darker = {
        Name = "Darker",
        
        Background = Color3.fromRGB(8, 8, 12),
        BackgroundSecondary = Color3.fromRGB(12, 12, 18),
        BackgroundTertiary = Color3.fromRGB(16, 16, 24),
        
        Accent = Color3.fromRGB(130, 80, 255),
        AccentDark = Color3.fromRGB(100, 60, 220),
        AccentLight = Color3.fromRGB(160, 110, 255),
        
        Text = Color3.fromRGB(235, 235, 240),
        TextSecondary = Color3.fromRGB(140, 140, 160),
        TextDisabled = Color3.fromRGB(80, 80, 100),
        
        ElementBackground = Color3.fromRGB(18, 18, 26),
        ElementBackgroundHover = Color3.fromRGB(25, 25, 35),
        ElementBorder = Color3.fromRGB(35, 35, 50),
        
        Success = Color3.fromRGB(70, 190, 110),
        Warning = Color3.fromRGB(245, 170, 50),
        Error = Color3.fromRGB(245, 70, 70),
        Info = Color3.fromRGB(70, 170, 245),
        
        ToggleBackground = Color3.fromRGB(30, 30, 45),
        ToggleEnabled = Color3.fromRGB(130, 80, 255),
        ToggleDisabled = Color3.fromRGB(50, 50, 70),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        SliderBackground = Color3.fromRGB(25, 25, 38),
        SliderFill = Color3.fromRGB(130, 80, 255),
        
        DropdownBackground = Color3.fromRGB(14, 14, 22),
        DropdownOptionHover = Color3.fromRGB(28, 28, 42),
        
        ScrollbarBackground = Color3.fromRGB(16, 16, 24),
        ScrollbarThumb = Color3.fromRGB(50, 50, 70),
        
        BackgroundTransparency = 0.02,
        ElementTransparency = 0.01
    },
    
    Midnight = {
        Name = "Midnight",
        
        Background = Color3.fromRGB(10, 12, 20),
        BackgroundSecondary = Color3.fromRGB(14, 16, 28),
        BackgroundTertiary = Color3.fromRGB(18, 22, 38),
        
        Accent = Color3.fromRGB(100, 140, 255),
        AccentDark = Color3.fromRGB(80, 120, 230),
        AccentLight = Color3.fromRGB(130, 170, 255),
        
        Text = Color3.fromRGB(230, 235, 250),
        TextSecondary = Color3.fromRGB(150, 160, 190),
        TextDisabled = Color3.fromRGB(90, 100, 130),
        
        ElementBackground = Color3.fromRGB(20, 24, 40),
        ElementBackgroundHover = Color3.fromRGB(28, 32, 52),
        ElementBorder = Color3.fromRGB(40, 48, 70),
        
        Success = Color3.fromRGB(80, 200, 140),
        Warning = Color3.fromRGB(255, 190, 70),
        Error = Color3.fromRGB(255, 90, 100),
        Info = Color3.fromRGB(90, 180, 255),
        
        ToggleBackground = Color3.fromRGB(30, 35, 55),
        ToggleEnabled = Color3.fromRGB(100, 140, 255),
        ToggleDisabled = Color3.fromRGB(50, 55, 80),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        SliderBackground = Color3.fromRGB(28, 32, 50),
        SliderFill = Color3.fromRGB(100, 140, 255),
        
        DropdownBackground = Color3.fromRGB(16, 18, 30),
        DropdownOptionHover = Color3.fromRGB(30, 35, 55),
        
        ScrollbarBackground = Color3.fromRGB(18, 22, 36),
        ScrollbarThumb = Color3.fromRGB(55, 65, 95),
        
        BackgroundTransparency = 0.03,
        ElementTransparency = 0.02
    },
    
    Ocean = {
        Name = "Ocean",
        
        Background = Color3.fromRGB(12, 18, 25),
        BackgroundSecondary = Color3.fromRGB(16, 24, 32),
        BackgroundTertiary = Color3.fromRGB(20, 30, 42),
        
        Accent = Color3.fromRGB(60, 180, 220),
        AccentDark = Color3.fromRGB(45, 150, 190),
        AccentLight = Color3.fromRGB(90, 210, 250),
        
        Text = Color3.fromRGB(230, 240, 250),
        TextSecondary = Color3.fromRGB(150, 175, 195),
        TextDisabled = Color3.fromRGB(90, 115, 135),
        
        ElementBackground = Color3.fromRGB(22, 32, 45),
        ElementBackgroundHover = Color3.fromRGB(30, 42, 58),
        ElementBorder = Color3.fromRGB(45, 60, 80),
        
        Success = Color3.fromRGB(70, 200, 150),
        Warning = Color3.fromRGB(255, 190, 80),
        Error = Color3.fromRGB(255, 95, 110),
        Info = Color3.fromRGB(80, 190, 255),
        
        ToggleBackground = Color3.fromRGB(30, 42, 58),
        ToggleEnabled = Color3.fromRGB(60, 180, 220),
        ToggleDisabled = Color3.fromRGB(45, 60, 80),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        SliderBackground = Color3.fromRGB(28, 38, 52),
        SliderFill = Color3.fromRGB(60, 180, 220),
        
        DropdownBackground = Color3.fromRGB(18, 26, 36),
        DropdownOptionHover = Color3.fromRGB(32, 45, 62),
        
        ScrollbarBackground = Color3.fromRGB(20, 28, 40),
        ScrollbarThumb = Color3.fromRGB(55, 75, 100),
        
        BackgroundTransparency = 0.03,
        ElementTransparency = 0.02
    },
    
    Purple = {
        Name = "Purple",
        
        Background = Color3.fromRGB(18, 12, 25),
        BackgroundSecondary = Color3.fromRGB(24, 16, 35),
        BackgroundTertiary = Color3.fromRGB(32, 22, 48),
        
        Accent = Color3.fromRGB(180, 100, 255),
        AccentDark = Color3.fromRGB(150, 75, 220),
        AccentLight = Color3.fromRGB(210, 140, 255),
        
        Text = Color3.fromRGB(245, 240, 255),
        TextSecondary = Color3.fromRGB(180, 165, 200),
        TextDisabled = Color3.fromRGB(120, 105, 145),
        
        ElementBackground = Color3.fromRGB(35, 25, 52),
        ElementBackgroundHover = Color3.fromRGB(45, 32, 68),
        ElementBorder = Color3.fromRGB(60, 45, 85),
        
        Success = Color3.fromRGB(100, 210, 140),
        Warning = Color3.fromRGB(255, 195, 85),
        Error = Color3.fromRGB(255, 100, 115),
        Info = Color3.fromRGB(120, 180, 255),
        
        ToggleBackground = Color3.fromRGB(45, 32, 65),
        ToggleEnabled = Color3.fromRGB(180, 100, 255),
        ToggleDisabled = Color3.fromRGB(60, 45, 85),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        SliderBackground = Color3.fromRGB(40, 28, 58),
        SliderFill = Color3.fromRGB(180, 100, 255),
        
        DropdownBackground = Color3.fromRGB(28, 18, 42),
        DropdownOptionHover = Color3.fromRGB(48, 35, 72),
        
        ScrollbarBackground = Color3.fromRGB(30, 20, 45),
        ScrollbarThumb = Color3.fromRGB(75, 55, 105),
        
        BackgroundTransparency = 0.03,
        ElementTransparency = 0.02
    },
    
    Rose = {
        Name = "Rose",
        
        Background = Color3.fromRGB(22, 14, 18),
        BackgroundSecondary = Color3.fromRGB(30, 18, 24),
        BackgroundTertiary = Color3.fromRGB(40, 24, 32),
        
        Accent = Color3.fromRGB(255, 100, 140),
        AccentDark = Color3.fromRGB(220, 75, 115),
        AccentLight = Color3.fromRGB(255, 140, 175),
        
        Text = Color3.fromRGB(255, 245, 248),
        TextSecondary = Color3.fromRGB(200, 175, 185),
        TextDisabled = Color3.fromRGB(140, 115, 125),
        
        ElementBackground = Color3.fromRGB(45, 28, 36),
        ElementBackgroundHover = Color3.fromRGB(58, 36, 46),
        ElementBorder = Color3.fromRGB(75, 50, 62),
        
        Success = Color3.fromRGB(100, 210, 150),
        Warning = Color3.fromRGB(255, 200, 90),
        Error = Color3.fromRGB(255, 110, 110),
        Info = Color3.fromRGB(130, 190, 255),
        
        ToggleBackground = Color3.fromRGB(55, 35, 45),
        ToggleEnabled = Color3.fromRGB(255, 100, 140),
        ToggleDisabled = Color3.fromRGB(75, 50, 62),
        ToggleIndicator = Color3.fromRGB(255, 255, 255),
        
        SliderBackground = Color3.fromRGB(50, 32, 42),
        SliderFill = Color3.fromRGB(255, 100, 140),
        
        DropdownBackground = Color3.fromRGB(35, 22, 28),
        DropdownOptionHover = Color3.fromRGB(60, 38, 48),
        
        ScrollbarBackground = Color3.fromRGB(38, 24, 32),
        ScrollbarThumb = Color3.fromRGB(85, 58, 72),
        
        BackgroundTransparency = 0.03,
        ElementTransparency = 0.02
    }
}

-- Active Theme
FlexsUI.CurrentTheme = FlexsUI.Themes.Dark

--[[ ═══════════════════════════════════════════════════════════════
                         UTILITY FUNCTIONS
═══════════════════════════════════════════════════════════════ ]]

local Utility = {}

function Utility.Create(class, properties)
    local instance = Instance.new(class)
    for prop, value in pairs(properties) do
        if prop ~= "Parent" then
            pcall(function()
                instance[prop] = value
            end)
        end
    end
    if properties.Parent then
        instance.Parent = properties.Parent
    end
    return instance
end

function Utility.Tween(instance, properties, duration, style, direction)
    local tween = TweenService:Create(
        instance,
        TweenInfo.new(
            duration or 0.25,
            style or Enum.EasingStyle.Quart,
            direction or Enum.EasingDirection.Out
        ),
        properties
    )
    tween:Play()
    return tween
end

function Utility.AddCorner(parent, radius)
    return Utility.Create("UICorner", {
        CornerRadius = UDim.new(0, radius or 8),
        Parent = parent
    })
end

function Utility.AddStroke(parent, color, thickness, transparency)
    return Utility.Create("UIStroke", {
        Color = color or FlexsUI.CurrentTheme.ElementBorder,
        Thickness = thickness or 1,
        Transparency = transparency or 0,
        ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
        Parent = parent
    })
end

function Utility.AddPadding(parent, top, bottom, left, right)
    return Utility.Create("UIPadding", {
        PaddingTop = UDim.new(0, top or 8),
        PaddingBottom = UDim.new(0, bottom or top or 8),
        PaddingLeft = UDim.new(0, left or top or 8),
        PaddingRight = UDim.new(0, right or left or top or 8),
        Parent = parent
    })
end

function Utility.AddListLayout(parent, padding, direction, hAlign, vAlign)
    return Utility.Create("UIListLayout", {
        Padding = UDim.new(0, padding or 6),
        FillDirection = direction or Enum.FillDirection.Vertical,
        HorizontalAlignment = hAlign or Enum.HorizontalAlignment.Center,
        VerticalAlignment = vAlign or Enum.VerticalAlignment.Top,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Parent = parent
    })
end

function Utility.AddGradient(parent, colors, rotation)
    return Utility.Create("UIGradient", {
        Color = colors or ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(200, 200, 200))
        }),
        Rotation = rotation or 90,
        Parent = parent
    })
end

function Utility.MakeDraggable(frame, handle)
    handle = handle or frame
    local dragging, dragInput, dragStart, startPos
    
    local function Update(input)
        local delta = input.Position - dragStart
        local newPos = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
        Utility.Tween(frame, {Position = newPos}, 0.08)
    end
    
    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            Update(input)
        end
    end)
end

function Utility.Ripple(button, x, y)
    local theme = FlexsUI.CurrentTheme
    
    local absPos = button.AbsolutePosition
    local absSize = button.AbsoluteSize
    
    local posX = x and (x - absPos.X) or (absSize.X / 2)
    local posY = y and (y - absPos.Y) or (absSize.Y / 2)
    
    local ripple = Utility.Create("Frame", {
        Name = "Ripple",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Color3.fromRGB(255, 255, 255),
        BackgroundTransparency = 0.75,
        Position = UDim2.new(0, posX, 0, posY),
        Size = UDim2.new(0, 0, 0, 0),
        ZIndex = 10,
        Parent = button
    })
    Utility.AddCorner(ripple, 999)
    
    local maxSize = math.max(absSize.X, absSize.Y) * 2.5
    
    local sizeTween = Utility.Tween(ripple, {
        Size = UDim2.new(0, maxSize, 0, maxSize),
        BackgroundTransparency = 1
    }, 0.5, Enum.EasingStyle.Quart)
    
    sizeTween.Completed:Wait()
    ripple:Destroy()
end

function Utility.GetTextBounds(text, font, size, width)
    local params = Instance.new("GetTextBoundsParams")
    params.Text = text
    params.Font = font or Font.fromEnum(Enum.Font.GothamMedium)
    params.Size = size or 14
    params.Width = width or math.huge
    
    local success, result = pcall(function()
        return TextService:GetTextBoundsAsync(params)
    end)
    
    if success then
        return result
    else
        return Vector2.new(#text * (size or 14) * 0.5, (size or 14) * 1.5)
    end
end

function Utility.DeepCopy(original)
    local copy = {}
    for k, v in pairs(original) do
        if type(v) == "table" then
            copy[k] = Utility.DeepCopy(v)
        else
            copy[k] = v
        end
    end
    return copy
end

--[[ ═══════════════════════════════════════════════════════════════
                         ICON LIBRARY
═══════════════════════════════════════════════════════════════ ]]

local Icons = {
    -- UI Icons
    close = "rbxassetid://7072725342",
    minimize = "rbxassetid://7072719338",
    maximize = "rbxassetid://7072718799",
    settings = "rbxassetid://7072706796",
    home = "rbxassetid://7072717857",
    search = "rbxassetid://7072707260",
    menu = "rbxassetid://7072717188",
    
    -- Action Icons
    check = "rbxassetid://7072706318",
    plus = "rbxassetid://7072720870",
    minus = "rbxassetid://7072719494",
    refresh = "rbxassetid://7072720247",
    download = "rbxassetid://7072707677",
    upload = "rbxassetid://7072725476",
    copy = "rbxassetid://7072706963",
    paste = "rbxassetid://7072720642",
    trash = "rbxassetid://7072725114",
    edit = "rbxassetid://7072707905",
    save = "rbxassetid://7072721559",
    folder = "rbxassetid://7072708754",
    file = "rbxassetid://7072708399",
    
    -- Arrow Icons
    chevron_up = "rbxassetid://7072706527",
    chevron_down = "rbxassetid://7072706429",
    chevron_left = "rbxassetid://7072706479",
    chevron_right = "rbxassetid://7072706570",
    arrow_up = "rbxassetid://7072705774",
    arrow_down = "rbxassetid://7072705578",
    arrow_left = "rbxassetid://7072705663",
    arrow_right = "rbxassetid://7072705888",
    
    -- Status Icons
    info = "rbxassetid://7072717277",
    warning = "rbxassetid://7072725598",
    error = "rbxassetid://7072725342",
    success = "rbxassetid://7072706318",
    
    -- Feature Icons
    user = "rbxassetid://7072725405",
    users = "rbxassetid://7072725544",
    star = "rbxassetid://7072723416",
    heart = "rbxassetid://7072717753",
    lock = "rbxassetid://7072718385",
    unlock = "rbxassetid://7072725278",
    eye = "rbxassetid://7072708176",
    eye_off = "rbxassetid://7072708074",
    bell = "rbxassetid://7072705984",
    clock = "rbxassetid://7072706768",
    calendar = "rbxassetid://7072706107",
    map = "rbxassetid://7072718949",
    globe = "rbxassetid://7072717473",
    zap = "rbxassetid://7072725870",
    shield = "rbxassetid://7072722007",
    target = "rbxassetid://7072723935",
    
    -- Game Icons
    gamepad = "rbxassetid://7072709084",
    play = "rbxassetid://7072720755",
    pause = "rbxassetid://7072720553",
    stop = "rbxassetid://7072723512",
    volume = "rbxassetid://7072725691",
    volume_off = "rbxassetid://7072725772",
    
    -- Misc
    command = "rbxassetid://7072706871",
    terminal = "rbxassetid://7072724075",
    code = "rbxassetid://7072706670",
    package = "rbxassetid://7072720343",
    layers = "rbxassetid://7072718169",
    layout = "rbxassetid://7072718248",
    grid = "rbxassetid://7072717617",
    list = "rbxassetid://7072718613",
    filter = "rbxassetid://7072708579",
    sliders = "rbxassetid://7072722547"
}

FlexsUI.Icons = Icons

function FlexsUI:GetIcon(name)
    return Icons[name] or Icons["info"]
end

--[[ ═══════════════════════════════════════════════════════════════
                         NOTIFICATION SYSTEM
═══════════════════════════════════════════════════════════════ ]]

local NotificationHolder = nil

function FlexsUI:Notify(config)
    config = config or {}
    local title = config.Title or "Notification"
    local content = config.Content or ""
    local subContent = config.SubContent or nil
    local duration = config.Duration or 5
    local notifType = config.Type or "Info"
    local callback = config.Callback or nil
    
    local theme = FlexsUI.CurrentTheme
    
    -- Create notification holder if not exists
    if not NotificationHolder or not NotificationHolder.Parent then
        local screenGui = FlexsUI._screenGui
        if not screenGui then return end
        
        NotificationHolder = Utility.Create("Frame", {
            Name = "NotificationHolder",
            AnchorPoint = Vector2.new(1, 1),
            BackgroundTransparency = 1,
            Position = UDim2.new(1, -20, 1, -20),
            Size = UDim2.new(0, 320, 1, -40),
            Parent = screenGui
        })
        
        Utility.AddListLayout(NotificationHolder, 10, Enum.FillDirection.Vertical, Enum.HorizontalAlignment.Right, Enum.VerticalAlignment.Bottom)
    end
    
    local typeColors = {
        Info = theme.Info,
        Success = theme.Success,
        Warning = theme.Warning,
        Error = theme.Error
    }
    
    local typeIcons = {
        Info = Icons.info,
        Success = Icons.check,
        Warning = Icons.warning,
        Error = Icons.error
    }
    
    local accentColor = typeColors[notifType] or theme.Accent
    local iconId = typeIcons[notifType] or Icons.info
    
    local contentHeight = subContent and 85 or 70
    
    local NotifFrame = Utility.Create("Frame", {
        Name = "Notification",
        BackgroundColor3 = theme.Background,
        BackgroundTransparency = theme.BackgroundTransparency,
        Size = UDim2.new(1, 0, 0, contentHeight),
        ClipsDescendants = true,
        Parent = NotificationHolder
    })
    Utility.AddCorner(NotifFrame, 10)
    Utility.AddStroke(NotifFrame, accentColor, 1, 0.5)
    
    -- Accent Line
    local AccentLine = Utility.Create("Frame", {
        Name = "AccentLine",
        BackgroundColor3 = accentColor,
        Size = UDim2.new(0, 4, 1, -16),
        Position = UDim2.new(0, 8, 0, 8),
        Parent = NotifFrame
    })
    Utility.AddCorner(AccentLine, 2)
    
    -- Icon
    local Icon = Utility.Create("ImageLabel", {
        Name = "Icon",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 22, 0, 12),
        Size = UDim2.new(0, 22, 0, 22),
        Image = iconId,
        ImageColor3 = accentColor,
        Parent = NotifFrame
    })
    
    -- Title
    local Title = Utility.Create("TextLabel", {
        Name = "Title",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 52, 0, 10),
        Size = UDim2.new(1, -100, 0, 22),
        Font = Enum.Font.GothamBold,
        Text = title,
        TextColor3 = theme.Text,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        Parent = NotifFrame
    })
    
    -- Content
    local Content = Utility.Create("TextLabel", {
        Name = "Content",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 52, 0, 34),
        Size = UDim2.new(1, -65, 0, 20),
        Font = Enum.Font.Gotham,
        Text = content,
        TextColor3 = theme.TextSecondary,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        TextTruncate = Enum.TextTruncate.AtEnd,
        Parent = NotifFrame
    })
    
    -- SubContent
    if subContent then
        local SubContent = Utility.Create("TextLabel", {
            Name = "SubContent",
            BackgroundTransparency = 1,
            Position = UDim2.new(0, 52, 0, 54),
            Size = UDim2.new(1, -65, 0, 18),
            Font = Enum.Font.Gotham,
            Text = subContent,
            TextColor3 = theme.TextDisabled,
            TextSize = 11,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            Parent = NotifFrame
        })
    end
    
    -- Close Button
    local CloseBtn = Utility.Create("TextButton", {
        Name = "CloseBtn",
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -35, 0, 8),
        Size = UDim2.new(0, 24, 0, 24),
        Text = "",
        Parent = NotifFrame
    })
    
    local CloseIcon = Utility.Create("ImageLabel", {
        BackgroundTransparency = 1,
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 16, 0, 16),
        Image = Icons.close,
        ImageColor3 = theme.TextSecondary,
        Parent = CloseBtn
    })
    
    -- Progress Bar
    local ProgressBar = Utility.Create("Frame", {
        Name = "ProgressBar",
        BackgroundColor3 = accentColor,
        BackgroundTransparency = 0.5,
        Position = UDim2.new(0, 0, 1, -3),
        Size = UDim2.new(1, 0, 0, 3),
        Parent = NotifFrame
    })
    
    -- Animations
    NotifFrame.Position = UDim2.new(1, 50, 0, 0)
    NotifFrame.Size = UDim2.new(1, 0, 0, 0)
    
    Utility.Tween(NotifFrame, {
        Position = UDim2.new(0, 0, 0, 0),
        Size = UDim2.new(1, 0, 0, contentHeight)
    }, 0.4, Enum.EasingStyle.Back)
    
    local function CloseNotif()
        Utility.Tween(NotifFrame, {
            Position = UDim2.new(1, 50, 0, 0),
            Size = UDim2.new(1, 0, 0, 0)
        }, 0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.In)
        task.wait(0.3)
        NotifFrame:Destroy()
    end
    
    CloseBtn.MouseButton1Click:Connect(CloseNotif)
    CloseBtn.MouseEnter:Connect(function()
        Utility.Tween(CloseIcon, {ImageColor3 = theme.Error}, 0.2)
    end)
    CloseBtn.MouseLeave:Connect(function()
        Utility.Tween(CloseIcon, {ImageColor3 = theme.TextSecondary}, 0.2)
    end)
    
    -- Auto close
    if duration and duration > 0 then
        Utility.Tween(ProgressBar, {Size = UDim2.new(0, 0, 0, 3)}, duration, Enum.EasingStyle.Linear)
        task.delay(duration, function()
            if NotifFrame and NotifFrame.Parent then
                CloseNotif()
                if callback then
                    pcall(callback)
                end
            end
        end)
    end
    
    return NotifFrame
end

--[[ ═══════════════════════════════════════════════════════════════
                         DIALOG SYSTEM
═══════════════════════════════════════════════════════════════ ]]

local ActiveDialog = nil

local function CreateDialog(parent, config)
    config = config or {}
    local title = config.Title or "Dialog"
    local content = config.Content or ""
    local buttons = config.Buttons or {}
    
    local theme = FlexsUI.CurrentTheme
    
    -- Close existing dialog
    if ActiveDialog and ActiveDialog.Parent then
        ActiveDialog:Destroy()
    end
    
    -- Overlay
    local DialogOverlay = Utility.Create("Frame", {
        Name = "DialogOverlay",
        BackgroundColor3 = Color3.fromRGB(0, 0, 0),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 100,
        Parent = parent
    })
    
    local DialogFrame = Utility.Create("Frame", {
        Name = "DialogFrame",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = theme.BackgroundSecondary,
        BackgroundTransparency = theme.BackgroundTransparency,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 340, 0, 0),
        ClipsDescendants = true,
        ZIndex = 101,
        Parent = DialogOverlay
    })
    Utility.AddCorner(DialogFrame, 12)
    Utility.AddStroke(DialogFrame, theme.ElementBorder, 1)
    
    -- Title
    local DialogTitle = Utility.Create("TextLabel", {
        Name = "Title",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 20, 0, 18),
        Size = UDim2.new(1, -40, 0, 24),
        Font = Enum.Font.GothamBold,
        Text = title,
        TextColor3 = theme.Text,
        TextSize = 16,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 102,
        Parent = DialogFrame
    })
    
    -- Content
    local DialogContent = Utility.Create("TextLabel", {
        Name = "Content",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 20, 0, 50),
        Size = UDim2.new(1, -40, 0, 50),
        Font = Enum.Font.Gotham,
        Text = content,
        TextColor3 = theme.TextSecondary,
        TextSize = 14,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        TextWrapped = true,
        ZIndex = 102,
        Parent = DialogFrame
    })
    
    -- Buttons Container
    local ButtonsContainer = Utility.Create("Frame", {
        Name = "Buttons",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 20, 0, 110),
        Size = UDim2.new(1, -40, 0, 36),
        ZIndex = 102,
        Parent = DialogFrame
    })
    
    local ButtonLayout = Utility.Create("UIListLayout", {
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Padding = UDim.new(0, 10),
        Parent = ButtonsContainer
    })
    
    local function CloseDialog()
        Utility.Tween(DialogOverlay, {BackgroundTransparency = 1}, 0.2)
        Utility.Tween(DialogFrame, {Size = UDim2.new(0, 340, 0, 0)}, 0.25, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        task.wait(0.25)
        DialogOverlay:Destroy()
        ActiveDialog = nil
    end
    
    -- Create buttons (reverse order for right alignment)
    for i = #buttons, 1, -1 do
        local btnConfig = buttons[i]
        local isPrimary = i == 1
        
        local Button = Utility.Create("TextButton", {
            Name = btnConfig.Title or "Button",
            BackgroundColor3 = isPrimary and theme.Accent or theme.ElementBackground,
            Size = UDim2.new(0, 90, 0, 32),
            Font = Enum.Font.GothamMedium,
            Text = btnConfig.Title or "Button",
            TextColor3 = isPrimary and Color3.fromRGB(255, 255, 255) or theme.Text,
            TextSize = 13,
            AutoButtonColor = false,
            ZIndex = 103,
            ClipsDescendants = true,
            Parent = ButtonsContainer
        })
        Utility.AddCorner(Button, 6)
        
        Button.MouseEnter:Connect(function()
            Utility.Tween(Button, {
                BackgroundColor3 = isPrimary and theme.AccentDark or theme.ElementBackgroundHover
            }, 0.15)
        end)
        
        Button.MouseLeave:Connect(function()
            Utility.Tween(Button, {
                BackgroundColor3 = isPrimary and theme.Accent or theme.ElementBackground
            }, 0.15)
        end)
        
        Button.MouseButton1Click:Connect(function()
            Utility.Ripple(Button)
            CloseDialog()
            if btnConfig.Callback then
                task.spawn(btnConfig.Callback)
            end
        end)
    end
    
    -- Animation
    Utility.Tween(DialogOverlay, {BackgroundTransparency = 0.5}, 0.3)
    Utility.Tween(DialogFrame, {Size = UDim2.new(0, 340, 0, 165)}, 0.35, Enum.EasingStyle.Back)
    
    ActiveDialog = DialogOverlay
    
    return DialogOverlay
end

--[[ ═══════════════════════════════════════════════════════════════
                         WINDOW CREATION
═══════════════════════════════════════════════════════════════ ]]

function FlexsUI:CreateWindow(config)
    config = config or {}
    
    local windowTitle = config.Title or "FlexsUI Window"
    local windowSubtitle = config.SubTitle or ""
    local windowSize = config.Size or UDim2.fromOffset(580, 460)
    local tabWidth = config.TabWidth or 160
    local acrylic = config.Acrylic ~= false
    local themeName = config.Theme or "Dark"
    local minimizeKey = config.MinimizeKey or Enum.KeyCode.RightControl
    local mobileScale = config.MobileScale or 0.9
    local minSize = config.MinSize or UDim2.fromOffset(450, 350)
    local maxSize = config.MaxSize or UDim2.fromOffset(800, 600)
    
    -- Apply theme
    if FlexsUI.Themes[themeName] then
        FlexsUI.CurrentTheme = FlexsUI.Themes[themeName]
    end
    
    local theme = FlexsUI.CurrentTheme
    
    -- Adjust size for mobile
    if IsMobile then
        local viewportSize = workspace.CurrentCamera.ViewportSize
        local scale = math.min(viewportSize.X / windowSize.X.Offset, viewportSize.Y / windowSize.Y.Offset) * mobileScale
        windowSize = UDim2.fromOffset(
            math.floor(windowSize.X.Offset * scale),
            math.floor(windowSize.Y.Offset * scale)
        )
        tabWidth = math.floor(tabWidth * scale * 0.85)
    end
    
    -- Main ScreenGui
    local ScreenGui = Utility.Create("ScreenGui", {
        Name = "FlexsUI_" .. tostring(math.random(100000, 999999)),
        DisplayOrder = 999,
        ResetOnSpawn = false,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        IgnoreGuiInset = true
    })
    
    -- Executor support
    if syn and syn.protect_gui then
        syn.protect_gui(ScreenGui)
        ScreenGui.Parent = CoreGui
    elseif gethui then
        ScreenGui.Parent = gethui()
    elseif KRNL_LOADED then
        ScreenGui.Parent = CoreGui
    else
        pcall(function()
            ScreenGui.Parent = CoreGui
        end)
        if not ScreenGui.Parent then
            ScreenGui.Parent = Player:WaitForChild("PlayerGui")
        end
    end
    
    FlexsUI._screenGui = ScreenGui
    
    -- Loading Screen
    local LoadingFrame = Utility.Create("Frame", {
        Name = "LoadingFrame",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = theme.Background,
        BackgroundTransparency = theme.BackgroundTransparency,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 280, 0, 140),
        Parent = ScreenGui
    })
    Utility.AddCorner(LoadingFrame, 12)
    Utility.AddStroke(LoadingFrame, theme.Accent, 2, 0.3)
    
    -- Loading Icon Container (animated)
    local LoadingIconContainer = Utility.Create("Frame", {
        Name = "IconContainer",
        AnchorPoint = Vector2.new(0.5, 0),
        BackgroundTransparency = 1,
        Position = UDim2.new(0.5, 0, 0, 25),
        Size = UDim2.new(0, 40, 0, 40),
        Parent = LoadingFrame
    })
    
    local LoadingIcon = Utility.Create("ImageLabel", {
        Name = "Icon",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundTransparency = 1,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 32, 0, 32),
        Image = Icons.zap,
        ImageColor3 = theme.Accent,
        Parent = LoadingIconContainer
    })
    
    -- Loading animation
    task.spawn(function()
        while LoadingFrame and LoadingFrame.Parent do
            Utility.Tween(LoadingIconContainer, {Rotation = 360}, 1, Enum.EasingStyle.Linear)
            task.wait(1)
            LoadingIconContainer.Rotation = 0
        end
    end)
    
    local LoadingTitle = Utility.Create("TextLabel", {
        Name = "Title",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 0, 0, 70),
        Size = UDim2.new(1, 0, 0, 25),
        Font = Enum.Font.GothamBold,
        Text = windowTitle,
        TextColor3 = theme.Text,
        TextSize = 18,
        Parent = LoadingFrame
    })
    
    local LoadingSubtitle = Utility.Create("TextLabel", {
        Name = "Subtitle",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 0, 0, 95),
        Size = UDim2.new(1, 0, 0, 18),
        Font = Enum.Font.Gotham,
        Text = "Yükleniyor...",
        TextColor3 = theme.TextSecondary,
        TextSize = 13,
        Parent = LoadingFrame
    })
    
    -- Loading Progress Bar
    local LoadingBarBG = Utility.Create("Frame", {
        Name = "ProgressBG",
        AnchorPoint = Vector2.new(0.5, 0),
        BackgroundColor3 = theme.ElementBackground,
        Position = UDim2.new(0.5, 0, 0, 118),
        Size = UDim2.new(0.75, 0, 0, 4),
        Parent = LoadingFrame
    })
    Utility.AddCorner(LoadingBarBG, 2)
    
    local LoadingBar = Utility.Create("Frame", {
        Name = "Progress",
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(0, 0, 1, 0),
        Parent = LoadingBarBG
    })
    Utility.AddCorner(LoadingBar, 2)
    
    -- Animate loading
    Utility.Tween(LoadingBar, {Size = UDim2.new(1, 0, 1, 0)}, 1.8, Enum.EasingStyle.Quart)
    task.wait(2)
    
    -- Fade out loading
    Utility.Tween(LoadingFrame, {BackgroundTransparency = 1, Size = UDim2.new(0, 300, 0, 160)}, 0.4)
    for _, child in pairs(LoadingFrame:GetDescendants()) do
        if child:IsA("TextLabel") then
            Utility.Tween(child, {TextTransparency = 1}, 0.3)
        elseif child:IsA("ImageLabel") then
            Utility.Tween(child, {ImageTransparency = 1}, 0.3)
        elseif child:IsA("Frame") then
            Utility.Tween(child, {BackgroundTransparency = 1}, 0.3)
        end
    end
    task.wait(0.4)
    LoadingFrame:Destroy()
    
    --[[ ═══════════════════════════════════════════════════════════════
                             MAIN WINDOW
    ═══════════════════════════════════════════════════════════════ ]]
    
    local MainFrame = Utility.Create("Frame", {
        Name = "MainFrame",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = theme.Background,
        BackgroundTransparency = theme.BackgroundTransparency,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        Size = UDim2.new(0, 0, 0, 0),
        ClipsDescendants = true,
        Parent = ScreenGui
    })
    Utility.AddCorner(MainFrame, 12)
    Utility.AddStroke(MainFrame, theme.ElementBorder, 1, 0.5)
    
    -- Acrylic/Blur Effect
    if acrylic then
        local Blur = Utility.Create("ImageLabel", {
            Name = "Blur",
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 1, 0),
            Image = "rbxassetid://8992230677",
            ImageColor3 = theme.Background,
            ImageTransparency = 0.7,
            ScaleType = Enum.ScaleType.Slice,
            SliceCenter = Rect.new(20, 20, 280, 280),
            ZIndex = -1,
            Parent = MainFrame
        })
    end
    
    -- Shadow
    local Shadow = Utility.Create("ImageLabel", {
        Name = "Shadow",
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundTransparency = 1,
        Position = UDim2.new(0.5, 0, 0.5, 4),
        Size = UDim2.new(1, 35, 1, 35),
        Image = "rbxassetid://6014261993",
        ImageColor3 = Color3.fromRGB(0, 0, 0),
        ImageTransparency = 0.45,
        ScaleType = Enum.ScaleType.Slice,
        SliceCenter = Rect.new(49, 49, 450, 450),
        ZIndex = -2,
        Parent = MainFrame
    })
    
    -- Open animation
    Utility.Tween(MainFrame, {Size = windowSize}, 0.5, Enum.EasingStyle.Back)
    task.wait(0.5)
    
    --[[ ═══════════════════════════════════════════════════════════════
                             TOP BAR
    ═══════════════════════════════════════════════════════════════ ]]
    
    local TopBar = Utility.Create("Frame", {
        Name = "TopBar",
        BackgroundColor3 = theme.BackgroundSecondary,
        BackgroundTransparency = theme.ElementTransparency,
        Size = UDim2.new(1, 0, 0, 45),
        Parent = MainFrame
    })
    Utility.AddCorner(TopBar, 12)
    
    -- Fix corner at bottom
    local TopBarFix = Utility.Create("Frame", {
        Name = "Fix",
        BackgroundColor3 = theme.BackgroundSecondary,
        BackgroundTransparency = theme.ElementTransparency,
        Position = UDim2.new(0, 0, 0.5, 0),
        Size = UDim2.new(1, 0, 0.5, 0),
        BorderSizePixel = 0,
        ZIndex = 0,
        Parent = TopBar
    })
    
    -- Logo
    local LogoContainer = Utility.Create("Frame", {
        Name = "LogoContainer",
        BackgroundColor3 = theme.Accent,
        Position = UDim2.new(0, 12, 0, 9),
        Size = UDim2.new(0, 28, 0, 28),
        Parent = TopBar
    })
    Utility.AddCorner(LogoContainer, 6)
    
    local LogoIcon = Utility.Create("TextLabel", {
        Name = "LogoIcon",
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Font = Enum.Font.GothamBold,
        Text = "F",
        TextColor3 = Color3.fromRGB(255, 255, 255),
        TextSize = 16,
        Parent = LogoContainer
    })
    
    -- Title
    local TitleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 50, 0, 6),
        Size = UDim2.new(0.5, -60, 0, 18),
        Font = Enum.Font.GothamBold,
        Text = windowTitle,
        TextColor3 = theme.Text,
        TextSize = 15,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        Parent = TopBar
    })
    
    -- Subtitle
    local SubtitleLabel = Utility.Create("TextLabel", {
        Name = "Subtitle",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 50, 0, 24),
        Size = UDim2.new(0.5, -60, 0, 14),
        Font = Enum.Font.Gotham,
        Text = windowSubtitle,
        TextColor3 = theme.TextSecondary,
        TextSize = 11,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        Parent = TopBar
    })
    
    -- Control Buttons Container
    local ControlsContainer = Utility.Create("Frame", {
        Name = "Controls",
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -110, 0, 0),
        Size = UDim2.new(0, 100, 1, 0),
        Parent = TopBar
    })
    
    local ControlsLayout = Utility.Create("UIListLayout", {
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Padding = UDim.new(0, 8),
        Parent = ControlsContainer
    })
    Utility.AddPadding(ControlsContainer, 0, 0, 0, 12)
    
    -- Close Button
    local CloseBtn = Utility.Create("TextButton", {
        Name = "CloseBtn",
        BackgroundColor3 = theme.Error,
        Size = UDim2.new(0, 20, 0, 20),
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = 3,
        Parent = ControlsContainer
    })
    Utility.AddCorner(CloseBtn, 10)
    
    -- Minimize Button  
    local MinimizeBtn = Utility.Create("TextButton", {
        Name = "MinimizeBtn",
        BackgroundColor3 = theme.Warning,
        Size = UDim2.new(0, 20, 0, 20),
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = 2,
        Parent = ControlsContainer
    })
    Utility.AddCorner(MinimizeBtn, 10)
    
    -- Size Toggle Button (for resizable windows)
    local SizeBtn = Utility.Create("TextButton", {
        Name = "SizeBtn",
        BackgroundColor3 = theme.Success,
        Size = UDim2.new(0, 20, 0, 20),
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = 1,
        Parent = ControlsContainer
    })
    Utility.AddCorner(SizeBtn, 10)
    
    -- Make draggable
    Utility.MakeDraggable(MainFrame, TopBar)
    
    -- Window state
    local isMinimized = false
    local isMaximized = false
    local originalSize = windowSize
    local originalPosition = MainFrame.Position
    
    -- Close functionality
    CloseBtn.MouseEnter:Connect(function()
        Utility.Tween(CloseBtn, {BackgroundColor3 = Color3.fromRGB(255, 100, 100), Size = UDim2.new(0, 22, 0, 22)}, 0.15)
    end)
    CloseBtn.MouseLeave:Connect(function()
        Utility.Tween(CloseBtn, {BackgroundColor3 = theme.Error, Size = UDim2.new(0, 20, 0, 20)}, 0.15)
    end)
    CloseBtn.MouseButton1Click:Connect(function()
        FlexsUI.Unloaded = true
        Utility.Tween(MainFrame, {Size = UDim2.new(0, 0, 0, 0), BackgroundTransparency = 1}, 0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        Utility.Tween(Shadow, {ImageTransparency = 1}, 0.3)
        task.wait(0.4)
        ScreenGui:Destroy()
    end)
    
    -- Minimize functionality
    MinimizeBtn.MouseEnter:Connect(function()
        Utility.Tween(MinimizeBtn, {BackgroundColor3 = Color3.fromRGB(255, 200, 80), Size = UDim2.new(0, 22, 0, 22)}, 0.15)
    end)
    MinimizeBtn.MouseLeave:Connect(function()
        Utility.Tween(MinimizeBtn, {BackgroundColor3 = theme.Warning, Size = UDim2.new(0, 20, 0, 20)}, 0.15)
    end)
    MinimizeBtn.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        if isMinimized then
            Utility.Tween(MainFrame, {Size = UDim2.new(0, windowSize.X.Offset, 0, 45)}, 0.3, Enum.EasingStyle.Quart)
        else
            Utility.Tween(MainFrame, {Size = isMaximized and UDim2.new(0.95, 0, 0.9, 0) or windowSize}, 0.3, Enum.EasingStyle.Quart)
        end
    end)
    
    -- Size toggle functionality
    SizeBtn.MouseEnter:Connect(function()
        Utility.Tween(SizeBtn, {BackgroundColor3 = Color3.fromRGB(100, 220, 140), Size = UDim2.new(0, 22, 0, 22)}, 0.15)
    end)
    SizeBtn.MouseLeave:Connect(function()
        Utility.Tween(SizeBtn, {BackgroundColor3 = theme.Success, Size = UDim2.new(0, 20, 0, 20)}, 0.15)
    end)
    SizeBtn.MouseButton1Click:Connect(function()
        isMaximized = not isMaximized
        if isMaximized then
            originalSize = MainFrame.Size
            originalPosition = MainFrame.Position
            Utility.Tween(MainFrame, {
                Size = UDim2.new(0.95, 0, 0.9, 0),
                Position = UDim2.new(0.5, 0, 0.5, 0)
            }, 0.3, Enum.EasingStyle.Quart)
        else
            Utility.Tween(MainFrame, {
                Size = originalSize,
                Position = originalPosition
            }, 0.3, Enum.EasingStyle.Quart)
        end
    end)
    
    -- Keyboard minimize
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if gameProcessed then return end
        if input.KeyCode == minimizeKey then
            isMinimized = not isMinimized
            MainFrame.Visible = not isMinimized
        end
    end)
    
    --[[ ═══════════════════════════════════════════════════════════════
                             MOBILE TOGGLE BUTTON
    ═══════════════════════════════════════════════════════════════ ]]
    
    local MobileToggle = nil
    if IsMobile then
        MobileToggle = Utility.Create("TextButton", {
            Name = "MobileToggle",
            AnchorPoint = Vector2.new(0, 1),
            BackgroundColor3 = theme.Accent,
            Position = UDim2.new(0, 15, 1, -15),
            Size = UDim2.new(0, 50, 0, 50),
            Text = "",
            AutoButtonColor = false,
            Parent = ScreenGui
        })
        Utility.AddCorner(MobileToggle, 25)
        Utility.AddStroke(MobileToggle, theme.AccentLight, 2, 0.5)
        
        local MobileIcon = Utility.Create("ImageLabel", {
            Name = "Icon",
            AnchorPoint = Vector2.new(0.5, 0.5),
            BackgroundTransparency = 1,
            Position = UDim2.new(0.5, 0, 0.5, 0),
            Size = UDim2.new(0, 26, 0, 26),
            Image = Icons.menu,
            ImageColor3 = Color3.fromRGB(255, 255, 255),
            Parent = MobileToggle
        })
        
        MobileToggle.MouseButton1Click:Connect(function()
            MainFrame.Visible = not MainFrame.Visible
            Utility.Tween(MobileToggle, {Rotation = MainFrame.Visible and 0 or 180}, 0.3)
            Utility.Tween(MobileIcon, {
                Image = MainFrame.Visible and Icons.close or Icons.menu
            }, 0.1)
        end)
    end
    
    --[[ ═══════════════════════════════════════════════════════════════
                             TAB CONTAINER
    ═══════════════════════════════════════════════════════════════ ]]
    
    local TabContainer = Utility.Create("Frame", {
        Name = "TabContainer",
        BackgroundColor3 = theme.BackgroundSecondary,
        BackgroundTransparency = theme.ElementTransparency,
        Position = UDim2.new(0, 0, 0, 45),
        Size = UDim2.new(0, tabWidth, 1, -45),
        BorderSizePixel = 0,
        ClipsDescendants = true,
        Parent = MainFrame
    })
    
    -- Tab Scroll
    local TabScroll = Utility.Create("ScrollingFrame", {
        Name = "TabScroll",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 0, 0, 8),
        Size = UDim2.new(1, 0, 1, -16),
        ScrollBarThickness = 2,
        ScrollBarImageColor3 = theme.ScrollbarThumb,
        ScrollBarImageTransparency = 0.3,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        Parent = TabContainer
    })
    
    local TabLayout = Utility.AddListLayout(TabScroll, 4, Enum.FillDirection.Vertical, Enum.HorizontalAlignment.Center)
    Utility.AddPadding(TabScroll, 4, 4, 8, 8)
    
    --[[ ═══════════════════════════════════════════════════════════════
                             CONTENT CONTAINER
    ═══════════════════════════════════════════════════════════════ ]]
    
    local ContentContainer = Utility.Create("Frame", {
        Name = "ContentContainer",
        BackgroundTransparency = 1,
        Position = UDim2.new(0, tabWidth + 8, 0, 53),
        Size = UDim2.new(1, -(tabWidth + 18), 1, -63),
        ClipsDescendants = true,
        Parent = MainFrame
    })
    
    --[[ ═══════════════════════════════════════════════════════════════
                             RESIZE HANDLE
    ═══════════════════════════════════════════════════════════════ ]]
    
    local ResizeHandle = Utility.Create("TextButton", {
        Name = "ResizeHandle",
        BackgroundTransparency = 1,
        Position = UDim2.new(1, -20, 1, -20),
        Size = UDim2.new(0, 20, 0, 20),
        Text = "",
        Parent = MainFrame
    })
    
    local ResizeIcon = Utility.Create("ImageLabel", {
        Name = "Icon",
        BackgroundTransparency = 1,
        Position = UDim2.new(0.2, 0, 0.2, 0),
        Size = UDim2.new(0.7, 0, 0.7, 0),
        Image = Icons.sliders,
        ImageColor3 = theme.TextDisabled,
        ImageTransparency = 0.5,
        Rotation = -45,
        Parent = ResizeHandle
    })
    
    -- Resize logic
    local resizing = false
    local resizeStart, sizeStart
    
    ResizeHandle.MouseEnter:Connect(function()
        Utility.Tween(ResizeIcon, {ImageTransparency = 0, ImageColor3 = theme.Accent}, 0.2)
    end)
    
    ResizeHandle.MouseLeave:Connect(function()
        if not resizing then
            Utility.Tween(ResizeIcon, {ImageTransparency = 0.5, ImageColor3 = theme.TextDisabled}, 0.2)
        end
    end)
    
    ResizeHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            resizing = true
            resizeStart = input.Position
            sizeStart = MainFrame.Size
        end
    end)
    
    ResizeHandle.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            resizing = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if resizing and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - resizeStart
            local newWidth = math.clamp(sizeStart.X.Offset + delta.X, minSize.X.Offset, maxSize.X.Offset)
            local newHeight = math.clamp(sizeStart.Y.Offset + delta.Y, minSize.Y.Offset, maxSize.Y.Offset)
            
            MainFrame.Size = UDim2.new(0, newWidth, 0, newHeight)
        end
    end)
    
    --[[ ═══════════════════════════════════════════════════════════════
                             WINDOW OBJECT
    ═══════════════════════════════════════════════════════════════ ]]
    
    local Window = {}
    Window.Tabs = {}
    Window.ActiveTab = nil
    Window.ScreenGui = ScreenGui
    Window.MainFrame = MainFrame
    
    -- Dialog method
    function Window:Dialog(config)
        return CreateDialog(MainFrame, config)
    end
    
    -- Select Tab method
    function Window:SelectTab(index)
        if type(index) == "number" then
            local tab = Window.Tabs[index]
            if tab and tab.Select then
                tab:Select()
            end
        elseif type(index) == "string" then
            for _, tab in pairs(Window.Tabs) do
                if tab.Name == index then
                    tab:Select()
                    break
                end
            end
        end
    end
    
    -- Set Theme method
    function Window:SetTheme(themeName)
        if FlexsUI.Themes[themeName] then
            FlexsUI.CurrentTheme = FlexsUI.Themes[themeName]
            -- Theme güncellemesi burada yapılabilir
        end
    end
    
    -- Destroy method
    function Window:Destroy()
        FlexsUI.Unloaded = true
        Utility.Tween(MainFrame, {Size = UDim2.new(0, 0, 0, 0)}, 0.4, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        task.wait(0.4)
        ScreenGui:Destroy()
    end
    
    -- Minimize method
    function Window:Minimize()
        isMinimized = true
        Utility.Tween(MainFrame, {Size = UDim2.new(0, windowSize.X.Offset, 0, 45)}, 0.3)
    end
    
    -- Restore method
    function Window:Restore()
        isMinimized = false
        MainFrame.Visible = true
        Utility.Tween(MainFrame, {Size = windowSize}, 0.3)
    end
    
    --[[ ═══════════════════════════════════════════════════════════════
                             ADD TAB FUNCTION
    ═══════════════════════════════════════════════════════════════ ]]
    
    function Window:AddTab(config)
        config = config or {}
        local tabName = config.Title or "Tab"
        local tabIcon = config.Icon or ""
        
        local theme = FlexsUI.CurrentTheme
        local Tab = {}
        Tab.Name = tabName
        Tab.Elements = {}
        
        -- Get icon
        local iconId = ""
        if tabIcon ~= "" then
            if Icons[tabIcon] then
                iconId = Icons[tabIcon]
            elseif string.match(tabIcon, "rbxassetid://") then
                iconId = tabIcon
            else
                iconId = Icons[tabIcon] or Icons.home
            end
        end
        
        -- Tab Button
        local TabButton = Utility.Create("TextButton", {
            Name = tabName,
            BackgroundColor3 = theme.ElementBackground,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 38),
            Text = "",
            AutoButtonColor = false,
            Parent = TabScroll
        })
        Utility.AddCorner(TabButton, 8)
        
        -- Tab Icon
        local TabIcon = nil
        local textOffset = 12
        
        if iconId ~= "" then
            TabIcon = Utility.Create("ImageLabel", {
                Name = "Icon",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 12, 0.5, -10),
                Size = UDim2.new(0, 20, 0, 20),
                Image = iconId,
                ImageColor3 = theme.TextSecondary,
                Parent = TabButton
            })
            textOffset = 40
        end
        
        -- Tab Label
        local TabLabel = Utility.Create("TextLabel", {
            Name = "Label",
            BackgroundTransparency = 1,
            Position = UDim2.new(0, textOffset, 0, 0),
            Size = UDim2.new(1, -(textOffset + 10), 1, 0),
            Font = Enum.Font.GothamMedium,
            Text = tabName,
            TextColor3 = theme.TextSecondary,
            TextSize = 13,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            Parent = TabButton
        })
        
        -- Active Indicator
        local ActiveIndicator = Utility.Create("Frame", {
            Name = "Indicator",
            BackgroundColor3 = theme.Accent,
            Position = UDim2.new(0, 3, 0.15, 0),
            Size = UDim2.new(0, 3, 0.7, 0),
            BackgroundTransparency = 1,
            Parent = TabButton
        })
        Utility.AddCorner(ActiveIndicator, 2)
        
        -- Tab Content
        local TabContent = Utility.Create("ScrollingFrame", {
            Name = tabName .. "_Content",
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 1, 0),
            ScrollBarThickness = 3,
            ScrollBarImageColor3 = theme.ScrollbarThumb,
            ScrollBarImageTransparency = 0.2,
            CanvasSize = UDim2.new(0, 0, 0, 0),
            AutomaticCanvasSize = Enum.AutomaticSize.Y,
            Visible = false,
            Parent = ContentContainer
        })
        
        local ContentLayout = Utility.AddListLayout(TabContent, 8)
        Utility.AddPadding(TabContent, 2, 10, 2, 6)
        
        Tab.Button = TabButton
        Tab.Content = TabContent
        Tab.Icon = TabIcon
        Tab.Label = TabLabel
        Tab.Indicator = ActiveIndicator
        
        -- Select Tab Function
        function Tab:Select()
            -- Deselect all tabs
            for _, t in pairs(Window.Tabs) do
                t.Content.Visible = false
                Utility.Tween(t.Button, {BackgroundTransparency = 1}, 0.2)
                Utility.Tween(t.Indicator, {BackgroundTransparency = 1}, 0.2)
                Utility.Tween(t.Label, {TextColor3 = theme.TextSecondary}, 0.2)
                if t.Icon then
                    Utility.Tween(t.Icon, {ImageColor3 = theme.TextSecondary}, 0.2)
                end
            end
            
            -- Select this tab
            TabContent.Visible = true
            Utility.Tween(TabButton, {BackgroundTransparency = 0}, 0.2)
            Utility.Tween(ActiveIndicator, {BackgroundTransparency = 0}, 0.2)
            Utility.Tween(TabLabel, {TextColor3 = theme.Text}, 0.2)
            if TabIcon then
                Utility.Tween(TabIcon, {ImageColor3 = theme.Accent}, 0.2)
            end
            
            Window.ActiveTab = Tab
        end
        
        -- Tab Button Events
        TabButton.MouseButton1Click:Connect(function()
            Tab:Select()
        end)
        
        TabButton.MouseEnter:Connect(function()
            if Window.ActiveTab ~= Tab then
                Utility.Tween(TabButton, {BackgroundTransparency = 0.5}, 0.15)
            end
        end)
        
        TabButton.MouseLeave:Connect(function()
            if Window.ActiveTab ~= Tab then
                Utility.Tween(TabButton, {BackgroundTransparency = 1}, 0.15)
            end
        end)
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 PARAGRAPH
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddParagraph(config)
            config = config or {}
            local title = config.Title or "Paragraph"
            local content = config.Content or ""
            
            local ParagraphFrame = Utility.Create("Frame", {
                Name = "Paragraph",
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, 0),
                AutomaticSize = Enum.AutomaticSize.Y,
                Parent = TabContent
            })
            Utility.AddCorner(ParagraphFrame, 8)
            Utility.AddStroke(ParagraphFrame, theme.ElementBorder, 1, 0.8)
            
            local ParagraphPadding = Utility.AddPadding(ParagraphFrame, 12, 12, 14, 14)
            
            local ParagraphTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 0, 18),
                Font = Enum.Font.GothamBold,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = ParagraphFrame
            })
            
            local ParagraphContent = Utility.Create("TextLabel", {
                Name = "Content",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, 22),
                Size = UDim2.new(1, 0, 0, 0),
                AutomaticSize = Enum.AutomaticSize.Y,
                Font = Enum.Font.Gotham,
                Text = content,
                TextColor3 = theme.TextSecondary,
                TextSize = 13,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextWrapped = true,
                Parent = ParagraphFrame
            })
            
            local ParagraphObject = {}
            
            function ParagraphObject:SetTitle(newTitle)
                ParagraphTitle.Text = newTitle
            end
            
            function ParagraphObject:SetContent(newContent)
                ParagraphContent.Text = newContent
            end
            
            return ParagraphObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 BUTTON
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddButton(config)
            config = config or {}
            local title = config.Title or "Button"
            local description = config.Description or nil
            local callback = config.Callback or function() end
            
            local buttonHeight = description and 58 or 42
            
            local ButtonFrame = Utility.Create("Frame", {
                Name = "Button_" .. title,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, buttonHeight),
                Parent = TabContent
            })
            Utility.AddCorner(ButtonFrame, 8)
            Utility.AddStroke(ButtonFrame, theme.ElementBorder, 1, 0.8)
            
            local ButtonTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(1, -110, 0, description and 20 or buttonHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = ButtonFrame
            })
            
            if description then
                local ButtonDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(1, -110, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = ButtonFrame
                })
            end
            
            local Button = Utility.Create("TextButton", {
                Name = "Button",
                BackgroundColor3 = theme.Accent,
                Position = UDim2.new(1, -90, 0.5, -15),
                Size = UDim2.new(0, 76, 0, 30),
                Font = Enum.Font.GothamMedium,
                Text = "Çalıştır",
                TextColor3 = Color3.fromRGB(255, 255, 255),
                TextSize = 12,
                AutoButtonColor = false,
                ClipsDescendants = true,
                Parent = ButtonFrame
            })
            Utility.AddCorner(Button, 6)
            
            Button.MouseEnter:Connect(function()
                Utility.Tween(Button, {BackgroundColor3 = theme.AccentDark}, 0.15)
            end)
            
            Button.MouseLeave:Connect(function()
                Utility.Tween(Button, {BackgroundColor3 = theme.Accent}, 0.15)
            end)
            
            Button.MouseButton1Click:Connect(function()
                Utility.Ripple(Button)
                task.spawn(callback)
            end)
            
            -- Touch support
            Button.TouchTap:Connect(function()
                Utility.Ripple(Button)
                task.spawn(callback)
            end)
            
            return ButtonFrame
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 TOGGLE
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddToggle(id, config)
            config = config or {}
            local title = config.Title or "Toggle"
            local description = config.Description or nil
            local default = config.Default or false
            local callback = config.Callback or function() end
            
            local toggled = default
            local toggleHeight = description and 58 or 42
            
            local ToggleFrame = Utility.Create("Frame", {
                Name = "Toggle_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, toggleHeight),
                Parent = TabContent
            })
            Utility.AddCorner(ToggleFrame, 8)
            Utility.AddStroke(ToggleFrame, theme.ElementBorder, 1, 0.8)
            
            local ToggleTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(1, -75, 0, description and 20 or toggleHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = ToggleFrame
            })
            
            if description then
                local ToggleDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(1, -75, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = ToggleFrame
                })
            end
            
            local ToggleBG = Utility.Create("TextButton", {
                Name = "ToggleBG",
                BackgroundColor3 = theme.ToggleBackground,
                Position = UDim2.new(1, -60, 0.5, -12),
                Size = UDim2.new(0, 46, 0, 24),
                Text = "",
                AutoButtonColor = false,
                Parent = ToggleFrame
            })
            Utility.AddCorner(ToggleBG, 12)
            
            local ToggleIndicator = Utility.Create("Frame", {
                Name = "Indicator",
                BackgroundColor3 = theme.ToggleIndicator,
                Position = UDim2.new(0, 3, 0.5, -9),
                Size = UDim2.new(0, 18, 0, 18),
                Parent = ToggleBG
            })
            Utility.AddCorner(ToggleIndicator, 9)
            
            -- Add shadow to indicator
            local IndicatorShadow = Utility.Create("ImageLabel", {
                Name = "Shadow",
                AnchorPoint = Vector2.new(0.5, 0.5),
                BackgroundTransparency = 1,
                Position = UDim2.new(0.5, 0, 0.5, 1),
                Size = UDim2.new(1, 6, 1, 6),
                Image = "rbxassetid://6014261993",
                ImageColor3 = Color3.fromRGB(0, 0, 0),
                ImageTransparency = 0.7,
                ScaleType = Enum.ScaleType.Slice,
                SliceCenter = Rect.new(49, 49, 450, 450),
                ZIndex = -1,
                Parent = ToggleIndicator
            })
            
            local function UpdateToggle(instant)
                local duration = instant and 0 or 0.2
                
                if toggled then
                    Utility.Tween(ToggleBG, {BackgroundColor3 = theme.ToggleEnabled}, duration)
                    Utility.Tween(ToggleIndicator, {Position = UDim2.new(1, -21, 0.5, -9)}, duration, Enum.EasingStyle.Back)
                else
                    Utility.Tween(ToggleBG, {BackgroundColor3 = theme.ToggleBackground}, duration)
                    Utility.Tween(ToggleIndicator, {Position = UDim2.new(0, 3, 0.5, -9)}, duration, Enum.EasingStyle.Back)
                end
            end
            
            -- Initial state
            if default then
                UpdateToggle(true)
            end
            
            ToggleBG.MouseButton1Click:Connect(function()
                toggled = not toggled
                UpdateToggle()
                task.spawn(callback, toggled)
            end)
            
            -- Touch support
            ToggleBG.TouchTap:Connect(function()
                toggled = not toggled
                UpdateToggle()
                task.spawn(callback, toggled)
            end)
            
            -- Toggle Object
            local ToggleObject = {}
            ToggleObject.Value = toggled
            
            function ToggleObject:SetValue(value)
                toggled = value
                ToggleObject.Value = value
                UpdateToggle()
            end
            
            function ToggleObject:OnChanged(func)
                callback = func
            end
            
            -- Register to Options
            FlexsUI.Options[id] = ToggleObject
            
            return ToggleObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 SLIDER
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddSlider(id, config)
            config = config or {}
            local title = config.Title or "Slider"
            local description = config.Description or nil
            local min = config.Min or 0
            local max = config.Max or 100
            local default = config.Default or min
            local rounding = config.Rounding or 0
            local callback = config.Callback or function() end
            
            local value = default
            local sliderHeight = description and 70 or 55
            
            local SliderFrame = Utility.Create("Frame", {
                Name = "Slider_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, sliderHeight),
                Parent = TabContent
            })
            Utility.AddCorner(SliderFrame, 8)
            Utility.AddStroke(SliderFrame, theme.ElementBorder, 1, 0.8)
            
            local SliderTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, 10),
                Size = UDim2.new(1, -80, 0, 18),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = SliderFrame
            })
            
            local SliderValue = Utility.Create("TextLabel", {
                Name = "Value",
                BackgroundTransparency = 1,
                Position = UDim2.new(1, -65, 0, 10),
                Size = UDim2.new(0, 55, 0, 18),
                Font = Enum.Font.GothamBold,
                Text = tostring(value),
                TextColor3 = theme.Accent,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Right,
                Parent = SliderFrame
            })
            
            if description then
                local SliderDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 28),
                    Size = UDim2.new(1, -28, 0, 16),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = SliderFrame
                })
            end
            
            local SliderBG = Utility.Create("Frame", {
                Name = "SliderBG",
                BackgroundColor3 = theme.SliderBackground,
                Position = UDim2.new(0, 14, 1, -22),
                Size = UDim2.new(1, -28, 0, 8),
                Parent = SliderFrame
            })
            Utility.AddCorner(SliderBG, 4)
            
            local SliderFill = Utility.Create("Frame", {
                Name = "Fill",
                BackgroundColor3 = theme.SliderFill,
                Size = UDim2.new((default - min) / (max - min), 0, 1, 0),
                Parent = SliderBG
            })
            Utility.AddCorner(SliderFill, 4)
            
            -- Gradient for fill
            local FillGradient = Utility.Create("UIGradient", {
                Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, theme.Accent),
                    ColorSequenceKeypoint.new(1, theme.AccentDark)
                }),
                Rotation = 0,
                Parent = SliderFill
            })
            
            local SliderKnob = Utility.Create("Frame", {
                Name = "Knob",
                AnchorPoint = Vector2.new(0.5, 0.5),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                Position = UDim2.new((default - min) / (max - min), 0, 0.5, 0),
                Size = UDim2.new(0, 16, 0, 16),
                ZIndex = 2,
                Parent = SliderBG
            })
            Utility.AddCorner(SliderKnob, 8)
            
            -- Knob shadow
            local KnobShadow = Utility.Create("ImageLabel", {
                Name = "Shadow",
                AnchorPoint = Vector2.new(0.5, 0.5),
                BackgroundTransparency = 1,
                Position = UDim2.new(0.5, 0, 0.5, 2),
                Size = UDim2.new(1, 8, 1, 8),
                Image = "rbxassetid://6014261993",
                ImageColor3 = Color3.fromRGB(0, 0, 0),
                ImageTransparency = 0.6,
                ScaleType = Enum.ScaleType.Slice,
                SliceCenter = Rect.new(49, 49, 450, 450),
                ZIndex = 1,
                Parent = SliderKnob
            })
            
            -- Slider input area
            local SliderInput = Utility.Create("TextButton", {
                Name = "Input",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 0, 0, -8),
                Size = UDim2.new(1, 0, 1, 16),
                Text = "",
                ZIndex = 3,
                Parent = SliderBG
            })
            
            local sliding = false
            
            local function Round(num, decimals)
                local mult = 10 ^ (decimals or 0)
                return math.floor(num * mult + 0.5) / mult
            end
            
            local function UpdateSlider(inputPos)
                local pos = math.clamp((inputPos - SliderBG.AbsolutePosition.X) / SliderBG.AbsoluteSize.X, 0, 1)
                value = Round(min + (max - min) * pos, rounding)
                
                SliderValue.Text = tostring(value)
                
                Utility.Tween(SliderFill, {Size = UDim2.new(pos, 0, 1, 0)}, 0.08)
                Utility.Tween(SliderKnob, {Position = UDim2.new(pos, 0, 0.5, 0)}, 0.08)
                
                task.spawn(callback, value)
            end
            
            SliderInput.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    sliding = true
                    UpdateSlider(input.Position.X)
                end
            end)
            
            SliderInput.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    sliding = false
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if sliding and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                    UpdateSlider(input.Position.X)
                end
            end)
            
            -- Slider Object
            local SliderObject = {}
            SliderObject.Value = value
            
            function SliderObject:SetValue(newValue)
                value = math.clamp(newValue, min, max)
                SliderObject.Value = value
                local pos = (value - min) / (max - min)
                SliderValue.Text = tostring(value)
                SliderFill.Size = UDim2.new(pos, 0, 1, 0)
                SliderKnob.Position = UDim2.new(pos, 0, 0.5, 0)
            end
            
            function SliderObject:OnChanged(func)
                callback = func
            end
            
            FlexsUI.Options[id] = SliderObject
            
            return SliderObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 DROPDOWN
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddDropdown(id, config)
            config = config or {}
            local title = config.Title or "Dropdown"
            local description = config.Description or nil
            local values = config.Values or {}
            local multi = config.Multi or false
            local default = config.Default or (multi and {} or values[1])
            local callback = config.Callback or function() end
            
            local opened = false
            local selected = multi and (type(default) == "table" and default or {}) or default
            local dropdownHeight = description and 58 or 42
            
            local DropdownFrame = Utility.Create("Frame", {
                Name = "Dropdown_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, dropdownHeight),
                ClipsDescendants = true,
                Parent = TabContent
            })
            Utility.AddCorner(DropdownFrame, 8)
            Utility.AddStroke(DropdownFrame, theme.ElementBorder, 1, 0.8)
            
            local DropdownTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(0.5, -20, 0, description and 20 or dropdownHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = DropdownFrame
            })
            
            if description then
                local DropdownDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(0.5, -20, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = DropdownFrame
                })
            end
            
            local DropdownButton = Utility.Create("TextButton", {
                Name = "Button",
                BackgroundColor3 = theme.DropdownBackground,
                Position = UDim2.new(0.5, 5, 0, description and 12 or 7),
                Size = UDim2.new(0.5, -20, 0, 28),
                Font = Enum.Font.Gotham,
                Text = "",
                AutoButtonColor = false,
                Parent = DropdownFrame
            })
            Utility.AddCorner(DropdownButton, 6)
            Utility.AddStroke(DropdownButton, theme.ElementBorder, 1, 0.7)
            
            local function GetDisplayText()
                if multi then
                    local count = 0
                    local names = {}
                    for value, state in pairs(selected) do
                        if state then
                            count = count + 1
                            table.insert(names, value)
                        end
                    end
                    if count == 0 then
                        return "Seçiniz..."
                    elseif count <= 2 then
                        return table.concat(names, ", ")
                    else
                        return count .. " seçili"
                    end
                else
                    return selected or "Seçiniz..."
                end
            end
            
            local DropdownText = Utility.Create("TextLabel", {
                Name = "Text",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -35, 1, 0),
                Font = Enum.Font.Gotham,
                Text = GetDisplayText(),
                TextColor3 = theme.TextSecondary,
                TextSize = 12,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextTruncate = Enum.TextTruncate.AtEnd,
                Parent = DropdownButton
            })
            
            local DropdownArrow = Utility.Create("ImageLabel", {
                Name = "Arrow",
                BackgroundTransparency = 1,
                Position = UDim2.new(1, -24, 0.5, -8),
                Size = UDim2.new(0, 16, 0, 16),
                Image = Icons.chevron_down,
                ImageColor3 = theme.TextSecondary,
                Parent = DropdownButton
            })
            
            local OptionsContainer = Utility.Create("Frame", {
                Name = "Options",
                BackgroundColor3 = theme.DropdownBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Position = UDim2.new(0, 10, 0, dropdownHeight + 5),
                Size = UDim2.new(1, -20, 0, 0),
                ClipsDescendants = true,
                Visible = false,
                Parent = DropdownFrame
            })
            Utility.AddCorner(OptionsContainer, 6)
            Utility.AddStroke(OptionsContainer, theme.ElementBorder, 1, 0.7)
            
            local OptionsScroll = Utility.Create("ScrollingFrame", {
                Name = "Scroll",
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 1, 0),
                ScrollBarThickness = 2,
                ScrollBarImageColor3 = theme.ScrollbarThumb,
                CanvasSize = UDim2.new(0, 0, 0, 0),
                AutomaticCanvasSize = Enum.AutomaticSize.Y,
                Parent = OptionsContainer
            })
            
            local OptionsLayout = Utility.AddListLayout(OptionsScroll, 2)
            Utility.AddPadding(OptionsScroll, 4, 4, 4, 4)
            
            local function CreateOption(optionValue)
                local isSelected = multi and selected[optionValue] or selected == optionValue
                
                local OptionButton = Utility.Create("TextButton", {
                    Name = optionValue,
                    BackgroundColor3 = theme.DropdownOptionHover,
                    BackgroundTransparency = isSelected and 0.5 or 1,
                    Size = UDim2.new(1, 0, 0, 30),
                    Font = Enum.Font.Gotham,
                    Text = "",
                    AutoButtonColor = false,
                    Parent = OptionsScroll
                })
                Utility.AddCorner(OptionButton, 4)
                
                local OptionText = Utility.Create("TextLabel", {
                    Name = "Text",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, multi and 30 or 10, 0, 0),
                    Size = UDim2.new(1, multi and -40 or -20, 1, 0),
                    Font = Enum.Font.Gotham,
                    Text = optionValue,
                    TextColor3 = isSelected and theme.Text or theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    Parent = OptionButton
                })
                
                local OptionCheck = nil
                if multi then
                    OptionCheck = Utility.Create("Frame", {
                        Name = "Check",
                        BackgroundColor3 = isSelected and theme.Accent or theme.ToggleBackground,
                        Position = UDim2.new(0, 8, 0.5, -8),
                        Size = UDim2.new(0, 16, 0, 16),
                        Parent = OptionButton
                    })
                    Utility.AddCorner(OptionCheck, 4)
                    
                    if isSelected then
                        local CheckIcon = Utility.Create("ImageLabel", {
                            Name = "Icon",
                            AnchorPoint = Vector2.new(0.5, 0.5),
                            BackgroundTransparency = 1,
                            Position = UDim2.new(0.5, 0, 0.5, 0),
                            Size = UDim2.new(0, 12, 0, 12),
                            Image = Icons.check,
                            ImageColor3 = Color3.fromRGB(255, 255, 255),
                            Parent = OptionCheck
                        })
                    end
                end
                
                OptionButton.MouseEnter:Connect(function()
                    Utility.Tween(OptionButton, {BackgroundTransparency = 0.3}, 0.15)
                end)
                
                OptionButton.MouseLeave:Connect(function()
                    local isNowSelected = multi and selected[optionValue] or selected == optionValue
                    Utility.Tween(OptionButton, {BackgroundTransparency = isNowSelected and 0.5 or 1}, 0.15)
                end)
                
                OptionButton.MouseButton1Click:Connect(function()
                    if multi then
                        selected[optionValue] = not selected[optionValue]
                        
                        local isNowSelected = selected[optionValue]
                        Utility.Tween(OptionButton, {BackgroundTransparency = isNowSelected and 0.5 or 1}, 0.15)
                        Utility.Tween(OptionText, {TextColor3 = isNowSelected and theme.Text or theme.TextSecondary}, 0.15)
                        
                        if OptionCheck then
                            Utility.Tween(OptionCheck, {BackgroundColor3 = isNowSelected and theme.Accent or theme.ToggleBackground}, 0.15)
                            
                            local existingIcon = OptionCheck:FindFirstChild("Icon")
                            if isNowSelected and not existingIcon then
                                local CheckIcon = Utility.Create("ImageLabel", {
                                    Name = "Icon",
                                    AnchorPoint = Vector2.new(0.5, 0.5),
                                    BackgroundTransparency = 1,
                                    Position = UDim2.new(0.5, 0, 0.5, 0),
                                    Size = UDim2.new(0, 0, 0, 0),
                                    Image = Icons.check,
                                    ImageColor3 = Color3.fromRGB(255, 255, 255),
                                    Parent = OptionCheck
                                })
                                Utility.Tween(CheckIcon, {Size = UDim2.new(0, 12, 0, 12)}, 0.2, Enum.EasingStyle.Back)
                            elseif not isNowSelected and existingIcon then
                                Utility.Tween(existingIcon, {Size = UDim2.new(0, 0, 0, 0)}, 0.15)
                                task.delay(0.15, function()
                                    if existingIcon then existingIcon:Destroy() end
                                end)
                            end
                        end
                        
                        DropdownText.Text = GetDisplayText()
                        task.spawn(callback, selected)
                    else
                        selected = optionValue
                        DropdownText.Text = optionValue
                        
                        -- Close dropdown
                        opened = false
                        Utility.Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, dropdownHeight)}, 0.25)
                        Utility.Tween(DropdownArrow, {Rotation = 0}, 0.25)
                        task.delay(0.1, function()
                            OptionsContainer.Visible = false
                        end)
                        
                        -- Update all options
                        for _, btn in pairs(OptionsScroll:GetChildren()) do
                            if btn:IsA("TextButton") then
                                local isSel = btn.Name == selected
                                Utility.Tween(btn, {BackgroundTransparency = isSel and 0.5 or 1}, 0.15)
                                local txt = btn:FindFirstChild("Text")
                                if txt then
                                    Utility.Tween(txt, {TextColor3 = isSel and theme.Text or theme.TextSecondary}, 0.15)
                                end
                            end
                        end
                        
                        task.spawn(callback, selected)
                    end
                end)
                
                return OptionButton
            end
            
            -- Create initial options
            for _, optionValue in ipairs(values) do
                CreateOption(optionValue)
            end
            
            -- Toggle dropdown
            local function ToggleDropdown()
                opened = not opened
                
                if opened then
                    local optionsHeight = math.min(#values * 32 + 10, 180)
                    OptionsContainer.Visible = true
                    Utility.Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, dropdownHeight + optionsHeight + 10)}, 0.25, Enum.EasingStyle.Quart)
                    Utility.Tween(OptionsContainer, {Size = UDim2.new(1, -20, 0, optionsHeight)}, 0.25)
                    Utility.Tween(DropdownArrow, {Rotation = 180}, 0.25)
                else
                    Utility.Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, dropdownHeight)}, 0.25)
                    Utility.Tween(OptionsContainer, {Size = UDim2.new(1, -20, 0, 0)}, 0.2)
                    Utility.Tween(DropdownArrow, {Rotation = 0}, 0.25)
                    task.delay(0.2, function()
                        if not opened then
                            OptionsContainer.Visible = false
                        end
                    end)
                end
            end
            
            DropdownButton.MouseButton1Click:Connect(ToggleDropdown)
            DropdownButton.TouchTap:Connect(ToggleDropdown)
            
            -- Dropdown Object
            local DropdownObject = {}
            DropdownObject.Value = selected
            
            function DropdownObject:SetValue(value)
                if multi then
                    selected = value
                else
                    selected = value
                end
                DropdownObject.Value = selected
                DropdownText.Text = GetDisplayText()
            end
            
            function DropdownObject:OnChanged(func)
                callback = func
            end
            
            function DropdownObject:Refresh(newValues)
                values = newValues
                
                for _, child in pairs(OptionsScroll:GetChildren()) do
                    if child:IsA("TextButton") then
                        child:Destroy()
                    end
                end
                
                for _, optionValue in ipairs(values) do
                    CreateOption(optionValue)
                end
            end
            
            FlexsUI.Options[id] = DropdownObject
            
            return DropdownObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 COLORPICKER
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddColorpicker(id, config)
            config = config or {}
            local title = config.Title or "Colorpicker"
            local description = config.Description or nil
            local default = config.Default or Color3.fromRGB(255, 255, 255)
            local transparency = config.Transparency or nil
            local callback = config.Callback or function() end
            
            local opened = false
            local currentColor = default
            local currentTransparency = transparency or 0
            local h, s, v = currentColor:ToHSV()
            
            local pickerHeight = description and 58 or 42
            
            local ColorFrame = Utility.Create("Frame", {
                Name = "Colorpicker_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, pickerHeight),
                ClipsDescendants = true,
                Parent = TabContent
            })
            Utility.AddCorner(ColorFrame, 8)
            Utility.AddStroke(ColorFrame, theme.ElementBorder, 1, 0.8)
            
            local ColorTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(1, -70, 0, description and 20 or pickerHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = ColorFrame
            })
            
            if description then
                local ColorDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(1, -70, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = ColorFrame
                })
            end
            
            local ColorPreview = Utility.Create("TextButton", {
                Name = "Preview",
                BackgroundColor3 = currentColor,
                Position = UDim2.new(1, -52, 0.5, -14),
                Size = UDim2.new(0, 38, 0, 28),
                Text = "",
                AutoButtonColor = false,
                Parent = ColorFrame
            })
            Utility.AddCorner(ColorPreview, 6)
            Utility.AddStroke(ColorPreview, theme.ElementBorder, 2, 0.5)
            
            -- Checker pattern for transparency preview
            if transparency ~= nil then
                local Checker = Utility.Create("ImageLabel", {
                    Name = "Checker",
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 1, 0),
                    Image = "rbxassetid://7514467909",
                    ImageTransparency = 0.8,
                    ScaleType = Enum.ScaleType.Tile,
                    TileSize = UDim2.new(0, 8, 0, 8),
                    ZIndex = -1,
                    Parent = ColorPreview
                })
                Utility.AddCorner(Checker, 6)
            end
            
            -- Picker Panel
            local PickerPanel = Utility.Create("Frame", {
                Name = "Panel",
                BackgroundColor3 = theme.BackgroundSecondary,
                BackgroundTransparency = theme.ElementTransparency,
                Position = UDim2.new(0, 10, 0, pickerHeight + 8),
                Size = UDim2.new(1, -20, 0, transparency ~= nil and 180 or 150),
                Visible = false,
                Parent = ColorFrame
            })
            Utility.AddCorner(PickerPanel, 8)
            Utility.AddStroke(PickerPanel, theme.ElementBorder, 1, 0.7)
            
            -- Saturation/Value Picker
            local SVPicker = Utility.Create("TextButton", {
                Name = "SVPicker",
                BackgroundColor3 = Color3.fromHSV(h, 1, 1),
                Position = UDim2.new(0, 10, 0, 10),
                Size = UDim2.new(1, -50, 0, 100),
                Text = "",
                AutoButtonColor = false,
                Parent = PickerPanel
            })
            Utility.AddCorner(SVPicker, 6)
            
            -- Saturation Gradient (White to Color)
            local SatGradient = Utility.Create("UIGradient", {
                Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 255, 255))
                }),
                Transparency = NumberSequence.new({
                    NumberSequenceKeypoint.new(0, 0),
                    NumberSequenceKeypoint.new(1, 1)
                }),
                Parent = SVPicker
            })
            
            -- Value Gradient (Transparent to Black)
            local ValOverlay = Utility.Create("Frame", {
                Name = "ValueOverlay",
                BackgroundColor3 = Color3.fromRGB(0, 0, 0),
                BackgroundTransparency = 0,
                Size = UDim2.new(1, 0, 1, 0),
                Parent = SVPicker
            })
            Utility.AddCorner(ValOverlay, 6)
            
            local ValGradient = Utility.Create("UIGradient", {
                Color = ColorSequence.new(Color3.fromRGB(0, 0, 0)),
                Transparency = NumberSequence.new({
                    NumberSequenceKeypoint.new(0, 1),
                    NumberSequenceKeypoint.new(1, 0)
                }),
                Rotation = 90,
                Parent = ValOverlay
            })
            
            -- SV Selector
            local SVSelector = Utility.Create("Frame", {
                Name = "Selector",
                AnchorPoint = Vector2.new(0.5, 0.5),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                Position = UDim2.new(s, 0, 1 - v, 0),
                Size = UDim2.new(0, 14, 0, 14),
                ZIndex = 5,
                Parent = SVPicker
            })
            Utility.AddCorner(SVSelector, 7)
            Utility.AddStroke(SVSelector, Color3.fromRGB(0, 0, 0), 2, 0.5)
            
            -- Hue Slider
            local HueSlider = Utility.Create("TextButton", {
                Name = "HueSlider",
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                Position = UDim2.new(1, -30, 0, 10),
                Size = UDim2.new(0, 20, 0, 100),
                Text = "",
                AutoButtonColor = false,
                Parent = PickerPanel
            })
            Utility.AddCorner(HueSlider, 4)
            
            local HueGradient = Utility.Create("UIGradient", {
                Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
                    ColorSequenceKeypoint.new(0.167, Color3.fromRGB(255, 255, 0)),
                    ColorSequenceKeypoint.new(0.333, Color3.fromRGB(0, 255, 0)),
                    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(0, 255, 255)),
                    ColorSequenceKeypoint.new(0.667, Color3.fromRGB(0, 0, 255)),
                    ColorSequenceKeypoint.new(0.833, Color3.fromRGB(255, 0, 255)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 0))
                }),
                Rotation = 90,
                Parent = HueSlider
            })
            
            -- Hue Selector
            local HueSelector = Utility.Create("Frame", {
                Name = "Selector",
                AnchorPoint = Vector2.new(0.5, 0.5),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                Position = UDim2.new(0.5, 0, h, 0),
                Size = UDim2.new(1, 4, 0, 6),
                ZIndex = 5,
                Parent = HueSlider
            })
            Utility.AddCorner(HueSelector, 3)
            Utility.AddStroke(HueSelector, Color3.fromRGB(0, 0, 0), 2, 0.5)
            
            -- Transparency Slider (if enabled)
            local TransSlider, TransSelector
            if transparency ~= nil then
                TransSlider = Utility.Create("TextButton", {
                    Name = "TransSlider",
                    BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                    Position = UDim2.new(0, 10, 0, 120),
                    Size = UDim2.new(1, -20, 0, 16),
                    Text = "",
                    AutoButtonColor = false,
                    Parent = PickerPanel
                })
                Utility.AddCorner(TransSlider, 4)
                
                -- Checker background
                local TransChecker = Utility.Create("ImageLabel", {
                    Name = "Checker",
                    BackgroundTransparency = 1,
                    Size = UDim2.new(1, 0, 1, 0),
                    Image = "rbxassetid://7514467909",
                    ImageTransparency = 0.5,
                    ScaleType = Enum.ScaleType.Tile,
                    TileSize = UDim2.new(0, 8, 0, 8),
                    ZIndex = -1,
                    Parent = TransSlider
                })
                Utility.AddCorner(TransChecker, 4)
                
                local TransGradient = Utility.Create("UIGradient", {
                    Color = ColorSequence.new(currentColor, currentColor),
                    Transparency = NumberSequence.new({
                        NumberSequenceKeypoint.new(0, 0),
                        NumberSequenceKeypoint.new(1, 1)
                    }),
                    Parent = TransSlider
                })
                
                TransSelector = Utility.Create("Frame", {
                    Name = "Selector",
                    AnchorPoint = Vector2.new(0.5, 0.5),
                    BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                    Position = UDim2.new(currentTransparency, 0, 0.5, 0),
                    Size = UDim2.new(0, 6, 1, 4),
                    ZIndex = 5,
                    Parent = TransSlider
                })
                Utility.AddCorner(TransSelector, 3)
                Utility.AddStroke(TransSelector, Color3.fromRGB(0, 0, 0), 2, 0.5)
                
                -- Transparency label
                local TransLabel = Utility.Create("TextLabel", {
                    Name = "Label",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 10, 0, 142),
                    Size = UDim2.new(1, -20, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = "Şeffaflık: " .. math.floor(currentTransparency * 100) .. "%",
                    TextColor3 = theme.TextSecondary,
                    TextSize = 11,
                    Parent = PickerPanel
                })
            end
            
            -- RGB Input
            local RGBContainer = Utility.Create("Frame", {
                Name = "RGBContainer",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 1, -35),
                Size = UDim2.new(1, -20, 0, 28),
                Parent = PickerPanel
            })
            
            local function CreateRGBInput(name, posX, defaultVal)
                local InputFrame = Utility.Create("Frame", {
                    Name = name,
                    BackgroundColor3 = theme.ElementBackground,
                    Position = UDim2.new(posX, 0, 0, 0),
                    Size = UDim2.new(0.3, -5, 1, 0),
                    Parent = RGBContainer
                })
                Utility.AddCorner(InputFrame, 4)
                
                local InputLabel = Utility.Create("TextLabel", {
                    Name = "Label",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 6, 0, 0),
                    Size = UDim2.new(0, 14, 1, 0),
                    Font = Enum.Font.GothamBold,
                    Text = name,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 10,
                    Parent = InputFrame
                })
                
                local Input = Utility.Create("TextBox", {
                    Name = "Input",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 22, 0, 0),
                    Size = UDim2.new(1, -26, 1, 0),
                    Font = Enum.Font.GothamMedium,
                    Text = tostring(defaultVal),
                    TextColor3 = theme.Text,
                    TextSize = 11,
                    ClearTextOnFocus = false,
                    Parent = InputFrame
                })
                
                return Input
            end
            
            local r, g, b = math.floor(currentColor.R * 255), math.floor(currentColor.G * 255), math.floor(currentColor.B * 255)
            local RInput = CreateRGBInput("R", 0, r)
            local GInput = CreateRGBInput("G", 0.35, g)
            local BInput = CreateRGBInput("B", 0.7, b)
            
            -- Hex input
            local HexFrame = Utility.Create("Frame", {
                Name = "Hex",
                BackgroundColor3 = theme.ElementBackground,
                Position = UDim2.new(0, 10, 1, -35),
                Size = UDim2.new(0, 70, 0, 28),
                Visible = false,
                Parent = PickerPanel
            })
            Utility.AddCorner(HexFrame, 4)
            
            -- Update functions
            local function UpdateColor()
                currentColor = Color3.fromHSV(h, s, v)
                r, g, b = math.floor(currentColor.R * 255), math.floor(currentColor.G * 255), math.floor(currentColor.B * 255)
                
                ColorPreview.BackgroundColor3 = currentColor
                ColorPreview.BackgroundTransparency = currentTransparency
                SVPicker.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
                
                RInput.Text = tostring(r)
                GInput.Text = tostring(g)
                BInput.Text = tostring(b)
                
                if TransSlider then
                    local transGrad = TransSlider:FindFirstChildOfClass("UIGradient")
                    if transGrad then
                        transGrad.Color = ColorSequence.new(currentColor, currentColor)
                    end
                    
                    local transLabel = PickerPanel:FindFirstChild("Label")
                    if transLabel then
                        transLabel.Text = "Şeffaflık: " .. math.floor(currentTransparency * 100) .. "%"
                    end
                end
                
                task.spawn(callback, currentColor, currentTransparency)
            end
            
            -- SV Picker input
            local draggingSV = false
            
            SVPicker.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    draggingSV = true
                end
            end)
            
            SVPicker.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    draggingSV = false
                end
            end)
            
            -- Hue Slider input
            local draggingHue = false
            
            HueSlider.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    draggingHue = true
                end
            end)
            
            HueSlider.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    draggingHue = false
                end
            end)
            
            -- Transparency Slider input
            local draggingTrans = false
            
            if TransSlider then
                TransSlider.InputBegan:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        draggingTrans = true
                    end
                end)
                
                TransSlider.InputEnded:Connect(function(input)
                    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                        draggingTrans = false
                    end
                end)
            end
            
            -- Global input handler
            UserInputService.InputChanged:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                    if draggingSV then
                        local posX = math.clamp((input.Position.X - SVPicker.AbsolutePosition.X) / SVPicker.AbsoluteSize.X, 0, 1)
                        local posY = math.clamp((input.Position.Y - SVPicker.AbsolutePosition.Y) / SVPicker.AbsoluteSize.Y, 0, 1)
                        
                        s = posX
                        v = 1 - posY
                        
                        SVSelector.Position = UDim2.new(posX, 0, posY, 0)
                        UpdateColor()
                    end
                    
                    if draggingHue then
                        local posY = math.clamp((input.Position.Y - HueSlider.AbsolutePosition.Y) / HueSlider.AbsoluteSize.Y, 0, 1)
                        
                        h = posY
                        
                        HueSelector.Position = UDim2.new(0.5, 0, posY, 0)
                        UpdateColor()
                    end
                    
                    if draggingTrans and TransSlider then
                        local posX = math.clamp((input.Position.X - TransSlider.AbsolutePosition.X) / TransSlider.AbsoluteSize.X, 0, 1)
                        
                        currentTransparency = posX
                        
                        TransSelector.Position = UDim2.new(posX, 0, 0.5, 0)
                        UpdateColor()
                    end
                end
            end)
            
            -- RGB Input handlers
            local function ValidateRGB(input, component)
                local val = tonumber(input.Text)
                if val then
                    val = math.clamp(math.floor(val), 0, 255)
                    input.Text = tostring(val)
                    
                    if component == "R" then r = val
                    elseif component == "G" then g = val
                    elseif component == "B" then b = val
                    end
                    
                    currentColor = Color3.fromRGB(r, g, b)
                    h, s, v = currentColor:ToHSV()
                    
                    SVPicker.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
                    SVSelector.Position = UDim2.new(s, 0, 1 - v, 0)
                    HueSelector.Position = UDim2.new(0.5, 0, h, 0)
                    ColorPreview.BackgroundColor3 = currentColor
                    
                    task.spawn(callback, currentColor, currentTransparency)
                end
            end
            
            RInput.FocusLost:Connect(function() ValidateRGB(RInput, "R") end)
            GInput.FocusLost:Connect(function() ValidateRGB(GInput, "G") end)
            BInput.FocusLost:Connect(function() ValidateRGB(BInput, "B") end)
            
            -- Toggle picker
            local function TogglePicker()
                opened = not opened
                
                if opened then
                    local panelHeight = transparency ~= nil and 180 or 150
                    PickerPanel.Visible = true
                    Utility.Tween(ColorFrame, {Size = UDim2.new(1, 0, 0, pickerHeight + panelHeight + 15)}, 0.25, Enum.EasingStyle.Quart)
                else
                    Utility.Tween(ColorFrame, {Size = UDim2.new(1, 0, 0, pickerHeight)}, 0.25, Enum.EasingStyle.Quart)
                    task.delay(0.15, function()
                        if not opened then
                            PickerPanel.Visible = false
                        end
                    end)
                end
            end
            
            ColorPreview.MouseButton1Click:Connect(TogglePicker)
            ColorPreview.TouchTap:Connect(TogglePicker)
            
            -- Colorpicker Object
            local ColorpickerObject = {}
            ColorpickerObject.Value = currentColor
            ColorpickerObject.Transparency = currentTransparency
            
            function ColorpickerObject:SetValueRGB(color)
                currentColor = color
                h, s, v = color:ToHSV()
                ColorpickerObject.Value = color
                
                SVPicker.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
                SVSelector.Position = UDim2.new(s, 0, 1 - v, 0)
                HueSelector.Position = UDim2.new(0.5, 0, h, 0)
                
                UpdateColor()
            end
            
            function ColorpickerObject:OnChanged(func)
                callback = func
            end
            
            FlexsUI.Options[id] = ColorpickerObject
            
            return ColorpickerObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 KEYBIND
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddKeybind(id, config)
            config = config or {}
            local title = config.Title or "Keybind"
            local description = config.Description or nil
            local mode = config.Mode or "Toggle" -- Always, Toggle, Hold
            local default = config.Default or "None"
            local callback = config.Callback or function() end
            local changedCallback = config.ChangedCallback or function() end
            
            local currentKey = default
            local listening = false
            local active = false
            local holding = false
            
            local keybindHeight = description and 58 or 42
            
            local KeybindFrame = Utility.Create("Frame", {
                Name = "Keybind_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, keybindHeight),
                Parent = TabContent
            })
            Utility.AddCorner(KeybindFrame, 8)
            Utility.AddStroke(KeybindFrame, theme.ElementBorder, 1, 0.8)
            
            local KeybindTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(1, -100, 0, description and 20 or keybindHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = KeybindFrame
            })
            
            if description then
                local KeybindDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(1, -100, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = KeybindFrame
                })
            end
            
            local KeybindButton = Utility.Create("TextButton", {
                Name = "Button",
                BackgroundColor3 = theme.ElementBackground,
                Position = UDim2.new(1, -90, 0.5, -14),
                Size = UDim2.new(0, 76, 0, 28),
                Font = Enum.Font.GothamMedium,
                Text = currentKey,
                TextColor3 = theme.Accent,
                TextSize = 12,
                AutoButtonColor = false,
                Parent = KeybindFrame
            })
            Utility.AddCorner(KeybindButton, 6)
            Utility.AddStroke(KeybindButton, theme.Accent, 1, 0.7)
            
            local function GetKeyName(keyCode)
                local keyName = keyCode.Name
                
                local specialNames = {
                    LeftControl = "LCtrl",
                    RightControl = "RCtrl",
                    LeftShift = "LShift",
                    RightShift = "RShift",
                    LeftAlt = "LAlt",
                    RightAlt = "RAlt",
                    Backquote = "`",
                    Minus = "-",
                    Equals = "=",
                    LeftBracket = "[",
                    RightBracket = "]",
                    Backslash = "\\",
                    Semicolon = ";",
                    Quote = "'",
                    Comma = ",",
                    Period = ".",
                    Slash = "/",
                    Space = "Space",
                    Return = "Enter"
                }
                
                return specialNames[keyName] or keyName
            end
            
            local function GetInputName(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    return "MB1"
                elseif input.UserInputType == Enum.UserInputType.MouseButton2 then
                    return "MB2"
                elseif input.UserInputType == Enum.UserInputType.MouseButton3 then
                    return "MB3"
                elseif input.KeyCode then
                    return GetKeyName(input.KeyCode)
                end
                return "None"
            end
            
            KeybindButton.MouseButton1Click:Connect(function()
                listening = true
                KeybindButton.Text = "..."
                Utility.Tween(KeybindButton, {BackgroundColor3 = theme.Accent, TextColor3 = Color3.fromRGB(255, 255, 255)}, 0.2)
            end)
            
            UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if listening then
                    if input.UserInputType == Enum.UserInputType.Keyboard then
                        if input.KeyCode == Enum.KeyCode.Escape then
                            currentKey = "None"
                        else
                            currentKey = GetKeyName(input.KeyCode)
                        end
                        
                        listening = false
                        KeybindButton.Text = currentKey
                        Utility.Tween(KeybindButton, {BackgroundColor3 = theme.ElementBackground, TextColor3 = theme.Accent}, 0.2)
                        
                        task.spawn(changedCallback, input.KeyCode)
                    elseif input.UserInputType == Enum.UserInputType.MouseButton1 or 
                           input.UserInputType == Enum.UserInputType.MouseButton2 or
                           input.UserInputType == Enum.UserInputType.MouseButton3 then
                        currentKey = GetInputName(input)
                        
                        listening = false
                        KeybindButton.Text = currentKey
                        Utility.Tween(KeybindButton, {BackgroundColor3 = theme.ElementBackground, TextColor3 = theme.Accent}, 0.2)
                        
                        task.spawn(changedCallback, input.UserInputType)
                    end
                    return
                end
                
                if gameProcessed then return end
                
                local inputName = GetInputName(input)
                
                if inputName == currentKey then
                    if mode == "Always" then
                        active = true
                        task.spawn(callback, true)
                    elseif mode == "Toggle" then
                        active = not active
                        task.spawn(callback, active)
                    elseif mode == "Hold" then
                        holding = true
                        active = true
                        task.spawn(callback, true)
                    end
                end
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if mode == "Hold" and holding then
                    local inputName = GetInputName(input)
                    if inputName == currentKey then
                        holding = false
                        active = false
                        task.spawn(callback, false)
                    end
                end
            end)
            
            -- Keybind Object
            local KeybindObject = {}
            KeybindObject.Value = currentKey
            
            function KeybindObject:SetValue(key, newMode)
                currentKey = key
                KeybindObject.Value = key
                KeybindButton.Text = key
                
                if newMode then
                    mode = newMode
                end
            end
            
            function KeybindObject:GetState()
                return active
            end
            
            function KeybindObject:OnClick(func)
                callback = func
            end
            
            function KeybindObject:OnChanged(func)
                changedCallback = func
            end
            
            FlexsUI.Options[id] = KeybindObject
            
            return KeybindObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 INPUT (TEXTBOX)
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddInput(id, config)
            config = config or {}
            local title = config.Title or "Input"
            local description = config.Description or nil
            local default = config.Default or ""
            local placeholder = config.Placeholder or "Yazın..."
            local numeric = config.Numeric or false
            local finished = config.Finished or false
            local callback = config.Callback or function() end
            
            local inputHeight = description and 58 or 42
            
            local InputFrame = Utility.Create("Frame", {
                Name = "Input_" .. id,
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, inputHeight),
                Parent = TabContent
            })
            Utility.AddCorner(InputFrame, 8)
            Utility.AddStroke(InputFrame, theme.ElementBorder, 1, 0.8)
            
            local InputTitle = Utility.Create("TextLabel", {
                Name = "Title",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 14, 0, description and 10 or 0),
                Size = UDim2.new(0.4, -20, 0, description and 20 or inputHeight),
                Font = Enum.Font.GothamMedium,
                Text = title,
                TextColor3 = theme.Text,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Parent = InputFrame
            })
            
            if description then
                local InputDesc = Utility.Create("TextLabel", {
                    Name = "Description",
                    BackgroundTransparency = 1,
                    Position = UDim2.new(0, 14, 0, 30),
                    Size = UDim2.new(0.4, -20, 0, 18),
                    Font = Enum.Font.Gotham,
                    Text = description,
                    TextColor3 = theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    TextTruncate = Enum.TextTruncate.AtEnd,
                    Parent = InputFrame
                })
            end
            
            local InputBoxFrame = Utility.Create("Frame", {
                Name = "InputBox",
                BackgroundColor3 = theme.DropdownBackground,
                Position = UDim2.new(0.4, 5, 0.5, -14),
                Size = UDim2.new(0.6, -20, 0, 28),
                Parent = InputFrame
            })
            Utility.AddCorner(InputBoxFrame, 6)
            Utility.AddStroke(InputBoxFrame, theme.ElementBorder, 1, 0.7)
            
            local InputBox = Utility.Create("TextBox", {
                Name = "Input",
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 10, 0, 0),
                Size = UDim2.new(1, -20, 1, 0),
                Font = Enum.Font.Gotham,
                Text = default,
                PlaceholderText = placeholder,
                PlaceholderColor3 = theme.TextDisabled,
                TextColor3 = theme.Text,
                TextSize = 12,
                ClearTextOnFocus = false,
                ClipsDescendants = true,
                Parent = InputBoxFrame
            })
            
            local stroke = InputBoxFrame:FindFirstChildOfClass("UIStroke")
            
            InputBox.Focused:Connect(function()
                if stroke then
                    Utility.Tween(stroke, {Color = theme.Accent, Transparency = 0}, 0.2)
                end
            end)
            
            InputBox.FocusLost:Connect(function(enterPressed)
                if stroke then
                    Utility.Tween(stroke, {Color = theme.ElementBorder, Transparency = 0.7}, 0.2)
                end
                
                if numeric then
                    local num = tonumber(InputBox.Text)
                    if not num then
                        InputBox.Text = default
                    end
                end
                
                if finished then
                    if enterPressed then
                        task.spawn(callback, InputBox.Text)
                    end
                else
                    task.spawn(callback, InputBox.Text)
                end
            end)
            
            if not finished then
                InputBox:GetPropertyChangedSignal("Text"):Connect(function()
                    if numeric then
                        InputBox.Text = InputBox.Text:gsub("[^%d%.%-]", "")
                    end
                    task.spawn(callback, InputBox.Text)
                end)
            end
            
            -- Input Object
            local InputObject = {}
            InputObject.Value = default
            
            function InputObject:SetValue(text)
                InputBox.Text = text
                InputObject.Value = text
            end
            
            function InputObject:OnChanged(func)
                callback = func
            end
            
            FlexsUI.Options[id] = InputObject
            
            return InputObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 LABEL
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddLabel(text)
            local LabelFrame = Utility.Create("TextLabel", {
                Name = "Label",
                BackgroundColor3 = theme.ElementBackground,
                BackgroundTransparency = theme.ElementTransparency,
                Size = UDim2.new(1, 0, 0, 32),
                Font = Enum.Font.Gotham,
                Text = text or "Label",
                TextColor3 = theme.TextSecondary,
                TextSize = 13,
                Parent = TabContent
            })
            Utility.AddCorner(LabelFrame, 6)
            Utility.AddPadding(LabelFrame, 0, 0, 14, 14)
            LabelFrame.TextXAlignment = Enum.TextXAlignment.Left
            
            local LabelObject = {}
            
            function LabelObject:SetText(newText)
                LabelFrame.Text = newText
            end
            
            return LabelObject
        end
        
        --[[ ═══════════════════════════════════════════════════════════════
                                 DIVIDER
        ═══════════════════════════════════════════════════════════════ ]]
        
        function Tab:AddDivider()
            local Divider = Utility.Create("Frame", {
                Name = "Divider",
                BackgroundColor3 = theme.ElementBorder,
                BackgroundTransparency = 0.5,
                Size = UDim2.new(1, 0, 0, 1),
                Parent = TabContent
            })
            
            return Divider
        end
        
        -- Select first tab
        if #Window.Tabs == 0 then
            task.defer(function()
                Tab:Select()
            end)
        end
        
        table.insert(Window.Tabs, Tab)
        
        return Tab
    end
    
    return Window
end

--[[ ═══════════════════════════════════════════════════════════════
                         SAVE MANAGER
═══════════════════════════════════════════════════════════════ ]]

local SaveManager = {}
SaveManager.Folder = "FlexsUI"
SaveManager.Ignore = {}
SaveManager.Library = nil

function SaveManager:SetLibrary(library)
    self.Library = library
end

function SaveManager:SetFolder(folder)
    self.Folder = folder
    self:BuildFolderTree()
end

function SaveManager:SetIgnoreIndexes(indexes)
    for _, index in pairs(indexes) do
        self.Ignore[index] = true
    end
end

function SaveManager:IgnoreThemeSettings()
    self:SetIgnoreIndexes({
        "InterfaceTheme",
        "InterfaceTransparency",
        "MenuKeybind"
    })
end

function SaveManager:BuildFolderTree()
    local paths = {
        self.Folder,
        self.Folder .. "/configs"
    }
    
    for _, path in pairs(paths) do
        if not isfolder(path) then
            makefolder(path)
        end
    end
end

function SaveManager:GetConfigs()
    local configs = {}
    local path = self.Folder .. "/configs"
    
    if isfolder(path) then
        for _, file in pairs(listfiles(path)) do
            local name = file:match("([^/\\]+)%.json$")
            if name then
                table.insert(configs, name)
            end
        end
    end
    
    return configs
end

function SaveManager:Save(name)
    local data = {}
    
    for id, option in pairs(self.Library.Options) do
        if not self.Ignore[id] then
            if option.Value ~= nil then
                if typeof(option.Value) == "Color3" then
                    data[id] = {
                        Type = "Color3",
                        Value = {option.Value.R, option.Value.G, option.Value.B}
                    }
                    if option.Transparency then
                        data[id].Transparency = option.Transparency
                    end
                elseif typeof(option.Value) == "EnumItem" then
                    data[id] = {
                        Type = "EnumItem",
                        Value = tostring(option.Value)
                    }
                elseif type(option.Value) == "table" then
                    data[id] = {
                        Type = "Table",
                        Value = option.Value
                    }
                else
                    data[id] = {
                        Type = type(option.Value),
                        Value = option.Value
                    }
                end
            end
        end
    end
    
    local path = self.Folder .. "/configs/" .. name .. ".json"
    local json = game:GetService("HttpService"):JSONEncode(data)
    
    writefile(path, json)
    
    return true
end

function SaveManager:Load(name)
    local path = self.Folder .. "/configs/" .. name .. ".json"
    
    if not isfile(path) then
        return false, "Config bulunamadı"
    end
    
    local success, data = pcall(function()
        return game:GetService("HttpService"):JSONDecode(readfile(path))
    end)
    
    if not success then
        return false, "Config okunamadı"
    end
    
    for id, info in pairs(data) do
        local option = self.Library.Options[id]
        
        if option and option.SetValue then
            local value = info.Value
            
            if info.Type == "Color3" then
                value = Color3.new(value[1], value[2], value[3])
                if info.Transparency and option.Transparency ~= nil then
                    option.Transparency = info.Transparency
                end
            elseif info.Type == "EnumItem" then
                local enumName, enumValue = value:match("Enum%.(%w+)%.(%w+)")
                if enumName and enumValue then
                    value = Enum[enumName][enumValue]
                end
            end
            
            pcall(function()
                option:SetValue(value)
            end)
        end
    end
    
    return true
end

function SaveManager:Delete(name)
    local path = self.Folder .. "/configs/" .. name .. ".json"
    
    if isfile(path) then
        delfile(path)
        return true
    end
    
    return false
end

function SaveManager:SetAutoload(name)
    local path = self.Folder .. "/autoload.txt"
    writefile(path, name)
end

function SaveManager:GetAutoload()
    local path = self.Folder .. "/autoload.txt"
    
    if isfile(path) then
        return readfile(path)
    end
    
    return nil
end

function SaveManager:LoadAutoloadConfig()
    local autoload = self:GetAutoload()
    
    if autoload then
        self:Load(autoload)
    end
end

function SaveManager:BuildConfigSection(tab)
    if not tab then return end
    
    local configList = self:GetConfigs()
    
    tab:AddDivider()
    
    tab:AddParagraph({
        Title = "📁 Konfigürasyon",
        Content = "Ayarlarınızı kaydedin ve yükleyin."
    })
    
    local ConfigDropdown = tab:AddDropdown("ConfigList", {
        Title = "Config Seç",
        Values = configList,
        Default = nil
    })
    
    local ConfigInput = tab:AddInput("ConfigName", {
        Title = "Config İsmi",
        Placeholder = "Config ismi girin...",
        Finished = true
    })
    
    tab:AddButton({
        Title = "Kaydet",
        Description = "Mevcut ayarları kaydet",
        Callback = function()
            local name = FlexsUI.Options["ConfigName"].Value
            
            if name and name ~= "" then
                local success = self:Save(name)
                
                if success then
                    FlexsUI:Notify({
                        Title = "Config Kaydedildi",
                        Content = name .. " başarıyla kaydedildi!",
                        Type = "Success",
                        Duration = 3
                    })
                    
                    ConfigDropdown:Refresh(self:GetConfigs())
                else
                    FlexsUI:Notify({
                        Title = "Hata",
                        Content = "Config kaydedilemedi!",
                        Type = "Error",
                        Duration = 3
                    })
                end
            else
                FlexsUI:Notify({
                    Title = "Hata",
                    Content = "Lütfen bir config ismi girin!",
                    Type = "Warning",
                    Duration = 3
                })
            end
        end
    })
    
    tab:AddButton({
        Title = "Yükle",
        Description = "Seçili config'i yükle",
        Callback = function()
            local name = FlexsUI.Options["ConfigList"].Value
            
            if name then
                local success, err = self:Load(name)
                
                if success then
                    FlexsUI:Notify({
                        Title = "Config Yüklendi",
                        Content = name .. " başarıyla yüklendi!",
                        Type = "Success",
                        Duration = 3
                    })
                else
                    FlexsUI:Notify({
                        Title = "Hata",
                        Content = err or "Config yüklenemedi!",
                        Type = "Error",
                        Duration = 3
                    })
                end
            else
                FlexsUI:Notify({
                    Title = "Hata",
                    Content = "Lütfen bir config seçin!",
                    Type = "Warning",
                    Duration = 3
                })
            end
        end
    })
    
    tab:AddButton({
        Title = "Yenile",
        Description = "Config listesini yenile",
        Callback = function()
            ConfigDropdown:Refresh(self:GetConfigs())
            
            FlexsUI:Notify({
                Title = "Yenilendi",
                Content = "Config listesi güncellendi!",
                Type = "Info",
                Duration = 2
            })
        end
    })
    
    tab:AddButton({
        Title = "Sil",
        Description = "Seçili config'i sil",
        Callback = function()
            local name = FlexsUI.Options["ConfigList"].Value
            
            if name then
                local success = self:Delete(name)
                
                if success then
                    FlexsUI:Notify({
                        Title = "Config Silindi",
                        Content = name .. " silindi!",
                        Type = "Success",
                        Duration = 3
                    })
                    
                    ConfigDropdown:Refresh(self:GetConfigs())
                else
                    FlexsUI:Notify({
                        Title = "Hata",
                        Content = "Config silinemedi!",
                        Type = "Error",
                        Duration = 3
                    })
                end
            end
        end
    })
    
    tab:AddToggle("AutoloadConfig", {
        Title = "Otomatik Yükle",
        Description = "Seçili config'i otomatik yükle",
        Default = false,
        Callback = function(value)
            if value then
                local name = FlexsUI.Options["ConfigList"].Value
                if name then
                    self:SetAutoload(name)
                    
                    FlexsUI:Notify({
                        Title = "Otomatik Yükleme",
                        Content = name .. " otomatik yüklenecek!",
                        Type = "Info",
                        Duration = 3
                    })
                end
            end
        end
    })
end

FlexsUI.SaveManager = SaveManager

--[[ ═══════════════════════════════════════════════════════════════
                         INTERFACE MANAGER
═══════════════════════════════════════════════════════════════ ]]

local InterfaceManager = {}
InterfaceManager.Folder = "FlexsUI"
InterfaceManager.Library = nil

function InterfaceManager:SetLibrary(library)
    self.Library = library
end

function InterfaceManager:SetFolder(folder)
    self.Folder = folder
    
    if not isfolder(folder) then
        makefolder(folder)
    end
end

function InterfaceManager:GetThemes()
    local themes = {}
    
    for name, _ in pairs(FlexsUI.Themes) do
        table.insert(themes, name)
    end
    
    return themes
end

function InterfaceManager:SetTheme(themeName)
    if FlexsUI.Themes[themeName] then
        FlexsUI.CurrentTheme = FlexsUI.Themes[themeName]
        
        -- Save preference
        local path = self.Folder .. "/theme.txt"
        writefile(path, themeName)
    end
end

function InterfaceManager:LoadSavedTheme()
    local path = self.Folder .. "/theme.txt"
    
    if isfile(path) then
        local themeName = readfile(path)
        self:SetTheme(themeName)
    end
end

function InterfaceManager:BuildInterfaceSection(tab)
    if not tab then return end
    
    tab:AddDivider()
    
    tab:AddParagraph({
        Title = "🎨 Arayüz Ayarları",
        Content = "Tema ve görünüm ayarlarını yapın."
    })
    
    local themes = self:GetThemes()
    
    tab:AddDropdown("InterfaceTheme", {
        Title = "Tema",
        Description = "Arayüz temasını seçin",
        Values = themes,
        Default = FlexsUI.CurrentTheme.Name,
        Callback = function(value)
            self:SetTheme(value)
            
            FlexsUI:Notify({
                Title = "Tema Değiştirildi",
                Content = value .. " teması uygulandı!",
                SubContent = "Değişiklikleri görmek için yeniden başlatın.",
                Type = "Info",
                Duration = 4
            })
        end
    })
    
    tab:AddLabel("ℹ️ Tema değişiklikleri yeniden başlatmada uygulanır.")
end

FlexsUI.InterfaceManager = InterfaceManager

--[[ ═══════════════════════════════════════════════════════════════
                         RETURN LIBRARY
═══════════════════════════════════════════════════════════════ ]]

return FlexsUI

