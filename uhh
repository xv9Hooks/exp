--[[
    NEXUS UI LIBRARY
    Modern, Dark Theme, Mobile & Executor Support
    Created for Professional Scripts
]]

local Library = {}
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Tema Ayarları
local Theme = {
    -- Ana Renkler
    Background = Color3.fromRGB(15, 15, 15),
    Secondary = Color3.fromRGB(25, 25, 25),
    Tertiary = Color3.fromRGB(35, 35, 35),
    Accent = Color3.fromRGB(120, 120, 255),
    
    -- Metin Renkleri
    TextPrimary = Color3.fromRGB(255, 255, 255),
    TextSecondary = Color3.fromRGB(180, 180, 180),
    TextDisabled = Color3.fromRGB(100, 100, 100),
    
    -- Border & Outline
    Border = Color3.fromRGB(45, 45, 45),
    BorderAccent = Color3.fromRGB(80, 80, 200),
    
    -- Özel Renkler
    Success = Color3.fromRGB(80, 200, 120),
    Warning = Color3.fromRGB(255, 200, 80),
    Error = Color3.fromRGB(255, 80, 80),
    
    -- Opacity
    BackgroundOpacity = 0.95,
    ElementOpacity = 0.9,
}

-- Utility Functions
local function CreateInstance(className, properties)
    local instance = Instance.new(className)
    for property, value in pairs(properties) do
        instance[property] = value
    end
    return instance
end

local function Tween(object, properties, duration, style, direction)
    style = style or Enum.EasingStyle.Quad
    direction = direction or Enum.EasingDirection.Out
    local tweenInfo = TweenInfo.new(duration, style, direction)
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    return tween
end

local function MakeDraggable(frame, dragHandle)
    local dragging, dragInput, dragStart, startPos
    
    dragHandle = dragHandle or frame
    
    local function update(input)
        local delta = input.Position - dragStart
        Tween(frame, {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}, 0.1)
    end
    
    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    dragHandle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

local function AddCorners(frame, radius)
    local corner = CreateInstance("UICorner", {
        CornerRadius = UDim.new(0, radius or 8),
        Parent = frame
    })
    return corner
end

local function AddStroke(frame, color, thickness)
    local stroke = CreateInstance("UIStroke", {
        Color = color or Theme.Border,
        Thickness = thickness or 1,
        ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
        Parent = frame
    })
    return stroke
end

-- Window Creation
function Library:CreateWindow(config)
    config = config or {}
    config.Title = config.Title or "Nexus UI"
    config.SubTitle = config.SubTitle or "by Developer"
    config.Size = config.Size or UDim2.fromOffset(580, 460)
    config.MinimizeKey = config.MinimizeKey or Enum.KeyCode.RightControl
    config.Acrylic = config.Acrylic or false
    
    -- Protection
    local ProtectGui = (syn and syn.protect_gui) or (gethui and gethui)
    local ParentUI = ProtectGui and ProtectGui() or CoreGui
    
    -- Main ScreenGui
    local ScreenGui = CreateInstance("ScreenGui", {
        Name = "NexusUI_" .. math.random(1000, 9999),
        Parent = ParentUI,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false
    })
    
    -- Main Window Frame
    local MainFrame = CreateInstance("Frame", {
        Name = "MainWindow",
        Size = config.Size,
        Position = UDim2.fromScale(0.5, 0.5),
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Theme.Background,
        BackgroundTransparency = 1 - Theme.BackgroundOpacity,
        BorderSizePixel = 0,
        Parent = ScreenGui
    })
    
    AddCorners(MainFrame, 12)
    AddStroke(MainFrame, Theme.BorderAccent, 1)
    
    -- Acrylic Effect (Blur)
    if config.Acrylic then
        local Blur = CreateInstance("BlurEffect", {
            Size = 8,
            Parent = game.Lighting
        })
    end
    
    -- Top Bar
    local TopBar = CreateInstance("Frame", {
        Name = "TopBar",
        Size = UDim2.new(1, 0, 0, 50),
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.05,
        BorderSizePixel = 0,
        Parent = MainFrame
    })
    
    AddCorners(TopBar, 12)
    
    -- Title
    local TitleLabel = CreateInstance("TextLabel", {
        Name = "Title",
        Size = UDim2.new(0, 200, 1, 0),
        Position = UDim2.fromOffset(15, 0),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Theme.TextPrimary,
        TextSize = 18,
        TextXAlignment = Enum.TextXAlignment.Left,
        Font = Enum.Font.GothamBold,
        Parent = TopBar
    })
    
    -- SubTitle
    local SubTitleLabel = CreateInstance("TextLabel", {
        Name = "SubTitle",
        Size = UDim2.new(0, 200, 0, 15),
        Position = UDim2.fromOffset(15, 30),
        BackgroundTransparency = 1,
        Text = config.SubTitle,
        TextColor3 = Theme.TextSecondary,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        Font = Enum.Font.Gotham,
        Parent = TopBar
    })
    
    -- Close Button
    local CloseButton = CreateInstance("TextButton", {
        Name = "CloseButton",
        Size = UDim2.fromOffset(35, 35),
        Position = UDim2.new(1, -45, 0.5, -17.5),
        BackgroundColor3 = Theme.Tertiary,
        BackgroundTransparency = 0.1,
        BorderSizePixel = 0,
        Text = "✕",
        TextColor3 = Theme.TextPrimary,
        TextSize = 18,
        Font = Enum.Font.GothamBold,
        Parent = TopBar
    })
    
    AddCorners(CloseButton, 8)
    
    CloseButton.MouseButton1Click:Connect(function()
        Tween(MainFrame, {Size = UDim2.fromOffset(0, 0)}, 0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        task.wait(0.3)
        ScreenGui:Destroy()
    end)
    
    -- Minimize Button
    local MinimizeButton = CreateInstance("TextButton", {
        Name = "MinimizeButton",
        Size = UDim2.fromOffset(35, 35),
        Position = UDim2.new(1, -85, 0.5, -17.5),
        BackgroundColor3 = Theme.Tertiary,
        BackgroundTransparency = 0.1,
        BorderSizePixel = 0,
        Text = "─",
        TextColor3 = Theme.TextPrimary,
        TextSize = 18,
        Font = Enum.Font.GothamBold,
        Parent = TopBar
    })
    
    AddCorners(MinimizeButton, 8)
    
    local isMinimized = false
    local originalSize = config.Size
    
    MinimizeButton.MouseButton1Click:Connect(function()
        isMinimized = not isMinimized
        if isMinimized then
            Tween(MainFrame, {Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset, 0, 50)}, 0.3)
        else
            Tween(MainFrame, {Size = originalSize}, 0.3)
        end
    end)
    
    -- Tab Container
    local TabContainer = CreateInstance("Frame", {
        Name = "TabContainer",
        Size = UDim2.new(0, config.TabWidth or 160, 1, -60),
        Position = UDim2.fromOffset(5, 55),
        BackgroundColor3 = Theme.Secondary,
        BackgroundTransparency = 0.05,
        BorderSizePixel = 0,
        Parent = MainFrame
    })
    
    AddCorners(TabContainer, 10)
    
    local TabList = CreateInstance("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5),
        Parent = TabContainer
    })
    
    CreateInstance("UIPadding", {
        PaddingTop = UDim.new(0, 8),
        PaddingLeft = UDim.new(0, 8),
        PaddingRight = UDim.new(0, 8),
        PaddingBottom = UDim.new(0, 8),
        Parent = TabContainer
    })
    
    -- Content Container
    local ContentContainer = CreateInstance("Frame", {
        Name = "ContentContainer",
        Size = UDim2.new(1, -(config.TabWidth or 160) - 15, 1, -60),
        Position = UDim2.fromOffset((config.TabWidth or 160) + 10, 55),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Parent = MainFrame
    })
    
    -- Make Window Draggable
    MakeDraggable(MainFrame, TopBar)
    
    -- Window Object
    local Window = {
        ScreenGui = ScreenGui,
        MainFrame = MainFrame,
        TabContainer = TabContainer,
        ContentContainer = ContentContainer,
        Tabs = {},
        CurrentTab = nil,
        MinimizeKey = config.MinimizeKey
    }
    
    -- Minimize KeyBind
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == config.MinimizeKey then
            isMinimized = not isMinimized
            if isMinimized then
                Tween(MainFrame, {Size = UDim2.new(originalSize.X.Scale, originalSize.X.Offset, 0, 50)}, 0.3)
            else
                Tween(MainFrame, {Size = originalSize}, 0.3)
            end
        end
    end)
    
    -- Add Tab Function
    function Window:AddTab(tabConfig)
        tabConfig = tabConfig or {}
        tabConfig.Title = tabConfig.Title or "Tab"
        tabConfig.Icon = tabConfig.Icon or ""
        
        -- Tab Button
        local TabButton = CreateInstance("TextButton", {
            Name = tabConfig.Title,
            Size = UDim2.new(1, 0, 0, 40),
            BackgroundColor3 = Theme.Tertiary,
            BackgroundTransparency = 0.3,
            BorderSizePixel = 0,
            Text = "",
            AutoButtonColor = false,
            Parent = TabContainer
        })
        
        AddCorners(TabButton, 8)
        
        -- Tab Icon
        if tabConfig.Icon ~= "" then
            local TabIcon = CreateInstance("ImageLabel", {
                Name = "Icon",
                Size = UDim2.fromOffset(20, 20),
                Position = UDim2.fromOffset(10, 10),
                BackgroundTransparency = 1,
                Image = "rbxassetid://" .. tabConfig.Icon,
                ImageColor3 = Theme.TextSecondary,
                Parent = TabButton
            })
        end
        
        -- Tab Title
        local TabTitle = CreateInstance("TextLabel", {
            Name = "Title",
            Size = UDim2.new(1, tabConfig.Icon ~= "" and -40 or -20, 1, 0),
            Position = UDim2.fromOffset(tabConfig.Icon ~= "" and 40 or 10, 0),
            BackgroundTransparency = 1,
            Text = tabConfig.Title,
            TextColor3 = Theme.TextSecondary,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left,
            Font = Enum.Font.GothamSemibold,
            Parent = TabButton
        })
        
        -- Tab Content Frame
        local TabContent = CreateInstance("ScrollingFrame", {
            Name = tabConfig.Title .. "Content",
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            ScrollBarThickness = 4,
            ScrollBarImageColor3 = Theme.Accent,
            CanvasSize = UDim2.fromOffset(0, 0),
            Visible = false,
            Parent = ContentContainer
        })
        
        local ContentList = CreateInstance("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 8),
            Parent = TabContent
        })
        
        CreateInstance("UIPadding", {
            PaddingTop = UDim.new(0, 8),
            PaddingLeft = UDim.new(0, 8),
            PaddingRight = UDim.new(0, 8),
            PaddingBottom = UDim.new(0, 8),
            Parent = TabContent
        })
        
        -- Auto-resize Canvas
        ContentList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            TabContent.CanvasSize = UDim2.fromOffset(0, ContentList.AbsoluteContentSize.Y + 16)
        end)
        
        -- Tab Object
        local Tab = {
            Button = TabButton,
            Content = TabContent,
            Title = TabTitle,
            Window = Window
        }
        
        -- Tab Click
        TabButton.MouseButton1Click:Connect(function()
            Window:SelectTab(Tab)
        end)
        
        -- Hover Effect
        TabButton.MouseEnter:Connect(function()
            if Window.CurrentTab ~= Tab then
                Tween(TabButton, {BackgroundTransparency = 0.1}, 0.2)
            end
        end)
        
        TabButton.MouseLeave:Connect(function()
            if Window.CurrentTab ~= Tab then
                Tween(TabButton, {BackgroundTransparency = 0.3}, 0.2)
            end
        end)
        
        table.insert(Window.Tabs, Tab)
        
        -- Auto-select first tab
        if #Window.Tabs == 1 then
            Window:SelectTab(Tab)
        end
        
        -- Tab Elements
        function Tab:AddButton(buttonConfig)
            buttonConfig = buttonConfig or {}
            buttonConfig.Title = buttonConfig.Title or "Button"
            buttonConfig.Description = buttonConfig.Description or ""
            buttonConfig.Callback = buttonConfig.Callback or function() end
            
            local ButtonFrame = CreateInstance("Frame", {
                Name = "Button",
                Size = UDim2.new(1, 0, 0, buttonConfig.Description ~= "" and 60 or 40),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent
            })
            
            AddCorners(ButtonFrame, 8)
            AddStroke(ButtonFrame, Theme.Border, 1)
            
            local Button = CreateInstance("TextButton", {
                Name = "ButtonClick",
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = "",
                Parent = ButtonFrame
            })
            
            local ButtonTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(1, -20, 0, 20),
                Position = UDim2.fromOffset(10, buttonConfig.Description ~= "" and 8 or 10),
                BackgroundTransparency = 1,
                Text = buttonConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamSemibold,
                Parent = ButtonFrame
            })
            
            if buttonConfig.Description ~= "" then
                local ButtonDesc = CreateInstance("TextLabel", {
                    Name = "Description",
                    Size = UDim2.new(1, -20, 0, 15),
                    Position = UDim2.fromOffset(10, 30),
                    BackgroundTransparency = 1,
                    Text = buttonConfig.Description,
                    TextColor3 = Theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    Font = Enum.Font.Gotham,
                    Parent = ButtonFrame
                })
            end
            
            Button.MouseButton1Click:Connect(function()
                Tween(ButtonFrame, {BackgroundColor3 = Theme.Accent}, 0.1)
                task.wait(0.1)
                Tween(ButtonFrame, {BackgroundColor3 = Theme.Secondary}, 0.1)
                buttonConfig.Callback()
            end)
            
            return Button
        end
        
        function Tab:AddToggle(id, toggleConfig)
            toggleConfig = toggleConfig or {}
            toggleConfig.Title = toggleConfig.Title or "Toggle"
            toggleConfig.Default = toggleConfig.Default or false
            toggleConfig.Callback = toggleConfig.Callback or function() end
            
            local ToggleFrame = CreateInstance("Frame", {
                Name = "Toggle",
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent
            })
            
            AddCorners(ToggleFrame, 8)
            AddStroke(ToggleFrame, Theme.Border, 1)
            
            local ToggleButton = CreateInstance("TextButton", {
                Name = "ToggleButton",
                Size = UDim2.new(1, 0, 1, 0),
                BackgroundTransparency = 1,
                Text = "",
                Parent = ToggleFrame
            })
            
            local ToggleTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(1, -60, 1, 0),
                Position = UDim2.fromOffset(10, 0),
                BackgroundTransparency = 1,
                Text = toggleConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamSemibold,
                Parent = ToggleFrame
            })
            
            local ToggleSwitch = CreateInstance("Frame", {
                Name = "Switch",
                Size = UDim2.fromOffset(45, 24),
                Position = UDim2.new(1, -55, 0.5, -12),
                BackgroundColor3 = toggleConfig.Default and Theme.Accent or Theme.Tertiary,
                BorderSizePixel = 0,
                Parent = ToggleFrame
            })
            
            AddCorners(ToggleSwitch, 12)
            
            local ToggleCircle = CreateInstance("Frame", {
                Name = "Circle",
                Size = UDim2.fromOffset(18, 18),
                Position = toggleConfig.Default and UDim2.fromOffset(24, 3) or UDim2.fromOffset(3, 3),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                BorderSizePixel = 0,
                Parent = ToggleSwitch
            })
            
            AddCorners(ToggleCircle, 9)
            
            local ToggleObj = {
                Value = toggleConfig.Default,
                Callback = toggleConfig.Callback
            }
            
            local function UpdateToggle(value)
                ToggleObj.Value = value
                
                Tween(ToggleSwitch, {
                    BackgroundColor3 = value and Theme.Accent or Theme.Tertiary
                }, 0.2)
                
                Tween(ToggleCircle, {
                    Position = value and UDim2.fromOffset(24, 3) or UDim2.fromOffset(3, 3)
                }, 0.2)
                
                ToggleObj.Callback(value)
            end
            
            ToggleButton.MouseButton1Click:Connect(function()
                UpdateToggle(not ToggleObj.Value)
            end)
            
            function ToggleObj:SetValue(value)
                UpdateToggle(value)
            end
            
            return ToggleObj
        end
        
        function Tab:AddSlider(id, sliderConfig)
            sliderConfig = sliderConfig or {}
            sliderConfig.Title = sliderConfig.Title or "Slider"
            sliderConfig.Description = sliderConfig.Description or ""
            sliderConfig.Min = sliderConfig.Min or 0
            sliderConfig.Max = sliderConfig.Max or 100
            sliderConfig.Default = sliderConfig.Default or sliderConfig.Min
            sliderConfig.Rounding = sliderConfig.Rounding or 1
            sliderConfig.Callback = sliderConfig.Callback or function() end
            
            local SliderFrame = CreateInstance("Frame", {
                Name = "Slider",
                Size = UDim2.new(1, 0, 0, sliderConfig.Description ~= "" and 80 or 60),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent
            })
            
            AddCorners(SliderFrame, 8)
            AddStroke(SliderFrame, Theme.Border, 1)
            
            local SliderTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(0.7, 0, 0, 20),
                Position = UDim2.fromOffset(10, 8),
                BackgroundTransparency = 1,
                Text = sliderConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamSemibold,
                Parent = SliderFrame
            })
            
            local SliderValue = CreateInstance("TextLabel", {
                Name = "Value",
                Size = UDim2.new(0.3, -10, 0, 20),
                Position = UDim2.new(0.7, 0, 0, 8),
                BackgroundTransparency = 1,
                Text = tostring(sliderConfig.Default),
                TextColor3 = Theme.Accent,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Right,
                Font = Enum.Font.GothamBold,
                Parent = SliderFrame
            })
            
            if sliderConfig.Description ~= "" then
                local SliderDesc = CreateInstance("TextLabel", {
                    Name = "Description",
                    Size = UDim2.new(1, -20, 0, 15),
                    Position = UDim2.fromOffset(10, 30),
                    BackgroundTransparency = 1,
                    Text = sliderConfig.Description,
                    TextColor3 = Theme.TextSecondary,
                    TextSize = 12,
                    TextXAlignment = Enum.TextXAlignment.Left,
                    Font = Enum.Font.Gotham,
                    Parent = SliderFrame
                })
            end
            
            local SliderTrack = CreateInstance("Frame", {
                Name = "Track",
                Size = UDim2.new(1, -20, 0, 4),
                Position = UDim2.new(0, 10, 1, -18),
                BackgroundColor3 = Theme.Tertiary,
                BorderSizePixel = 0,
                Parent = SliderFrame
            })
            
            AddCorners(SliderTrack, 2)
            
            local SliderFill = CreateInstance("Frame", {
                Name = "Fill",
                Size = UDim2.new(0, 0, 1, 0),
                BackgroundColor3 = Theme.Accent,
                BorderSizePixel = 0,
                Parent = SliderTrack
            })
            
            AddCorners(SliderFill, 2)
            
            local SliderDot = CreateInstance("Frame", {
                Name = "Dot",
                Size = UDim2.fromOffset(16, 16),
                Position = UDim2.new(0, -8, 0.5, -8),
                BackgroundColor3 = Color3.fromRGB(255, 255, 255),
                BorderSizePixel = 0,
                Parent = SliderFill
            })
            
            AddCorners(SliderDot, 8)
            AddStroke(SliderDot, Theme.Accent, 2)
            
            local SliderObj = {
                Value = sliderConfig.Default,
                Min = sliderConfig.Min,
                Max = sliderConfig.Max,
                Rounding = sliderConfig.Rounding,
                Callback = sliderConfig.Callback
            }
            
            local dragging = false
            
            local function Round(num, bracket)
                if bracket == 0 then
                    return math.floor(num)
                else
                    return math.floor(num / bracket + 0.5) * bracket
                end
            end
            
            local function UpdateSlider(value)
                value = math.clamp(value, sliderConfig.Min, sliderConfig.Max)
                value = Round(value, sliderConfig.Rounding)
                SliderObj.Value = value
                
                local percent = (value - sliderConfig.Min) / (sliderConfig.Max - sliderConfig.Min)
                Tween(SliderFill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.1)
                SliderValue.Text = tostring(value)
                
                SliderObj.Callback(value)
            end
            
            SliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = true
                    local percent = math.clamp((input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X, 0, 1)
                    local value = sliderConfig.Min + (sliderConfig.Max - sliderConfig.Min) * percent
                    UpdateSlider(value)
                end
            end)
            
            SliderTrack.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                    dragging = false
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                    local percent = math.clamp((input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X, 0, 1)
                    local value = sliderConfig.Min + (sliderConfig.Max - sliderConfig.Min) * percent
                    UpdateSlider(value)
                end
            end)
            
            function SliderObj:SetValue(value)
                UpdateSlider(value)
            end
            
            UpdateSlider(sliderConfig.Default)
            
            return SliderObj
        end
        
        function Tab:AddDropdown(id, dropdownConfig)
            dropdownConfig = dropdownConfig or {}
            dropdownConfig.Title = dropdownConfig.Title or "Dropdown"
            dropdownConfig.Values = dropdownConfig.Values or {"Option 1", "Option 2"}
            dropdownConfig.Multi = dropdownConfig.Multi or false
            dropdownConfig.Default = dropdownConfig.Default or (dropdownConfig.Multi and {} or nil)
            dropdownConfig.Callback = dropdownConfig.Callback or function() end
            
            local isOpen = false
            local selectedValues = dropdownConfig.Multi and {} or nil
            
            local DropdownFrame = CreateInstance("Frame", {
                Name = "Dropdown",
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent,
                ClipsDescendants = true
            })
            
            AddCorners(DropdownFrame, 8)
            AddStroke(DropdownFrame, Theme.Border, 1)
            
            local DropdownButton = CreateInstance("TextButton", {
                Name = "DropdownButton",
                Size = UDim2.new(1, 0, 0, 40),
                BackgroundTransparency = 1,
                Text = "",
                Parent = DropdownFrame
            })
            
            local DropdownTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(1, -40, 0, 40),
                Position = UDim2.fromOffset(10, 0),
                BackgroundTransparency = 1,
                Text = dropdownConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamSemibold,
                Parent = DropdownFrame
            })
            
            local DropdownArrow = CreateInstance("TextLabel", {
                Name = "Arrow",
                Size = UDim2.fromOffset(30, 40),
                Position = UDim2.new(1, -35, 0, 0),
                BackgroundTransparency = 1,
                Text = "▼",
                TextColor3 = Theme.TextSecondary,
                TextSize = 12,
                Font = Enum.Font.GothamBold,
                Parent = DropdownFrame
            })
            
            local OptionsList = CreateInstance("Frame", {
                Name = "Options",
                Size = UDim2.new(1, 0, 0, 0),
                Position = UDim2.fromOffset(0, 40),
                BackgroundTransparency = 1,
                Parent = DropdownFrame
            })
            
            local OptionsLayout = CreateInstance("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 2),
                Parent = OptionsList
            })
            
            local DropdownObj = {
                Value = dropdownConfig.Multi and {} or nil,
                Multi = dropdownConfig.Multi,
                Callback = dropdownConfig.Callback
            }
            
            local function UpdateDropdown()
                if dropdownConfig.Multi then
                    local selected = {}
                    for value, state in pairs(selectedValues) do
                        if state then
                            table.insert(selected, value)
                        end
                    end
                    DropdownObj.Value = selected
                    DropdownObj.Callback(selectedValues)
                else
                    DropdownObj.Callback(DropdownObj.Value)
                end
            end
            
            for _, value in ipairs(dropdownConfig.Values) do
                local OptionButton = CreateInstance("TextButton", {
                    Name = value,
                    Size = UDim2.new(1, -10, 0, 30),
                    Position = UDim2.fromOffset(5, 0),
                    BackgroundColor3 = Theme.Tertiary,
                    BackgroundTransparency = 0.2,
                    BorderSizePixel = 0,
                    Text = value,
                    TextColor3 = Theme.TextSecondary,
                    TextSize = 13,
                    Font = Enum.Font.Gotham,
                    Parent = OptionsList
                })
                
                AddCorners(OptionButton, 6)
                
                OptionButton.MouseButton1Click:Connect(function()
                    if dropdownConfig.Multi then
                        selectedValues[value] = not selectedValues[value]
                        OptionButton.BackgroundColor3 = selectedValues[value] and Theme.Accent or Theme.Tertiary
                        OptionButton.TextColor3 = selectedValues[value] and Theme.TextPrimary or Theme.TextSecondary
                    else
                        DropdownObj.Value = value
                        for _, btn in pairs(OptionsList:GetChildren()) do
                            if btn:IsA("TextButton") then
                                btn.BackgroundColor3 = Theme.Tertiary
                                btn.TextColor3 = Theme.TextSecondary
                            end
                        end
                        OptionButton.BackgroundColor3 = Theme.Accent
                        OptionButton.TextColor3 = Theme.TextPrimary
                        
                        task.wait(0.1)
                        isOpen = false
                        Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, 40)}, 0.3)
                        Tween(DropdownArrow, {Rotation = 0}, 0.3)
                    end
                    UpdateDropdown()
                end)
                
                -- Set default
                if dropdownConfig.Multi then
                    if dropdownConfig.Default and table.find(dropdownConfig.Default, value) then
                        selectedValues[value] = true
                        OptionButton.BackgroundColor3 = Theme.Accent
                        OptionButton.TextColor3 = Theme.TextPrimary
                    else
                        selectedValues[value] = false
                    end
                else
                    if dropdownConfig.Default == value then
                        DropdownObj.Value = value
                        OptionButton.BackgroundColor3 = Theme.Accent
                        OptionButton.TextColor3 = Theme.TextPrimary
                    end
                end
            end
            
            OptionsLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                OptionsList.Size = UDim2.new(1, 0, 0, OptionsLayout.AbsoluteContentSize.Y)
            end)
            
            DropdownButton.MouseButton1Click:Connect(function()
                isOpen = not isOpen
                if isOpen then
                    Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, 45 + OptionsLayout.AbsoluteContentSize.Y)}, 0.3)
                    Tween(DropdownArrow, {Rotation = 180}, 0.3)
                else
                    Tween(DropdownFrame, {Size = UDim2.new(1, 0, 0, 40)}, 0.3)
                    Tween(DropdownArrow, {Rotation = 0}, 0.3)
                end
            end)
            
            function DropdownObj:SetValue(value)
                if dropdownConfig.Multi then
                    selectedValues = value
                    for _, btn in pairs(OptionsList:GetChildren()) do
                        if btn:IsA("TextButton") then
                            local isSelected = value[btn.Name]
                            btn.BackgroundColor3 = isSelected and Theme.Accent or Theme.Tertiary
                            btn.TextColor3 = isSelected and Theme.TextPrimary or Theme.TextSecondary
                        end
                    end
                else
                    DropdownObj.Value = value
                    for _, btn in pairs(OptionsList:GetChildren()) do
                        if btn:IsA("TextButton") then
                            if btn.Name == value then
                                btn.BackgroundColor3 = Theme.Accent
                                btn.TextColor3 = Theme.TextPrimary
                            else
                                btn.BackgroundColor3 = Theme.Tertiary
                                btn.TextColor3 = Theme.TextSecondary
                            end
                        end
                    end
                end
                UpdateDropdown()
            end
            
            return DropdownObj
        end
        
        function Tab:AddParagraph(paragraphConfig)
            paragraphConfig = paragraphConfig or {}
            paragraphConfig.Title = paragraphConfig.Title or "Paragraph"
            paragraphConfig.Content = paragraphConfig.Content or "Content"
            
            local ParagraphFrame = CreateInstance("Frame", {
                Name = "Paragraph",
                Size = UDim2.new(1, 0, 0, 70),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent
            })
            
            AddCorners(ParagraphFrame, 8)
            AddStroke(ParagraphFrame, Theme.Border, 1)
            
            local ParagraphTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(1, -20, 0, 20),
                Position = UDim2.fromOffset(10, 8),
                BackgroundTransparency = 1,
                Text = paragraphConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamBold,
                Parent = ParagraphFrame
            })
            
            local ParagraphContent = CreateInstance("TextLabel", {
                Name = "Content",
                Size = UDim2.new(1, -20, 1, -35),
                Position = UDim2.fromOffset(10, 28),
                BackgroundTransparency = 1,
                Text = paragraphConfig.Content,
                TextColor3 = Theme.TextSecondary,
                TextSize = 12,
                TextXAlignment = Enum.TextXAlignment.Left,
                TextYAlignment = Enum.TextYAlignment.Top,
                TextWrapped = true,
                Font = Enum.Font.Gotham,
                Parent = ParagraphFrame
            })
            
            -- Auto-resize
            local textSize = game:GetService("TextService"):GetTextSize(
                paragraphConfig.Content,
                12,
                Enum.Font.Gotham,
                Vector2.new(ParagraphContent.AbsoluteSize.X, math.huge)
            )
            ParagraphFrame.Size = UDim2.new(1, 0, 0, textSize.Y + 40)
        end
        
        function Tab:AddInput(id, inputConfig)
            inputConfig = inputConfig or {}
            inputConfig.Title = inputConfig.Title or "Input"
            inputConfig.Default = inputConfig.Default or ""
            inputConfig.Placeholder = inputConfig.Placeholder or "Enter text..."
            inputConfig.Numeric = inputConfig.Numeric or false
            inputConfig.Finished = inputConfig.Finished or false
            inputConfig.Callback = inputConfig.Callback or function() end
            
            local InputFrame = CreateInstance("Frame", {
                Name = "Input",
                Size = UDim2.new(1, 0, 0, 70),
                BackgroundColor3 = Theme.Secondary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Parent = TabContent
            })
            
            AddCorners(InputFrame, 8)
            AddStroke(InputFrame, Theme.Border, 1)
            
            local InputTitle = CreateInstance("TextLabel", {
                Name = "Title",
                Size = UDim2.new(1, -20, 0, 20),
                Position = UDim2.fromOffset(10, 8),
                BackgroundTransparency = 1,
                Text = inputConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                TextXAlignment = Enum.TextXAlignment.Left,
                Font = Enum.Font.GothamSemibold,
                Parent = InputFrame
            })
            
            local InputBox = CreateInstance("TextBox", {
                Name = "InputBox",
                Size = UDim2.new(1, -20, 0, 30),
                Position = UDim2.fromOffset(10, 32),
                BackgroundColor3 = Theme.Tertiary,
                BackgroundTransparency = 0.1,
                BorderSizePixel = 0,
                Text = inputConfig.Default,
                PlaceholderText = inputConfig.Placeholder,
                PlaceholderColor3 = Theme.TextDisabled,
                TextColor3 = Theme.TextPrimary,
                TextSize = 13,
                Font = Enum.Font.Gotham,
                ClearTextOnFocus = false,
                Parent = InputFrame
            })
            
            AddCorners(InputBox, 6)
            AddStroke(InputBox, Theme.Border, 1)
            
            CreateInstance("UIPadding", {
                PaddingLeft = UDim.new(0, 10),
                PaddingRight = UDim.new(0, 10),
                Parent = InputBox
            })
            
            local InputObj = {
                Value = inputConfig.Default,
                Callback = inputConfig.Callback
            }
            
            if inputConfig.Numeric then
                InputBox:GetPropertyChangedSignal("Text"):Connect(function()
                    InputBox.Text = InputBox.Text:gsub("%D", "")
                end)
            end
            
            if inputConfig.Finished then
                InputBox.FocusLost:Connect(function(enterPressed)
                    if enterPressed then
                        InputObj.Value = InputBox.Text
                        InputObj.Callback(InputBox.Text)
                    end
                end)
            else
                InputBox:GetPropertyChangedSignal("Text"):Connect(function()
                    InputObj.Value = InputBox.Text
                    InputObj.Callback(InputBox.Text)
                end)
            end
            
            InputBox.Focused:Connect(function()
                Tween(InputBox.UIStroke, {Color = Theme.Accent}, 0.2)
            end)
            
            InputBox.FocusLost:Connect(function()
                Tween(InputBox.UIStroke, {Color = Theme.Border}, 0.2)
            end)
            
            function InputObj:SetValue(value)
                InputBox.Text = tostring(value)
                InputObj.Value = value
            end
            
            return InputObj
        end
        
        return Tab
    end
    
    function Window:SelectTab(tab)
        for _, t in pairs(self.Tabs) do
            t.Content.Visible = false
            Tween(t.Button, {BackgroundTransparency = 0.3}, 0.2)
            t.Title.TextColor3 = Theme.TextSecondary
        end
        
        tab.Content.Visible = true
        Tween(tab.Button, {BackgroundTransparency = 0}, 0.2)
        tab.Title.TextColor3 = Theme.TextPrimary
        self.CurrentTab = tab
    end
    
    function Window:Notify(notifConfig)
        notifConfig = notifConfig or {}
        notifConfig.Title = notifConfig.Title or "Notification"
        notifConfig.Content = notifConfig.Content or "Content"
        notifConfig.Duration = notifConfig.Duration or 5
        
        local NotifContainer = ScreenGui:FindFirstChild("NotifContainer")
        if not NotifContainer then
            NotifContainer = CreateInstance("Frame", {
                Name = "NotifContainer",
                Size = UDim2.new(0, 300, 1, 0),
                Position = UDim2.new(1, -310, 0, 10),
                BackgroundTransparency = 1,
                Parent = ScreenGui
            })
            
            CreateInstance("UIListLayout", {
                SortOrder = Enum.SortOrder.LayoutOrder,
                Padding = UDim.new(0, 10),
                Parent = NotifContainer
            })
        end
        
        local NotifFrame = CreateInstance("Frame", {
            Name = "Notification",
            Size = UDim2.new(1, 0, 0, 80),
            BackgroundColor3 = Theme.Secondary,
            BackgroundTransparency = 0.05,
            BorderSizePixel = 0,
            Parent = NotifContainer
        })
        
        AddCorners(NotifFrame, 10)
        AddStroke(NotifFrame, Theme.BorderAccent, 1)
        
        local NotifTitle = CreateInstance("TextLabel", {
            Name = "Title",
            Size = UDim2.new(1, -20, 0, 25),
            Position = UDim2.fromOffset(10, 8),
            BackgroundTransparency = 1,
            Text = notifConfig.Title,
            TextColor3 = Theme.TextPrimary,
            TextSize = 14,
            TextXAlignment = Enum.TextXAlignment.Left,
            Font = Enum.Font.GothamBold,
            Parent = NotifFrame
        })
        
        local NotifContent = CreateInstance("TextLabel", {
            Name = "Content",
            Size = UDim2.new(1, -20, 1, -40),
            Position = UDim2.fromOffset(10, 33),
            BackgroundTransparency = 1,
            Text = notifConfig.Content,
            TextColor3 = Theme.TextSecondary,
            TextSize = 12,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextYAlignment = Enum.TextYAlignment.Top,
            TextWrapped = true,
            Font = Enum.Font.Gotham,
            Parent = NotifFrame
        })
        
        -- Slide in animation
        NotifFrame.Position = UDim2.new(0, 300, 0, 0)
        NotifFrame.Size = UDim2.new(1, 0, 0, 0)
        Tween(NotifFrame, {Size = UDim2.new(1, 0, 0, 80)}, 0.3, Enum.EasingStyle.Back)
        
        -- Auto destroy
        if notifConfig.Duration then
            task.delay(notifConfig.Duration, function()
                Tween(NotifFrame, {Size = UDim2.new(1, 0, 0, 0)}, 0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In)
                task.wait(0.3)
                NotifFrame:Destroy()
            end)
        end
    end
    
    function Window:Dialog(dialogConfig)
        dialogConfig = dialogConfig or {}
        dialogConfig.Title = dialogConfig.Title or "Dialog"
        dialogConfig.Content = dialogConfig.Content or "Content"
        dialogConfig.Buttons = dialogConfig.Buttons or {}
        
        local DialogBackground = CreateInstance("Frame", {
            Name = "DialogBackground",
            Size = UDim2.fromScale(1, 1),
            BackgroundColor3 = Color3.fromRGB(0, 0, 0),
            BackgroundTransparency = 0.5,
            BorderSizePixel = 0,
            ZIndex = 100,
            Parent = ScreenGui
        })
        
        local DialogFrame = CreateInstance("Frame", {
            Name = "Dialog",
            Size = UDim2.fromOffset(400, 200),
            Position = UDim2.fromScale(0.5, 0.5),
            AnchorPoint = Vector2.new(0.5, 0.5),
            BackgroundColor3 = Theme.Background,
            BackgroundTransparency = 0,
            BorderSizePixel = 0,
            ZIndex = 101,
            Parent = DialogBackground
        })
        
        AddCorners(DialogFrame, 12)
        AddStroke(DialogFrame, Theme.BorderAccent, 2)
        
        local DialogTitle = CreateInstance("TextLabel", {
            Name = "Title",
            Size = UDim2.new(1, -20, 0, 30),
            Position = UDim2.fromOffset(10, 15),
            BackgroundTransparency = 1,
            Text = dialogConfig.Title,
            TextColor3 = Theme.TextPrimary,
            TextSize = 16,
            TextXAlignment = Enum.TextXAlignment.Left,
            Font = Enum.Font.GothamBold,
            ZIndex = 102,
            Parent = DialogFrame
        })
        
        local DialogContent = CreateInstance("TextLabel", {
            Name = "Content",
            Size = UDim2.new(1, -20, 0, 80),
            Position = UDim2.fromOffset(10, 50),
            BackgroundTransparency = 1,
            Text = dialogConfig.Content,
            TextColor3 = Theme.TextSecondary,
            TextSize = 13,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextYAlignment = Enum.TextYAlignment.Top,
            TextWrapped = true,
            Font = Enum.Font.Gotham,
            ZIndex = 102,
            Parent = DialogFrame
        })
        
        local ButtonContainer = CreateInstance("Frame", {
            Name = "Buttons",
            Size = UDim2.new(1, -20, 0, 40),
            Position = UDim2.new(0, 10, 1, -50),
            BackgroundTransparency = 1,
            ZIndex = 102,
            Parent = DialogFrame
        })
        
        CreateInstance("UIListLayout", {
            FillDirection = Enum.FillDirection.Horizontal,
            HorizontalAlignment = Enum.HorizontalAlignment.Right,
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 10),
            Parent = ButtonContainer
        })
        
        for _, btnConfig in ipairs(dialogConfig.Buttons) do
            local DialogButton = CreateInstance("TextButton", {
                Name = btnConfig.Title,
                Size = UDim2.fromOffset(100, 40),
                BackgroundColor3 = btnConfig.Title == "Confirm" and Theme.Accent or Theme.Tertiary,
                BorderSizePixel = 0,
                Text = btnConfig.Title,
                TextColor3 = Theme.TextPrimary,
                TextSize = 14,
                Font = Enum.Font.GothamSemibold,
                ZIndex = 103,
                Parent = ButtonContainer
            })
            
            AddCorners(DialogButton, 8)
            
            DialogButton.MouseButton1Click:Connect(function()
                Tween(DialogBackground, {BackgroundTransparency = 1}, 0.2)
                Tween(DialogFrame, {Size = UDim2.fromOffset(0, 0)}, 0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In)
                task.wait(0.2)
                DialogBackground:Destroy()
                if btnConfig.Callback then
                    btnConfig.Callback()
                end
            end)
        end
        
        -- Animation
        DialogFrame.Size = UDim2.fromOffset(0, 0)
        Tween(DialogFrame, {Size = UDim2.fromOffset(400, 200)}, 0.3, Enum.EasingStyle.Back)
    end
    
    -- Entry Animation
    MainFrame.Size = UDim2.fromOffset(0, 0)
    Tween(MainFrame, {Size = config.Size}, 0.4, Enum.EasingStyle.Back)
    
    return Window
end

return Library
