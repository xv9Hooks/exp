--[[
    Professional UI Library
    Dark Theme - Executor Supported - Mobile Compatible
    Version: 1.0.0
]]

local Library = {
    Version = "1.0.0",
    Unloaded = false,
    Options = {},
    Flags = {}
}

local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Theme
Library.Theme = {
    -- Main Colors
    Background = Color3.fromRGB(15, 15, 15),
    SecondaryBackground = Color3.fromRGB(20, 20, 20),
    TertiaryBackground = Color3.fromRGB(25, 25, 25),
    
    -- Accent
    Accent = Color3.fromRGB(100, 100, 255),
    AccentDark = Color3.fromRGB(70, 70, 200),
    
    -- Text
    Text = Color3.fromRGB(255, 255, 255),
    TextDark = Color3.fromRGB(150, 150, 150),
    TextDarker = Color3.fromRGB(100, 100, 100),
    
    -- Elements
    ElementBackground = Color3.fromRGB(30, 30, 30),
    ElementBackgroundHover = Color3.fromRGB(35, 35, 35),
    
    -- Border
    Border = Color3.fromRGB(40, 40, 40),
    
    -- States
    Success = Color3.fromRGB(50, 200, 100),
    Warning = Color3.fromRGB(255, 200, 50),
    Error = Color3.fromRGB(255, 50, 50),
    
    -- Transparency
    Transparency = 0.1,
    BackgroundTransparency = 0.05
}

-- Utility Functions
local Utility = {}

function Utility:Create(class, properties)
    local object = Instance.new(class)
    for prop, value in pairs(properties) do
        if prop ~= "Parent" then
            object[prop] = value
        end
    end
    if properties.Parent then
        object.Parent = properties.Parent
    end
    return object
end

function Utility:Tween(object, properties, duration, style, direction)
    local tweenInfo = TweenInfo.new(
        duration or 0.3,
        style or Enum.EasingStyle.Quad,
        direction or Enum.EasingDirection.Out
    )
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    return tween
end

function Utility:MakeDraggable(frame, handle)
    local dragging = false
    local dragInput, mousePos, framePos

    handle = handle or frame

    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            mousePos = input.Position
            framePos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            Utility:Tween(frame, {
                Position = UDim2.new(
                    framePos.X.Scale,
                    framePos.X.Offset + delta.X,
                    framePos.Y.Scale,
                    framePos.Y.Offset + delta.Y
                )
            }, 0.1)
        end
    end)
end

function Utility:AddCorner(parent, radius)
    return Utility:Create("UICorner", {
        CornerRadius = UDim.new(0, radius or 8),
        Parent = parent
    })
end

function Utility:AddStroke(parent, color, thickness)
    return Utility:Create("UIStroke", {
        Color = color or Library.Theme.Border,
        Thickness = thickness or 1,
        ApplyStrokeMode = Enum.ApplyStrokeMode.Border,
        Parent = parent
    })
end

-- Screen GUI Setup
local ScreenGui = Utility:Create("ScreenGui", {
    Name = "ProfessionalUI_" .. math.random(1000, 9999),
    ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
    ResetOnSpawn = false,
    IgnoreGuiInset = true
})

if gethui then
    ScreenGui.Parent = gethui()
elseif syn and syn.protect_gui then
    syn.protect_gui(ScreenGui)
    ScreenGui.Parent = CoreGui
else
    ScreenGui.Parent = CoreGui
end

-- Window Creation
function Library:CreateWindow(config)
    config = config or {}
    config.Title = config.Title or "Professional UI"
    config.SubTitle = config.SubTitle or "by Developer"
    config.Size = config.Size or UDim2.fromOffset(580, 460)
    config.TabWidth = config.TabWidth or 160
    config.Acrylic = config.Acrylic ~= false
    config.MinimizeKey = config.MinimizeKey or Enum.KeyCode.LeftControl

    local Window = {
        Tabs = {},
        CurrentTab = nil,
        Minimized = false
    }

    -- Main Window Frame
    Window.Root = Utility:Create("Frame", {
        Name = "Window",
        Size = config.Size,
        Position = UDim2.fromScale(0.5, 0.5),
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Library.Theme.Background,
        BackgroundTransparency = Library.Theme.BackgroundTransparency,
        BorderSizePixel = 0,
        Parent = ScreenGui
    })

    Utility:AddCorner(Window.Root, 12)
    Utility:AddStroke(Window.Root, Library.Theme.Border, 1)

    -- Acrylic Effect (Blur)
    if config.Acrylic then
        local Blur = Utility:Create("ImageLabel", {
            Name = "Blur",
            Size = UDim2.fromScale(1, 1),
            BackgroundTransparency = 1,
            Image = "rbxasset://textures/ui/GuiImagePlaceholder.png",
            ImageColor3 = Library.Theme.Background,
            ImageTransparency = 0.7,
            ScaleType = Enum.ScaleType.Tile,
            TileSize = UDim2.fromOffset(128, 128),
            Parent = Window.Root
        })
        Utility:AddCorner(Blur, 12)
    end

    -- Top Bar
    Window.TopBar = Utility:Create("Frame", {
        Name = "TopBar",
        Size = UDim2.new(1, 0, 0, 50),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BackgroundTransparency = Library.Theme.Transparency,
        BorderSizePixel = 0,
        Parent = Window.Root
    })

    Utility:AddCorner(Window.TopBar, 12)

    -- Top Bar Bottom Only Corner Fix
    Utility:Create("Frame", {
        Size = UDim2.new(1, 0, 0, 12),
        Position = UDim2.fromOffset(0, 38),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BackgroundTransparency = Library.Theme.Transparency,
        BorderSizePixel = 0,
        Parent = Window.TopBar
    })

    -- Title
    Window.Title = Utility:Create("TextLabel", {
        Name = "Title",
        Position = UDim2.fromOffset(15, 8),
        Size = UDim2.fromOffset(300, 20),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 16,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = Window.TopBar
    })

    -- SubTitle
    Window.SubTitle = Utility:Create("TextLabel", {
        Name = "SubTitle",
        Position = UDim2.fromOffset(15, 28),
        Size = UDim2.fromOffset(300, 16),
        BackgroundTransparency = 1,
        Text = config.SubTitle,
        TextColor3 = Library.Theme.TextDark,
        TextSize = 13,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = Window.TopBar
    })

    -- Control Buttons
    local controlsFrame = Utility:Create("Frame", {
        Name = "Controls",
        AnchorPoint = Vector2.new(1, 0),
        Position = UDim2.new(1, -10, 0, 10),
        Size = UDim2.fromOffset(60, 30),
        BackgroundTransparency = 1,
        Parent = Window.TopBar
    })

    Utility:Create("UIListLayout", {
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 8),
        Parent = controlsFrame
    })

    -- Minimize Button
    local MinimizeBtn = Utility:Create("TextButton", {
        Name = "Minimize",
        Size = UDim2.fromOffset(26, 26),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Text = "−",
        TextColor3 = Library.Theme.Text,
        TextSize = 18,
        Font = Enum.Font.GothamBold,
        Parent = controlsFrame
    })

    Utility:AddCorner(MinimizeBtn, 6)

    MinimizeBtn.MouseButton1Click:Connect(function()
        Window:ToggleMinimize()
    end)

    -- Close Button
    local CloseBtn = Utility:Create("TextButton", {
        Name = "Close",
        Size = UDim2.fromOffset(26, 26),
        BackgroundColor3 = Library.Theme.Error,
        BorderSizePixel = 0,
        Text = "×",
        TextColor3 = Library.Theme.Text,
        TextSize = 20,
        Font = Enum.Font.GothamBold,
        Parent = controlsFrame
    })

    Utility:AddCorner(CloseBtn, 6)

    CloseBtn.MouseButton1Click:Connect(function()
        Library:Destroy()
    end)

    -- Make Draggable
    Utility:MakeDraggable(Window.Root, Window.TopBar)

    -- Content Container
    Window.ContentContainer = Utility:Create("Frame", {
        Name = "Content",
        Position = UDim2.fromOffset(0, 50),
        Size = UDim2.new(1, 0, 1, -50),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Parent = Window.Root
    })

    -- Tab Container (Left Side)
    Window.TabContainer = Utility:Create("Frame", {
        Name = "TabContainer",
        Size = UDim2.fromOffset(config.TabWidth, Window.ContentContainer.AbsoluteSize.Y),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BackgroundTransparency = Library.Theme.Transparency,
        BorderSizePixel = 0,
        Parent = Window.ContentContainer
    })

    -- Tab List
    Window.TabList = Utility:Create("ScrollingFrame", {
        Name = "TabList",
        Size = UDim2.new(1, -10, 1, -10),
        Position = UDim2.fromOffset(5, 5),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = Library.Theme.Accent,
        CanvasSize = UDim2.fromOffset(0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        Parent = Window.TabContainer
    })

    Utility:Create("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 6),
        Parent = Window.TabList
    })

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 5),
        PaddingBottom = UDim.new(0, 5),
        Parent = Window.TabList
    })

    -- Main Content Area
    Window.MainContent = Utility:Create("Frame", {
        Name = "MainContent",
        Position = UDim2.fromOffset(config.TabWidth, 0),
        Size = UDim2.new(1, -config.TabWidth, 1, 0),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        Parent = Window.ContentContainer
    })

    -- Functions
    function Window:ToggleMinimize()
        Window.Minimized = not Window.Minimized
        local targetSize = Window.Minimized and UDim2.new(config.Size.X.Scale, config.Size.X.Offset, 0, 50) or config.Size
        
        Utility:Tween(Window.Root, {Size = targetSize}, 0.3)
        MinimizeBtn.Text = Window.Minimized and "+" or "−"
    end

    function Window:AddTab(tabConfig)
        tabConfig = tabConfig or {}
        tabConfig.Title = tabConfig.Title or "Tab"
        tabConfig.Icon = tabConfig.Icon or ""

        local Tab = {
            Title = tabConfig.Title,
            Elements = {}
        }

        -- Tab Button
        Tab.Button = Utility:Create("TextButton", {
            Name = "TabButton",
            Size = UDim2.new(1, -10, 0, 36),
            BackgroundColor3 = Library.Theme.ElementBackground,
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Text = "",
            AutoButtonColor = false,
            Parent = Window.TabList
        })

        Utility:AddCorner(Tab.Button, 8)

        -- Tab Title
        Utility:Create("TextLabel", {
            Name = "Title",
            Position = UDim2.fromOffset(12, 0),
            Size = UDim2.new(1, -24, 1, 0),
            BackgroundTransparency = 1,
            Text = tabConfig.Title,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 14,
            Font = Enum.Font.GothamSemibold,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = Tab.Button
        })

        -- Tab Content Container
        Tab.Container = Utility:Create("ScrollingFrame", {
            Name = "TabContent_" .. tabConfig.Title,
            Size = UDim2.new(1, -20, 1, -20),
            Position = UDim2.fromOffset(10, 10),
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            ScrollBarThickness = 6,
            ScrollBarImageColor3 = Library.Theme.Accent,
            CanvasSize = UDim2.fromOffset(0, 0),
            AutomaticCanvasSize = Enum.AutomaticSize.Y,
            Visible = false,
            Parent = Window.MainContent
        })

        Utility:Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 8),
            Parent = Tab.Container
        })

        Utility:Create("UIPadding", {
            PaddingTop = UDim.new(0, 5),
            PaddingBottom = UDim.new(0, 5),
            PaddingLeft = UDim.new(0, 5),
            PaddingRight = UDim.new(0, 5),
            Parent = Tab.Container
        })

        -- Tab Selection
        Tab.Button.MouseButton1Click:Connect(function()
            Window:SelectTab(Tab)
        end)

        table.insert(Window.Tabs, Tab)
        return Tab
    end

    function Window:SelectTab(tab)
        for _, t in pairs(Window.Tabs) do
            t.Container.Visible = false
            t.Button.BackgroundTransparency = 1
            t.Button.Title.TextColor3 = Library.Theme.TextDark
        end

        tab.Container.Visible = true
        tab.Button.BackgroundTransparency = 0
        tab.Button.Title.TextColor3 = Library.Theme.Text
        Window.CurrentTab = tab
    end

    -- Minimize Key
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == config.MinimizeKey then
            Window:ToggleMinimize()
        end
    end)

    return Window
end

-- Notification System
function Library:Notify(config)
    config = config or {}
    config.Title = config.Title or "Notification"
    config.Content = config.Content or "This is a notification"
    config.SubContent = config.SubContent or nil
    config.Duration = config.Duration or 5

    local NotificationContainer = ScreenGui:FindFirstChild("NotificationContainer")
    if not NotificationContainer then
        NotificationContainer = Utility:Create("Frame", {
            Name = "NotificationContainer",
            AnchorPoint = Vector2.new(1, 0),
            Position = UDim2.new(1, -20, 0, 20),
            Size = UDim2.fromOffset(320, 0),
            BackgroundTransparency = 1,
            Parent = ScreenGui
        })

        Utility:Create("UIListLayout", {
            SortOrder = Enum.SortOrder.LayoutOrder,
            Padding = UDim.new(0, 10),
            VerticalAlignment = Enum.VerticalAlignment.Top,
            Parent = NotificationContainer
        })
    end

    local Notification = Utility:Create("Frame", {
        Name = "Notification",
        Size = UDim2.fromOffset(320, 0),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BorderSizePixel = 0,
        ClipsDescendants = true,
        Parent = NotificationContainer
    })

    Utility:AddCorner(Notification, 10)
    Utility:AddStroke(Notification, Library.Theme.Border, 1)

    -- Accent Bar
    local AccentBar = Utility:Create("Frame", {
        Size = UDim2.new(1, 0, 0, 3),
        BackgroundColor3 = Library.Theme.Accent,
        BorderSizePixel = 0,
        Parent = Notification
    })

    -- Content Container
    local Content = Utility:Create("Frame", {
        Position = UDim2.fromOffset(0, 3),
        Size = UDim2.new(1, 0, 1, -3),
        BackgroundTransparency = 1,
        Parent = Notification
    })

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = Content
    })

    -- Title
    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 15,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        Parent = Content
    })

    -- Main Content
    local MainContent = Utility:Create("TextLabel", {
        Name = "Content",
        Position = UDim2.fromOffset(0, 22),
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundTransparency = 1,
        Text = config.Content,
        TextColor3 = Library.Theme.TextDark,
        TextSize = 13,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        TextWrapped = true,
        AutomaticSize = Enum.AutomaticSize.Y,
        Parent = Content
    })

    local totalHeight = 22 + MainContent.AbsoluteSize.Y

    -- SubContent
    if config.SubContent then
        local SubContent = Utility:Create("TextLabel", {
            Name = "SubContent",
            Position = UDim2.fromOffset(0, 22 + MainContent.AbsoluteSize.Y + 4),
            Size = UDim2.new(1, 0, 0, 0),
            BackgroundTransparency = 1,
            Text = config.SubContent,
            TextColor3 = Library.Theme.TextDarker,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextYAlignment = Enum.TextYAlignment.Top,
            TextWrapped = true,
            AutomaticSize = Enum.AutomaticSize.Y,
            Parent = Content
        })
        totalHeight = totalHeight + SubContent.AbsoluteSize.Y + 4
    end

    Notification.Size = UDim2.fromOffset(320, totalHeight + 27)

    -- Slide In Animation
    Notification.Position = UDim2.fromOffset(320, 0)
    Utility:Tween(Notification, {Position = UDim2.fromOffset(0, 0)}, 0.4, Enum.EasingStyle.Back)

    -- Auto Dismiss
    if config.Duration then
        task.delay(config.Duration, function()
            Utility:Tween(Notification, {Position = UDim2.fromOffset(320, 0)}, 0.3)
            task.wait(0.3)
            Notification:Destroy()
        end)
    end

    return Notification
end

-- Dialog System
function Library:Dialog(config)
    config = config or {}
    config.Title = config.Title or "Dialog"
    config.Content = config.Content or "This is a dialog"
    config.Buttons = config.Buttons or {{Title = "OK", Callback = function() end}}

    local Overlay = Utility:Create("Frame", {
        Name = "DialogOverlay",
        Size = UDim2.fromScale(1, 1),
        BackgroundColor3 = Color3.fromRGB(0, 0, 0),
        BackgroundTransparency = 0.5,
        BorderSizePixel = 0,
        ZIndex = 1000,
        Parent = ScreenGui
    })

    local Dialog = Utility:Create("Frame", {
        Name = "Dialog",
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.fromScale(0.5, 0.5),
        Size = UDim2.fromOffset(400, 0),
        BackgroundColor3 = Library.Theme.Background,
        BorderSizePixel = 0,
        ZIndex = 1001,
        Parent = Overlay
    })

    Utility:AddCorner(Dialog, 12)
    Utility:AddStroke(Dialog, Library.Theme.Border, 1)

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 20),
        PaddingBottom = UDim.new(0, 20),
        PaddingLeft = UDim.new(0, 20),
        PaddingRight = UDim.new(0, 20),
        Parent = Dialog
    })

    -- Title
    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, 0, 0, 24),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 18,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = Dialog
    })

    -- Content
    local Content = Utility:Create("TextLabel", {
        Name = "Content",
        Position = UDim2.fromOffset(0, 32),
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundTransparency = 1,
        Text = config.Content,
        TextColor3 = Library.Theme.TextDark,
        TextSize = 14,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        TextWrapped = true,
        AutomaticSize = Enum.AutomaticSize.Y,
        Parent = Dialog
    })

    -- Button Container
    local ButtonContainer = Utility:Create("Frame", {
        Name = "Buttons",
        Position = UDim2.fromOffset(0, 32 + Content.AbsoluteSize.Y + 20),
        Size = UDim2.new(1, 0, 0, 36),
        BackgroundTransparency = 1,
        Parent = Dialog
    })

    Utility:Create("UIListLayout", {
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10),
        Parent = ButtonContainer
    })

    for _, btnConfig in ipairs(config.Buttons) do
        local Button = Utility:Create("TextButton", {
            Name = btnConfig.Title,
            Size = UDim2.fromOffset(100, 36),
            BackgroundColor3 = Library.Theme.Accent,
            BorderSizePixel = 0,
            Text = btnConfig.Title,
            TextColor3 = Library.Theme.Text,
            TextSize = 14,
            Font = Enum.Font.GothamSemibold,
            AutoButtonColor = false,
            Parent = ButtonContainer
        })

        Utility:AddCorner(Button, 8)

        Button.MouseEnter:Connect(function()
            Utility:Tween(Button, {BackgroundColor3 = Library.Theme.AccentDark}, 0.2)
        end)

        Button.MouseLeave:Connect(function()
            Utility:Tween(Button, {BackgroundColor3 = Library.Theme.Accent}, 0.2)
        end)

        Button.MouseButton1Click:Connect(function()
            if btnConfig.Callback then
                btnConfig.Callback()
            end
            Overlay:Destroy()
        end)
    end

    Dialog.Size = UDim2.fromOffset(400, 32 + Content.AbsoluteSize.Y + 20 + 36 + 40)

    -- Scale Animation
    Dialog.Size = UDim2.fromOffset(0, 0)
    Utility:Tween(Dialog, {Size = UDim2.fromOffset(400, 32 + Content.AbsoluteSize.Y + 20 + 36 + 40)}, 0.3, Enum.EasingStyle.Back)
end

-- Tab Elements
local Elements = {}

-- Paragraph
function Elements:AddParagraph(tab, config)
    config = config or {}
    config.Title = config.Title or "Paragraph"
    config.Content = config.Content or "Content"

    local Paragraph = Utility:Create("Frame", {
        Name = "Paragraph",
        Size = UDim2.new(1, -10, 0, 0),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        AutomaticSize = Enum.AutomaticSize.Y,
        Parent = tab.Container
    })

    Utility:AddCorner(Paragraph, 8)

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = Paragraph
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 15,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = Paragraph
    })

    local Content = Utility:Create("TextLabel", {
        Name = "Content",
        Position = UDim2.fromOffset(0, 22),
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundTransparency = 1,
        Text = config.Content,
        TextColor3 = Library.Theme.TextDark,
        TextSize = 13,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextYAlignment = Enum.TextYAlignment.Top,
        TextWrapped = true,
        AutomaticSize = Enum.AutomaticSize.Y,
        Parent = Paragraph
    })

    return {
        SetTitle = function(self, title)
            Title.Text = title
        end,
        SetContent = function(self, content)
            Content.Text = content
        end
    }
end

-- Button
function Elements:AddButton(tab, config)
    config = config or {}
    config.Title = config.Title or "Button"
    config.Description = config.Description or nil
    config.Callback = config.Callback or function() end

    local buttonHeight = config.Description and 56 or 40

    local Button = Utility:Create("Frame", {
        Name = "Button",
        Size = UDim2.new(1, -10, 0, buttonHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Parent = tab.Container
    })

    Utility:AddCorner(Button, 8)

    local ButtonClick = Utility:Create("TextButton", {
        Name = "Click",
        Size = UDim2.fromScale(1, 1),
        BackgroundTransparency = 1,
        Text = "",
        AutoButtonColor = false,
        Parent = Button
    })

    Utility:Create("UIPadding", {
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = Button
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Position = UDim2.fromOffset(0, config.Description and 8 or 0),
        Size = UDim2.new(1, -30, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = Button
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 26),
            Size = UDim2.new(1, -30, 0, 16),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = Button
        })
    end

    -- Arrow Icon
    Utility:Create("TextLabel", {
        Name = "Arrow",
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, 0, 0.5, 0),
        Size = UDim2.fromOffset(20, 20),
        BackgroundTransparency = 1,
        Text = "›",
        TextColor3 = Library.Theme.TextDark,
        TextSize = 20,
        Font = Enum.Font.GothamBold,
        Parent = Button
    })

    ButtonClick.MouseEnter:Connect(function()
        Utility:Tween(Button, {BackgroundColor3 = Library.Theme.ElementBackgroundHover}, 0.2)
    end)

    ButtonClick.MouseLeave:Connect(function()
        Utility:Tween(Button, {BackgroundColor3 = Library.Theme.ElementBackground}, 0.2)
    end)

    ButtonClick.MouseButton1Click:Connect(function()
        Utility:Tween(Button, {BackgroundColor3 = Library.Theme.TertiaryBackground}, 0.1)
        task.wait(0.1)
        Utility:Tween(Button, {BackgroundColor3 = Library.Theme.ElementBackgroundHover}, 0.1)
        config.Callback()
    end)

    return Button
end

-- Toggle
function Elements:AddToggle(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Toggle"
    config.Description = config.Description or nil
    config.Default = config.Default or false
    config.Callback = config.Callback or function() end

    local toggleHeight = config.Description and 56 or 40

    local Toggle = {
        Value = config.Default,
        Flag = flag
    }

    local ToggleFrame = Utility:Create("Frame", {
        Name = "Toggle",
        Size = UDim2.new(1, -10, 0, toggleHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Parent = tab.Container
    })

    Utility:AddCorner(ToggleFrame, 8)

    local ToggleClick = Utility:Create("TextButton", {
        Name = "Click",
        Size = UDim2.fromScale(1, 1),
        BackgroundTransparency = 1,
        Text = "",
        AutoButtonColor = false,
        Parent = ToggleFrame
    })

    Utility:Create("UIPadding", {
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = ToggleFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Position = UDim2.fromOffset(0, config.Description and 8 or 0),
        Size = UDim2.new(1, -60, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = ToggleFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 26),
            Size = UDim2.new(1, -60, 0, 16),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = ToggleFrame
        })
    end

    -- Toggle Switch
    local Switch = Utility:Create("Frame", {
        Name = "Switch",
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, 0, 0.5, 0),
        Size = UDim2.fromOffset(44, 24),
        BackgroundColor3 = config.Default and Library.Theme.Accent or Library.Theme.TertiaryBackground,
        BorderSizePixel = 0,
        Parent = ToggleFrame
    })

    Utility:AddCorner(Switch, 12)

    local Knob = Utility:Create("Frame", {
        Name = "Knob",
        Position = UDim2.fromOffset(config.Default and 22 or 2, 2),
        Size = UDim2.fromOffset(20, 20),
        BackgroundColor3 = Library.Theme.Text,
        BorderSizePixel = 0,
        Parent = Switch
    })

    Utility:AddCorner(Knob, 10)

    function Toggle:SetValue(value)
        Toggle.Value = value
        
        Utility:Tween(Switch, {
            BackgroundColor3 = value and Library.Theme.Accent or Library.Theme.TertiaryBackground
        }, 0.2)
        
        Utility:Tween(Knob, {
            Position = UDim2.fromOffset(value and 22 or 2, 2)
        }, 0.2)
        
        Library.Flags[flag] = value
        config.Callback(value)
    end

    function Toggle:OnChanged(func)
        config.Callback = func
    end

    ToggleClick.MouseButton1Click:Connect(function()
        Toggle:SetValue(not Toggle.Value)
    end)

    ToggleClick.MouseEnter:Connect(function()
        Utility:Tween(ToggleFrame, {BackgroundColor3 = Library.Theme.ElementBackgroundHover}, 0.2)
    end)

    ToggleClick.MouseLeave:Connect(function()
        Utility:Tween(ToggleFrame, {BackgroundColor3 = Library.Theme.ElementBackground}, 0.2)
    end)

    Library.Options[flag] = Toggle
    Library.Flags[flag] = config.Default

    return Toggle
end

-- Slider
function Elements:AddSlider(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Slider"
    config.Description = config.Description or nil
    config.Min = config.Min or 0
    config.Max = config.Max or 100
    config.Default = config.Default or 50
    config.Rounding = config.Rounding or 1
    config.Callback = config.Callback or function() end

    local Slider = {
        Value = config.Default,
        Flag = flag,
        Min = config.Min,
        Max = config.Max,
        Rounding = config.Rounding
    }

    local sliderHeight = config.Description and 70 or 54

    local SliderFrame = Utility:Create("Frame", {
        Name = "Slider",
        Size = UDim2.new(1, -10, 0, sliderHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Parent = tab.Container
    })

    Utility:AddCorner(SliderFrame, 8)

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = SliderFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, -50, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = SliderFrame
    })

    local ValueLabel = Utility:Create("TextLabel", {
        Name = "Value",
        AnchorPoint = Vector2.new(1, 0),
        Position = UDim2.new(1, 0, 0, 0),
        Size = UDim2.fromOffset(50, 18),
        BackgroundTransparency = 1,
        Text = tostring(config.Default),
        TextColor3 = Library.Theme.Accent,
        TextSize = 14,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Right,
        Parent = SliderFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 20),
            Size = UDim2.new(1, 0, 0, 14),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = SliderFrame
        })
    end

    -- Slider Track
    local Track = Utility:Create("Frame", {
        Name = "Track",
        Position = UDim2.fromOffset(0, config.Description and 40 or 26),
        Size = UDim2.new(1, 0, 0, 6),
        BackgroundColor3 = Library.Theme.TertiaryBackground,
        BorderSizePixel = 0,
        Parent = SliderFrame
    })

    Utility:AddCorner(Track, 3)

    local Fill = Utility:Create("Frame", {
        Name = "Fill",
        Size = UDim2.fromScale((config.Default - config.Min) / (config.Max - config.Min), 1),
        BackgroundColor3 = Library.Theme.Accent,
        BorderSizePixel = 0,
        Parent = Track
    })

    Utility:AddCorner(Fill, 3)

    local Dragging = false

    function Slider:SetValue(value)
        value = math.clamp(value, config.Min, config.Max)
        value = math.floor(value / config.Rounding + 0.5) * config.Rounding
        Slider.Value = value
        
        local percent = (value - config.Min) / (config.Max - config.Min)
        Utility:Tween(Fill, {Size = UDim2.fromScale(percent, 1)}, 0.1)
        
        ValueLabel.Text = tostring(value)
        Library.Flags[flag] = value
        config.Callback(value)
    end

    function Slider:OnChanged(func)
        config.Callback = func
    end

    local function UpdateSlider(input)
        local pos = (input.Position.X - Track.AbsolutePosition.X) / Track.AbsoluteSize.X
        pos = math.clamp(pos, 0, 1)
        local value = config.Min + ((config.Max - config.Min) * pos)
        Slider:SetValue(value)
    end

    Track.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            UpdateSlider(input)
        end
    end)

    Track.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if Dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            UpdateSlider(input)
        end
    end)

    Library.Options[flag] = Slider
    Library.Flags[flag] = config.Default

    return Slider
end
-- Input
function Elements:AddInput(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Input"
    config.Description = config.Description or nil
    config.Default = config.Default or ""
    config.Placeholder = config.Placeholder or "Enter text..."
    config.Numeric = config.Numeric or false
    config.Finished = config.Finished or false
    config.Callback = config.Callback or function() end

    local Input = {
        Value = config.Default,
        Flag = flag
    }

    local inputHeight = config.Description and 76 or 60

    local InputFrame = Utility:Create("Frame", {
        Name = "Input",
        Size = UDim2.new(1, -10, 0, inputHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Parent = tab.Container
    })

    Utility:AddCorner(InputFrame, 8)

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = InputFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = InputFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 20),
            Size = UDim2.new(1, 0, 0, 14),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = InputFrame
        })
    end

    -- Input Box
    local InputBox = Utility:Create("Frame", {
        Name = "InputBox",
        Position = UDim2.fromOffset(0, config.Description and 40 or 24),
        Size = UDim2.new(1, 0, 0, 32),
        BackgroundColor3 = Library.Theme.TertiaryBackground,
        BorderSizePixel = 0,
        Parent = InputFrame
    })

    Utility:AddCorner(InputBox, 6)
    Utility:AddStroke(InputBox, Library.Theme.Border, 1)

    local TextBox = Utility:Create("TextBox", {
        Name = "TextBox",
        Size = UDim2.new(1, -20, 1, 0),
        Position = UDim2.fromOffset(10, 0),
        BackgroundTransparency = 1,
        Text = config.Default,
        PlaceholderText = config.Placeholder,
        TextColor3 = Library.Theme.Text,
        PlaceholderColor3 = Library.Theme.TextDarker,
        TextSize = 13,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        ClearTextOnFocus = false,
        Parent = InputBox
    })

    if config.Numeric then
        TextBox.TextChanged:Connect(function()
            TextBox.Text = TextBox.Text:gsub("%D", "")
        end)
    end

    function Input:SetValue(value)
        Input.Value = value
        TextBox.Text = value
        Library.Flags[flag] = value
        if not config.Finished then
            config.Callback(value)
        end
    end

    function Input:OnChanged(func)
        config.Callback = func
    end

    if config.Finished then
        TextBox.FocusLost:Connect(function(enterPressed)
            if enterPressed then
                Input:SetValue(TextBox.Text)
            end
        end)
    else
        TextBox:GetPropertyChangedSignal("Text"):Connect(function()
            Input:SetValue(TextBox.Text)
        end)
    end

    TextBox.Focused:Connect(function()
        Utility:Tween(InputBox, {BackgroundColor3 = Library.Theme.SecondaryBackground}, 0.2)
        InputBox.UIStroke.Color = Library.Theme.Accent
    end)

    TextBox.FocusLost:Connect(function()
        Utility:Tween(InputBox, {BackgroundColor3 = Library.Theme.TertiaryBackground}, 0.2)
        InputBox.UIStroke.Color = Library.Theme.Border
    end)

    Library.Options[flag] = Input
    Library.Flags[flag] = config.Default

    return Input
end

-- Dropdown
function Elements:AddDropdown(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Dropdown"
    config.Description = config.Description or nil
    config.Values = config.Values or {}
    config.Multi = config.Multi or false
    config.Default = config.Default or (config.Multi and {} or 1)
    config.Callback = config.Callback or function() end

    local Dropdown = {
        Value = config.Multi and {} or config.Values[config.Default],
        Values = config.Values,
        Multi = config.Multi,
        Flag = flag,
        Opened = false
    }

    local baseHeight = config.Description and 76 or 60
    
    local DropdownFrame = Utility:Create("Frame", {
        Name = "Dropdown",
        Size = UDim2.new(1, -10, 0, baseHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        ClipsDescendants = false,
        Parent = tab.Container
    })

    Utility:AddCorner(DropdownFrame, 8)

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = DropdownFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = DropdownFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 20),
            Size = UDim2.new(1, 0, 0, 14),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = DropdownFrame
        })
    end

    -- Dropdown Button
    local DropdownButton = Utility:Create("TextButton", {
        Name = "Button",
        Position = UDim2.fromOffset(0, config.Description and 40 or 24),
        Size = UDim2.new(1, 0, 0, 32),
        BackgroundColor3 = Library.Theme.TertiaryBackground,
        BorderSizePixel = 0,
        Text = "",
        AutoButtonColor = false,
        Parent = DropdownFrame
    })

    Utility:AddCorner(DropdownButton, 6)
    Utility:AddStroke(DropdownButton, Library.Theme.Border, 1)

    local SelectedLabel = Utility:Create("TextLabel", {
        Name = "Selected",
        Position = UDim2.fromOffset(10, 0),
        Size = UDim2.new(1, -40, 1, 0),
        BackgroundTransparency = 1,
        Text = config.Multi and "None" or (config.Values[config.Default] or "Select"),
        TextColor3 = Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        Parent = DropdownButton
    })

    local Arrow = Utility:Create("TextLabel", {
        Name = "Arrow",
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, -10, 0.5, 0),
        Size = UDim2.fromOffset(20, 20),
        BackgroundTransparency = 1,
        Text = "▼",
        TextColor3 = Library.Theme.TextDark,
        TextSize = 10,
        Font = Enum.Font.GothamBold,
        Parent = DropdownButton
    })

    -- Dropdown List
    local DropdownList = Utility:Create("Frame", {
        Name = "List",
        Position = UDim2.fromOffset(0, config.Description and 78 or 62),
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BorderSizePixel = 0,
        Visible = false,
        ClipsDescendants = true,
        ZIndex = 100,
        Parent = DropdownFrame
    })

    Utility:AddCorner(DropdownList, 8)
    Utility:AddStroke(DropdownList, Library.Theme.Border, 1)

    local ListContainer = Utility:Create("ScrollingFrame", {
        Name = "Container",
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = Library.Theme.Accent,
        CanvasSize = UDim2.fromOffset(0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        Parent = DropdownList
    })

    Utility:Create("UIListLayout", {
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 2),
        Parent = ListContainer
    })

    Utility:Create("UIPadding", {
        PaddingTop = UDim.new(0, 5),
        PaddingBottom = UDim.new(0, 5),
        PaddingLeft = UDim.new(0, 5),
        PaddingRight = UDim.new(0, 5),
        Parent = ListContainer
    })

    -- Functions
    function Dropdown:Toggle()
        Dropdown.Opened = not Dropdown.Opened
        
        if Dropdown.Opened then
            local itemCount = math.min(#config.Values, 6)
            local listHeight = (itemCount * 32) + ((itemCount - 1) * 2) + 10
            
            DropdownList.Visible = true
            Utility:Tween(DropdownList, {Size = UDim2.new(1, 0, 0, listHeight)}, 0.3)
            Utility:Tween(Arrow, {Rotation = 180}, 0.3)
            Utility:Tween(DropdownFrame, {Size = UDim2.new(1, -10, 0, baseHeight + listHeight + 6)}, 0.3)
        else
            Utility:Tween(DropdownList, {Size = UDim2.new(1, 0, 0, 0)}, 0.3)
            Utility:Tween(Arrow, {Rotation = 0}, 0.3)
            Utility:Tween(DropdownFrame, {Size = UDim2.new(1, -10, 0, baseHeight)}, 0.3)
            task.wait(0.3)
            DropdownList.Visible = false
        end
    end

    function Dropdown:SetValue(value)
        if config.Multi then
            Dropdown.Value = value
            local selected = {}
            for val, state in pairs(value) do
                if state then
                    table.insert(selected, val)
                end
            end
            SelectedLabel.Text = #selected > 0 and table.concat(selected, ", ") or "None"
        else
            Dropdown.Value = value
            SelectedLabel.Text = value
        end
        
        Library.Flags[flag] = Dropdown.Value
        config.Callback(Dropdown.Value)
    end

    function Dropdown:OnChanged(func)
        config.Callback = func
    end

    -- Create Items
    for i, value in ipairs(config.Values) do
        local Item = Utility:Create("TextButton", {
            Name = value,
            Size = UDim2.new(1, -10, 0, 28),
            BackgroundColor3 = Library.Theme.TertiaryBackground,
            BorderSizePixel = 0,
            Text = "",
            AutoButtonColor = false,
            Parent = ListContainer
        })

        Utility:AddCorner(Item, 6)

        local ItemLabel = Utility:Create("TextLabel", {
            Position = UDim2.fromOffset(10, 0),
            Size = UDim2.new(1, -20, 1, 0),
            BackgroundTransparency = 1,
            Text = value,
            TextColor3 = Library.Theme.Text,
            TextSize = 13,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = Item
        })

        if config.Multi then
            local Checkbox = Utility:Create("Frame", {
                Name = "Checkbox",
                AnchorPoint = Vector2.new(1, 0.5),
                Position = UDim2.new(1, -8, 0.5, 0),
                Size = UDim2.fromOffset(18, 18),
                BackgroundColor3 = Library.Theme.Background,
                BorderSizePixel = 0,
                Parent = Item
            })

            Utility:AddCorner(Checkbox, 4)
            Utility:AddStroke(Checkbox, Library.Theme.Border, 1)

            local Check = Utility:Create("TextLabel", {
                Size = UDim2.fromScale(1, 1),
                BackgroundTransparency = 1,
                Text = "✓",
                TextColor3 = Library.Theme.Accent,
                TextSize = 14,
                Font = Enum.Font.GothamBold,
                TextTransparency = 1,
                Parent = Checkbox
            })

            Item.MouseButton1Click:Connect(function()
                local isSelected = Dropdown.Value[value] or false
                Dropdown.Value[value] = not isSelected
                
                if Dropdown.Value[value] then
                    Utility:Tween(Checkbox, {BackgroundColor3 = Library.Theme.Accent}, 0.2)
                    Utility:Tween(Check, {TextTransparency = 0}, 0.2)
                else
                    Utility:Tween(Checkbox, {BackgroundColor3 = Library.Theme.Background}, 0.2)
                    Utility:Tween(Check, {TextTransparency = 1}, 0.2)
                end
                
                Dropdown:SetValue(Dropdown.Value)
            end)

            -- Set default
            if config.Default and table.find(config.Default, value) then
                Dropdown.Value[value] = true
                Checkbox.BackgroundColor3 = Library.Theme.Accent
                Check.TextTransparency = 0
            end
        else
            Item.MouseButton1Click:Connect(function()
                Dropdown:SetValue(value)
                Dropdown:Toggle()
            end)
        end

        Item.MouseEnter:Connect(function()
            Utility:Tween(Item, {BackgroundColor3 = Library.Theme.ElementBackground}, 0.2)
        end)

        Item.MouseLeave:Connect(function()
            Utility:Tween(Item, {BackgroundColor3 = Library.Theme.TertiaryBackground}, 0.2)
        end)
    end

    DropdownButton.MouseButton1Click:Connect(function()
        Dropdown:Toggle()
    end)

    Library.Options[flag] = Dropdown
    Library.Flags[flag] = config.Multi and {} or config.Values[config.Default]

    if config.Multi and config.Default then
        Dropdown:SetValue(config.Default)
    end

    return Dropdown
end

-- Colorpicker
function Elements:AddColorpicker(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Colorpicker"
    config.Description = config.Description or nil
    config.Default = config.Default or Color3.fromRGB(255, 255, 255)
    config.Transparency = config.Transparency
    config.Callback = config.Callback or function() end

    local Colorpicker = {
        Value = config.Default,
        Transparency = config.Transparency or 0,
        Flag = flag,
        Opened = false
    }

    local baseHeight = config.Description and 56 or 40

    local ColorpickerFrame = Utility:Create("Frame", {
        Name = "Colorpicker",
        Size = UDim2.new(1, -10, 0, baseHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        ClipsDescendants = false,
        Parent = tab.Container
    })

    Utility:AddCorner(ColorpickerFrame, 8)

    Utility:Create("UIPadding", {
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = ColorpickerFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Position = UDim2.fromOffset(0, config.Description and 8 or 0),
        Size = UDim2.new(1, -60, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = ColorpickerFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 26),
            Size = UDim2.new(1, -60, 0, 16),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = ColorpickerFrame
        })
    end

    -- Color Display
    local ColorDisplay = Utility:Create("TextButton", {
        Name = "Display",
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, 0, 0.5, 0),
        Size = UDim2.fromOffset(40, 28),
        BackgroundColor3 = config.Default,
        BorderSizePixel = 0,
        Text = "",
        AutoButtonColor = false,
        Parent = ColorpickerFrame
    })

    Utility:AddCorner(ColorDisplay, 6)
    Utility:AddStroke(ColorDisplay, Library.Theme.Border, 1)

    -- Color Picker Window
    local PickerWindow = Utility:Create("Frame", {
        Name = "PickerWindow",
        Position = UDim2.fromOffset(0, baseHeight + 6),
        Size = UDim2.fromOffset(0, 0),
        BackgroundColor3 = Library.Theme.SecondaryBackground,
        BorderSizePixel = 0,
        Visible = false,
        ClipsDescendants = true,
        ZIndex = 100,
        Parent = ColorpickerFrame
    })

    Utility:AddCorner(PickerWindow, 8)
    Utility:AddStroke(PickerWindow, Library.Theme.Border, 1)

    local pickerSize = DropdownFrame.AbsoluteSize.X - 30

    -- Saturation/Value Picker
    local SVPicker = Utility:Create("ImageButton", {
        Name = "SVPicker",
        Position = UDim2.fromOffset(10, 10),
        Size = UDim2.fromOffset(pickerSize, 150),
        BackgroundColor3 = Color3.fromRGB(255, 0, 0),
        BorderSizePixel = 0,
        AutoButtonColor = false,
        Parent = PickerWindow
    })

    Utility:AddCorner(SVPicker, 6)

    -- SV Gradient
    local SVGradient = Utility:Create("UIGradient", {
        Color = ColorSequence.new(Color3.new(1, 1, 1), Color3.new(1, 1, 1)),
        Rotation = 0,
        Parent = SVPicker
    })

    local ValueGradient = Utility:Create("Frame", {
        Size = UDim2.fromScale(1, 1),
        BackgroundColor3 = Color3.new(1, 1, 1),
        BorderSizePixel = 0,
        Parent = SVPicker
    })

    Utility:AddCorner(ValueGradient, 6)

    Utility:Create("UIGradient", {
        Color = ColorSequence.new(Color3.new(1, 1, 1), Color3.new(0, 0, 0)),
        Rotation = 90,
        Parent = ValueGradient
    })

    -- SV Cursor
    local SVCursor = Utility:Create("Frame", {
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.fromScale(1, 0),
        Size = UDim2.fromOffset(10, 10),
        BackgroundColor3 = Color3.new(1, 1, 1),
        BorderSizePixel = 0,
        Parent = SVPicker
    })

    Utility:Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = SVCursor})
    Utility:AddStroke(SVCursor, Color3.new(0, 0, 0), 2)

    -- Hue Slider
    local HueSlider = Utility:Create("Frame", {
        Name = "HueSlider",
        Position = UDim2.fromOffset(10, 170),
        Size = UDim2.fromOffset(pickerSize, 16),
        BackgroundColor3 = Color3.new(1, 1, 1),
        BorderSizePixel = 0,
        Parent = PickerWindow
    })

    Utility:AddCorner(HueSlider, 8)

    Utility:Create("UIGradient", {
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 0)),
            ColorSequenceKeypoint.new(0.17, Color3.fromRGB(255, 255, 0)),
            ColorSequenceKeypoint.new(0.33, Color3.fromRGB(0, 255, 0)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(0, 255, 255)),
            ColorSequenceKeypoint.new(0.67, Color3.fromRGB(0, 0, 255)),
            ColorSequenceKeypoint.new(0.83, Color3.fromRGB(255, 0, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 0))
        }),
        Parent = HueSlider
    })

    local HueCursor = Utility:Create("Frame", {
        AnchorPoint = Vector2.new(0.5, 0.5),
        Position = UDim2.fromScale(0, 0.5),
        Size = UDim2.fromOffset(4, 20),
        BackgroundColor3 = Color3.new(1, 1, 1),
        BorderSizePixel = 0,
        Parent = HueSlider
    })

    Utility:AddCorner(HueCursor, 2)
    Utility:AddStroke(HueCursor, Color3.new(0, 0, 0), 2)

    local currentHue = 0
    local currentSat = 1
    local currentVal = 1

    function Colorpicker:SetValueRGB(color)
        Colorpicker.Value = color
        ColorDisplay.BackgroundColor3 = color
        
        Library.Flags[flag] = color
        config.Callback()
    end

    function Colorpicker:OnChanged(func)
        config.Callback = func
    end

    function Colorpicker:Toggle()
        Colorpicker.Opened = not Colorpicker.Opened
        
        if Colorpicker.Opened then
            local windowHeight = config.Transparency and 230 or 196
            PickerWindow.Visible = true
            Utility:Tween(PickerWindow, {Size = UDim2.fromOffset(pickerSize + 20, windowHeight)}, 0.3)
            Utility:Tween(ColorpickerFrame, {Size = UDim2.new(1, -10, 0, baseHeight + windowHeight + 6)}, 0.3)
        else
            Utility:Tween(PickerWindow, {Size = UDim2.fromOffset(0, 0)}, 0.3)
            Utility:Tween(ColorpickerFrame, {Size = UDim2.new(1, -10, 0, baseHeight)}, 0.3)
            task.wait(0.3)
            PickerWindow.Visible = false
        end
    end

    ColorDisplay.MouseButton1Click:Connect(function()
        Colorpicker:Toggle()
    end)

    -- SV Picker Logic
    local svDragging = false
    SVPicker.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            svDragging = true
        end
    end)

    SVPicker.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            svDragging = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if svDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local posX = math.clamp((input.Position.X - SVPicker.AbsolutePosition.X) / SVPicker.AbsoluteSize.X, 0, 1)
            local posY = math.clamp((input.Position.Y - SVPicker.AbsolutePosition.Y) / SVPicker.AbsoluteSize.Y, 0, 1)
            
            currentSat = posX
            currentVal = 1 - posY
            
            SVCursor.Position = UDim2.fromScale(posX, posY)
            
            local color = Color3.fromHSV(currentHue, currentSat, currentVal)
            Colorpicker:SetValueRGB(color)
        end
    end)

    -- Hue Slider Logic
    local hueDragging = false
    HueSlider.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            hueDragging = true
        end
    end)

    HueSlider.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            hueDragging = false
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if hueDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local pos = math.clamp((input.Position.X - HueSlider.AbsolutePosition.X) / HueSlider.AbsoluteSize.X, 0, 1)
            currentHue = pos
            
            HueCursor.Position = UDim2.fromScale(pos, 0.5)
            SVPicker.BackgroundColor3 = Color3.fromHSV(currentHue, 1, 1)
            
            local color = Color3.fromHSV(currentHue, currentSat, currentVal)
            Colorpicker:SetValueRGB(color)
        end
    end)

    Library.Options[flag] = Colorpicker
    Library.Flags[flag] = config.Default

    return Colorpicker
end

-- Keybind
function Elements:AddKeybind(tab, flag, config)
    config = config or {}
    config.Title = config.Title or "Keybind"
    config.Description = config.Description or nil
    config.Mode = config.Mode or "Toggle" -- Toggle, Hold, Always
    config.Default = config.Default or "None"
    config.Callback = config.Callback or function() end
    config.ChangedCallback = config.ChangedCallback or function() end

    local Keybind = {
        Value = config.Default,
        Mode = config.Mode,
        Flag = flag,
        State = false,
        Selecting = false
    }

    local keybindHeight = config.Description and 56 or 40

    local KeybindFrame = Utility:Create("Frame", {
        Name = "Keybind",
        Size = UDim2.new(1, -10, 0, keybindHeight),
        BackgroundColor3 = Library.Theme.ElementBackground,
        BorderSizePixel = 0,
        Parent = tab.Container
    })

    Utility:AddCorner(KeybindFrame, 8)

    Utility:Create("UIPadding", {
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15),
        Parent = KeybindFrame
    })

    local Title = Utility:Create("TextLabel", {
        Name = "Title",
        Position = UDim2.fromOffset(0, config.Description and 8 or 0),
        Size = UDim2.new(1, -100, 0, 18),
        BackgroundTransparency = 1,
        Text = config.Title,
        TextColor3 = Library.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamSemibold,
        TextXAlignment = Enum.TextXAlignment.Left,
        Parent = KeybindFrame
    })

    if config.Description then
        Utility:Create("TextLabel", {
            Name = "Description",
            Position = UDim2.fromOffset(0, 26),
            Size = UDim2.new(1, -100, 0, 16),
            BackgroundTransparency = 1,
            Text = config.Description,
            TextColor3 = Library.Theme.TextDark,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            TextXAlignment = Enum.TextXAlignment.Left,
            Parent = KeybindFrame
        })
    end

    -- Keybind Button
    local KeybindButton = Utility:Create("TextButton", {
        Name = "KeybindButton",
        AnchorPoint = Vector2.new(1, 0.5),
        Position = UDim2.new(1, 0, 0.5, 0),
        Size = UDim2.fromOffset(90, 28),
        BackgroundColor3 = Library.Theme.TertiaryBackground,
        BorderSizePixel = 0,
        Text = config.Default,
        TextColor3 = Library.Theme.Text,
        TextSize = 12,
        Font = Enum.Font.GothamSemibold,
        AutoButtonColor = false,
        Parent = KeybindFrame
    })

    Utility:AddCorner(KeybindButton, 6)
    Utility:AddStroke(KeybindButton, Library.Theme.Border, 1)

    local keyNames = {
        [Enum.KeyCode.LeftControl] = "LCTRL",
        [Enum.KeyCode.RightControl] = "RCTRL",
        [Enum.KeyCode.LeftShift] = "LSHIFT",
        [Enum.KeyCode.RightShift] = "RSHIFT",
        [Enum.KeyCode.LeftAlt] = "LALT",
        [Enum.KeyCode.RightAlt] = "RALT",
        [Enum.UserInputType.MouseButton1] = "MB1",
        [Enum.UserInputType.MouseButton2] = "MB2",
        [Enum.UserInputType.MouseButton3] = "MB3"
    }

    function Keybind:GetState()
        return Keybind.State
    end

    function Keybind:SetValue(key, mode)
        mode = mode or Keybind.Mode
        Keybind.Mode = mode
        
        if typeof(key) == "string" then
            if key == "MB1" then
                key = Enum.UserInputType.MouseButton1
            elseif key == "MB2" then
                key = Enum.UserInputType.MouseButton2
            elseif key == "MB3" then
                key = Enum.UserInputType.MouseButton3
            else
                key = Enum.KeyCode[key]
            end
        end
        
        Keybind.Value = key
        KeybindButton.Text = keyNames[key] or (typeof(key) == "EnumItem" and key.Name) or "None"
        
        Library.Flags[flag] = key
        config.ChangedCallback(key)
    end

    function Keybind:OnClick(func)
        config.Callback = func
    end

    function Keybind:OnChanged(func)
        config.ChangedCallback = func
    end

    KeybindButton.MouseButton1Click:Connect(function()
        Keybind.Selecting = true
        KeybindButton.Text = "..."
        KeybindButton.UIStroke.Color = Library.Theme.Accent
    end)

    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if Keybind.Selecting then
            local key
            if input.UserInputType == Enum.UserInputType.Keyboard then
                if input.KeyCode == Enum.KeyCode.Escape then
                    Keybind.Selecting = false
                    KeybindButton.Text = keyNames[Keybind.Value] or Keybind.Value.Name or "None"
                    KeybindButton.UIStroke.Color = Library.Theme.Border
                    return
                end
                key = input.KeyCode
            elseif input.UserInputType == Enum.UserInputType.MouseButton1 or 
                   input.UserInputType == Enum.UserInputType.MouseButton2 or
                   input.UserInputType == Enum.UserInputType.MouseButton3 then
                key = input.UserInputType
            end
            
            if key then
                Keybind:SetValue(key)
                Keybind.Selecting = false
                KeybindButton.UIStroke.Color = Library.Theme.Border
            end
            return
        end

        if not gameProcessed then
            local checkKey = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
            if checkKey == Keybind.Value then
                if Keybind.Mode == "Hold" then
                    Keybind.State = true
                    config.Callback(true)
                elseif Keybind.Mode == "Toggle" then
                    Keybind.State = not Keybind.State
                    config.Callback(Keybind.State)
                    
                    if Keybind.State then
                        Utility:Tween(KeybindButton, {BackgroundColor3 = Library.Theme.Accent}, 0.2)
                    else
                        Utility:Tween(KeybindButton, {BackgroundColor3 = Library.Theme.TertiaryBackground}, 0.2)
                    end
                end
            end
        end
    end)

    UserInputService.InputEnded:Connect(function(input, gameProcessed)
        if Keybind.Mode == "Hold" then
            local checkKey = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
            if checkKey == Keybind.Value and Keybind.State then
                Keybind.State = false
                config.Callback(false)
            end
        end
    end)

    Library.Options[flag] = Keybind
    Library.Flags[flag] = config.Default

    return Keybind
end

-- Add Elements to Tab
function Library:AddTab(tab, ...)
    return tab
end

-- Integrate Elements into Tabs
local function IntegrateElements(tab)
    function tab:AddParagraph(config)
        return Elements:AddParagraph(tab, config)
    end

    function tab:AddButton(config)
        return Elements:AddButton(tab, config)
    end

    function tab:AddToggle(flag, config)
        return Elements:AddToggle(tab, flag, config)
    end

    function tab:AddSlider(flag, config)
        return Elements:AddSlider(tab, flag, config)
    end

    function tab:AddInput(flag, config)
        return Elements:AddInput(tab, flag, config)
    end

    function tab:AddDropdown(flag, config)
        return Elements:AddDropdown(tab, flag, config)
    end

    function tab:AddColorpicker(flag, config)
        return Elements:AddColorpicker(tab, flag, config)
    end

    function tab:AddKeybind(flag, config)
        return Elements:AddKeybind(tab, flag, config)
    end

    return tab
end

-- Override Window AddTab
local OldAddTab = Library.CreateWindow({}).__index and Library.CreateWindow({}).__index.AddTab
function Library.CreateWindow(config)
    local window = Library:CreateWindow(config)
    
    local oldAddTab = window.AddTab
    function window:AddTab(tabConfig)
        local tab = oldAddTab(self, tabConfig)
        return IntegrateElements(tab)
    end

    function window:Dialog(dialogConfig)
        Library:Dialog(dialogConfig)
    end

    return window
end

-- Destroy Function
function Library:Destroy()
    Library.Unloaded = true
    if ScreenGui then
        Utility:Tween(ScreenGui, {BackgroundTransparency = 1}, 0.3)
        for _, obj in pairs(ScreenGui:GetDescendants()) do
            if obj:IsA("GuiObject") then
                Utility:Tween(obj, {BackgroundTransparency = 1, TextTransparency = 1, ImageTransparency = 1}, 0.3)
            end
        end
        task.wait(0.3)
        ScreenGui:Destroy()
    end
end

return Library
