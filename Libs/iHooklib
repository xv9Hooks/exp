--[[
    ██╗██╗  ██╗ ██████╗  ██████╗ ██╗  ██╗
    ██║██║  ██║██╔═══██╗██╔═══██╗██║ ██╔╝
    ██║███████║██║   ██║██║   ██║█████╔╝ 
    ██║██╔══██║██║   ██║██║   ██║██╔═██╗ 
    ██║██║  ██║╚██████╔╝╚██████╔╝██║  ██╗
    ╚═╝╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═╝
    
    iHook UI Library v1.0.0
    Premium Roblox Executor UI Framework
    PC + Mobile Fully Optimized
]]

local iHook = {}
iHook.__index = iHook
iHook.Version = "1.0.0"
iHook.Options = {}
iHook.Flags = {}
iHook.Windows = {}
iHook.Connections = {}
iHook.Unloaded = false
iHook.CurrentTheme = "Dark"
iHook.Theme = {}

-- ══════════════════════════════════════
-- SERVICES
-- ══════════════════════════════════════
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local TextService = game:GetService("TextService")
local GuiService = game:GetService("GuiService")
local HttpService = game:GetService("HttpService")
local HapticService = game:GetService("HapticService")

local Player = Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local Mouse = Player:GetMouse()
local Camera = workspace.CurrentCamera

-- ══════════════════════════════════════
-- PLATFORM DETECTION
-- ══════════════════════════════════════
local IsMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled
local IsTablet = UserInputService.TouchEnabled and (Camera.ViewportSize.X > 1000)
local IsPC = UserInputService.KeyboardEnabled and UserInputService.MouseEnabled
local ViewportSize = Camera.ViewportSize

local Platform = "PC"
if IsMobile then Platform = IsTablet and "Tablet" or "Mobile" end

-- Safe Area
local SafeAreaInsets = {Top = 0, Bottom = 0, Left = 0, Right = 0}
pcall(function()
    local inset = GuiService:GetGuiInset()
    SafeAreaInsets.Top = inset.Y
    if IsMobile and (ViewportSize.X / ViewportSize.Y) > 2 then
        SafeAreaInsets.Top = math.max(SafeAreaInsets.Top, 44)
        SafeAreaInsets.Bottom = 34
    end
end)

-- ══════════════════════════════════════
-- THEMES
-- ══════════════════════════════════════
iHook.Themes = {
    Dark = {
        Background = Color3.fromRGB(15, 15, 20),
        Primary = Color3.fromRGB(22, 22, 30),
        Secondary = Color3.fromRGB(30, 30, 42),
        Tertiary = Color3.fromRGB(40, 40, 55),
        Accent = Color3.fromRGB(88, 130, 255),
        AccentHover = Color3.fromRGB(108, 150, 255),
        AccentDark = Color3.fromRGB(68, 110, 235),
        Text = Color3.fromRGB(255, 255, 255),
        TextDark = Color3.fromRGB(180, 180, 195),
        TextDarker = Color3.fromRGB(130, 130, 150),
        TextDisabled = Color3.fromRGB(90, 90, 110),
        Border = Color3.fromRGB(55, 55, 75),
        BorderLight = Color3.fromRGB(70, 70, 95),
        Divider = Color3.fromRGB(45, 45, 60),
        Shadow = Color3.fromRGB(0, 0, 0),
        Success = Color3.fromRGB(75, 210, 130),
        Warning = Color3.fromRGB(255, 190, 60),
        Error = Color3.fromRGB(255, 85, 95),
        Info = Color3.fromRGB(80, 170, 255),
        Hover = Color3.fromRGB(45, 45, 62),
        Pressed = Color3.fromRGB(55, 55, 75),
        ToggleOn = Color3.fromRGB(88, 130, 255),
        ToggleOff = Color3.fromRGB(60, 60, 80),
        SliderFill = Color3.fromRGB(88, 130, 255),
        SliderTrack = Color3.fromRGB(45, 45, 62),
        InputBg = Color3.fromRGB(25, 25, 35),
        DropdownBg = Color3.fromRGB(28, 28, 38),
        TabActive = Color3.fromRGB(88, 130, 255),
        TabInactive = Color3.fromRGB(40, 40, 55),
        ScrollThumb = Color3.fromRGB(70, 70, 95),
        Glow = Color3.fromRGB(88, 130, 255)
    },
    
    Midnight = {
        Background = Color3.fromRGB(10, 10, 15),
        Primary = Color3.fromRGB(16, 16, 24),
        Secondary = Color3.fromRGB(24, 24, 35),
        Tertiary = Color3.fromRGB(32, 32, 45),
        Accent = Color3.fromRGB(130, 90, 255),
        AccentHover = Color3.fromRGB(150, 110, 255),
        AccentDark = Color3.fromRGB(110, 70, 235),
        Text = Color3.fromRGB(255, 255, 255),
        TextDark = Color3.fromRGB(170, 170, 190),
        TextDarker = Color3.fromRGB(120, 120, 145),
        TextDisabled = Color3.fromRGB(80, 80, 100),
        Border = Color3.fromRGB(45, 45, 65),
        BorderLight = Color3.fromRGB(60, 60, 85),
        Divider = Color3.fromRGB(38, 38, 52),
        Shadow = Color3.fromRGB(0, 0, 0),
        Success = Color3.fromRGB(100, 220, 150),
        Warning = Color3.fromRGB(255, 200, 80),
        Error = Color3.fromRGB(255, 100, 110),
        Info = Color3.fromRGB(100, 180, 255),
        Hover = Color3.fromRGB(38, 38, 52),
        Pressed = Color3.fromRGB(48, 48, 65),
        ToggleOn = Color3.fromRGB(130, 90, 255),
        ToggleOff = Color3.fromRGB(50, 50, 70),
        SliderFill = Color3.fromRGB(130, 90, 255),
        SliderTrack = Color3.fromRGB(38, 38, 52),
        InputBg = Color3.fromRGB(20, 20, 30),
        DropdownBg = Color3.fromRGB(22, 22, 32),
        TabActive = Color3.fromRGB(130, 90, 255),
        TabInactive = Color3.fromRGB(32, 32, 45),
        ScrollThumb = Color3.fromRGB(60, 60, 85),
        Glow = Color3.fromRGB(130, 90, 255)
    },
    
    Ocean = {
        Background = Color3.fromRGB(12, 18, 25),
        Primary = Color3.fromRGB(18, 28, 38),
        Secondary = Color3.fromRGB(25, 40, 55),
        Tertiary = Color3.fromRGB(32, 52, 72),
        Accent = Color3.fromRGB(0, 200, 220),
        AccentHover = Color3.fromRGB(30, 220, 240),
        AccentDark = Color3.fromRGB(0, 170, 190),
        Text = Color3.fromRGB(255, 255, 255),
        TextDark = Color3.fromRGB(175, 195, 210),
        TextDarker = Color3.fromRGB(125, 150, 170),
        TextDisabled = Color3.fromRGB(85, 105, 125),
        Border = Color3.fromRGB(45, 70, 95),
        BorderLight = Color3.fromRGB(60, 90, 115),
        Divider = Color3.fromRGB(35, 55, 75),
        Shadow = Color3.fromRGB(0, 0, 0),
        Success = Color3.fromRGB(60, 230, 160),
        Warning = Color3.fromRGB(255, 210, 80),
        Error = Color3.fromRGB(255, 95, 110),
        Info = Color3.fromRGB(80, 190, 255),
        Hover = Color3.fromRGB(35, 55, 75),
        Pressed = Color3.fromRGB(45, 68, 90),
        ToggleOn = Color3.fromRGB(0, 200, 220),
        ToggleOff = Color3.fromRGB(50, 75, 100),
        SliderFill = Color3.fromRGB(0, 200, 220),
        SliderTrack = Color3.fromRGB(35, 55, 75),
        InputBg = Color3.fromRGB(20, 32, 45),
        DropdownBg = Color3.fromRGB(22, 35, 48),
        TabActive = Color3.fromRGB(0, 200, 220),
        TabInactive = Color3.fromRGB(32, 52, 72),
        ScrollThumb = Color3.fromRGB(55, 85, 110),
        Glow = Color3.fromRGB(0, 200, 220)
    },
    
    Rose = {
        Background = Color3.fromRGB(18, 12, 18),
        Primary = Color3.fromRGB(28, 18, 28),
        Secondary = Color3.fromRGB(42, 28, 42),
        Tertiary = Color3.fromRGB(55, 38, 55),
        Accent = Color3.fromRGB(255, 100, 150),
        AccentHover = Color3.fromRGB(255, 130, 175),
        AccentDark = Color3.fromRGB(230, 80, 130),
        Text = Color3.fromRGB(255, 255, 255),
        TextDark = Color3.fromRGB(200, 180, 195),
        TextDarker = Color3.fromRGB(155, 135, 150),
        TextDisabled = Color3.fromRGB(110, 95, 108),
        Border = Color3.fromRGB(75, 50, 72),
        BorderLight = Color3.fromRGB(95, 65, 90),
        Divider = Color3.fromRGB(52, 35, 50),
        Shadow = Color3.fromRGB(0, 0, 0),
        Success = Color3.fromRGB(120, 220, 160),
        Warning = Color3.fromRGB(255, 200, 100),
        Error = Color3.fromRGB(255, 90, 100),
        Info = Color3.fromRGB(150, 180, 255),
        Hover = Color3.fromRGB(52, 35, 50),
        Pressed = Color3.fromRGB(65, 45, 62),
        ToggleOn = Color3.fromRGB(255, 100, 150),
        ToggleOff = Color3.fromRGB(70, 50, 68),
        SliderFill = Color3.fromRGB(255, 100, 150),
        SliderTrack = Color3.fromRGB(52, 35, 50),
        InputBg = Color3.fromRGB(32, 22, 32),
        DropdownBg = Color3.fromRGB(35, 24, 35),
        TabActive = Color3.fromRGB(255, 100, 150),
        TabInactive = Color3.fromRGB(55, 38, 55),
        ScrollThumb = Color3.fromRGB(85, 58, 82),
        Glow = Color3.fromRGB(255, 100, 150)
    }
}

-- ══════════════════════════════════════
-- UTILITY CLASS
-- ══════════════════════════════════════
local Utility = {}

function Utility.Create(class, properties, children)
    local instance = Instance.new(class)
    local parent = nil
    
    for prop, value in pairs(properties or {}) do
        if prop == "Parent" then
            parent = value
        else
            pcall(function() instance[prop] = value end)
        end
    end
    
    for _, child in pairs(children or {}) do
        child.Parent = instance
    end
    
    if parent then instance.Parent = parent end
    return instance
end

function Utility.Tween(instance, properties, duration, style, direction)
    if not instance or not instance.Parent then return end
    local tween = TweenService:Create(
        instance,
        TweenInfo.new(duration or 0.2, style or Enum.EasingStyle.Quad, direction or Enum.EasingDirection.Out),
        properties
    )
    tween:Play()
    return tween
end

function Utility.SmoothTween(instance, properties, duration)
    return Utility.Tween(instance, properties, duration or 0.2)
end

function Utility.BounceTween(instance, properties, duration)
    return Utility.Tween(instance, properties, duration or 0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
end

function Utility.Ripple(button, x, y)
    if not button or not button.Parent then return end
    
    local absPos = button.AbsolutePosition
    local absSize = button.AbsoluteSize
    local posX = x and (x - absPos.X) or (absSize.X / 2)
    local posY = y and (y - absPos.Y) or (absSize.Y / 2)
    local maxSize = math.max(absSize.X, absSize.Y) * 2.5
    
    local container = Utility.Create("Frame", {
        Name = "RippleContainer",
        Parent = button,
        BackgroundTransparency = 1,
        ClipsDescendants = true,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = button.ZIndex + 5
    })
    
    local corner = button:FindFirstChildOfClass("UICorner")
    if corner then
        Utility.Create("UICorner", {CornerRadius = corner.CornerRadius, Parent = container})
    end
    
    local ripple = Utility.Create("Frame", {
        Parent = container,
        BackgroundColor3 = Color3.fromRGB(255, 255, 255),
        BackgroundTransparency = 0.75,
        BorderSizePixel = 0,
        Position = UDim2.new(0, posX, 0, posY),
        Size = UDim2.new(0, 0, 0, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = button.ZIndex + 6
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = ripple})
    
    local tween = Utility.Tween(ripple, {
        Size = UDim2.new(0, maxSize, 0, maxSize),
        BackgroundTransparency = 1
    }, 0.45)
    
    task.delay(0.45, function()
        if container then container:Destroy() end
    end)
end

function Utility.GetScale()
    local vp = Camera.ViewportSize
    if IsMobile then
        if vp.X < 500 then return 0.65
        elseif vp.X < 700 then return 0.75
        elseif vp.X < 1000 then return 0.85
        else return 0.95 end
    end
    return math.clamp(math.min(vp.X / 1920, vp.Y / 1080), 0.7, 1.2)
end

function Utility.ScaleUDim2(size, scale)
    scale = scale or Utility.GetScale()
    return UDim2.new(size.X.Scale, math.floor(size.X.Offset * scale), size.Y.Scale, math.floor(size.Y.Offset * scale))
end

function Utility.DeepCopy(original)
    if type(original) ~= "table" then return original end
    local copy = {}
    for k, v in pairs(original) do
        copy[k] = type(v) == "table" and Utility.DeepCopy(v) or v
    end
    return copy
end

function Utility.Truncate(text, maxLen)
    return #text > maxLen and text:sub(1, maxLen - 3) .. "..." or text
end

function Utility.Round(num, decimals)
    local mult = 10 ^ (decimals or 0)
    return math.floor(num * mult + 0.5) / mult
end

function Utility.Lerp(a, b, t)
    return a + (b - a) * t
end

function Utility.LerpColor(c1, c2, t)
    return Color3.new(Utility.Lerp(c1.R, c2.R, t), Utility.Lerp(c1.G, c2.G, t), Utility.Lerp(c1.B, c2.B, t))
end

function Utility.HexToRGB(hex)
    hex = hex:gsub("#", "")
    return Color3.fromRGB(tonumber(hex:sub(1,2), 16), tonumber(hex:sub(3,4), 16), tonumber(hex:sub(5,6), 16))
end

function Utility.RGBToHex(color)
    return string.format("#%02X%02X%02X", color.R * 255, color.G * 255, color.B * 255)
end

function Utility.RGBToHSV(color)
    local r, g, b = color.R, color.G, color.B
    local max, min = math.max(r, g, b), math.min(r, g, b)
    local h, s, v = 0, 0, max
    local d = max - min
    s = max == 0 and 0 or d / max
    if max ~= min then
        if max == r then h = (g - b) / d + (g < b and 6 or 0)
        elseif max == g then h = (b - r) / d + 2
        else h = (r - g) / d + 4 end
        h = h / 6
    end
    return h, s, v
end

function Utility.HSVToRGB(h, s, v)
    local r, g, b
    local i = math.floor(h * 6)
    local f = h * 6 - i
    local p, q, t = v * (1 - s), v * (1 - f * s), v * (1 - (1 - f) * s)
    i = i % 6
    if i == 0 then r, g, b = v, t, p
    elseif i == 1 then r, g, b = q, v, p
    elseif i == 2 then r, g, b = p, v, t
    elseif i == 3 then r, g, b = p, q, v
    elseif i == 4 then r, g, b = t, p, v
    else r, g, b = v, p, q end
    return Color3.new(r, g, b)
end

function Utility.GenerateID(len)
    local chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    local result = ""
    for i = 1, len or 8 do
        local r = math.random(1, #chars)
        result = result .. chars:sub(r, r)
    end
    return result
end

function Utility.Debounce(func, delay)
    local lastCall = 0
    return function(...)
        local now = tick()
        if now - lastCall >= delay then
            lastCall = now
            return func(...)
        end
    end
end

function Utility.SafeCall(func, ...)
    if type(func) == "function" then
        local ok, err = pcall(func, ...)
        if not ok then warn("[iHook] Error:", err) end
        return ok, err
    end
end

function Utility.Haptic(intensity)
    if IsMobile then
        pcall(function()
            HapticService:SetMotor(Enum.UserInputType.Gamepad1, Enum.VibrationMotor.Large, intensity or 0.2)
            task.delay(0.1, function()
                HapticService:SetMotor(Enum.UserInputType.Gamepad1, Enum.VibrationMotor.Large, 0)
            end)
        end)
    end
end

iHook.Utility = Utility
iHook.IsMobile = IsMobile
iHook.IsTablet = IsTablet
iHook.IsPC = IsPC
iHook.Platform = Platform
iHook.SafeAreaInsets = SafeAreaInsets

-- ══════════════════════════════════════
-- SCREENGUI CREATION
-- ══════════════════════════════════════
local function CreateScreenGui()
    local gui
    local name = "iHook_" .. Utility.GenerateID(12)
    
    local ok = pcall(function()
        gui = Utility.Create("ScreenGui", {
            Name = name,
            Parent = CoreGui,
            ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
            ResetOnSpawn = false,
            IgnoreGuiInset = true,
            DisplayOrder = 999999
        })
    end)
    
    if not ok or not gui then
        gui = Utility.Create("ScreenGui", {
            Name = name,
            Parent = PlayerGui,
            ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
            ResetOnSpawn = false,
            IgnoreGuiInset = true,
            DisplayOrder = 999999
        })
    end
    
    pcall(function()
        if syn and syn.protect_gui then syn.protect_gui(gui)
        elseif gethui then gui.Parent = gethui() end
    end)
    
    return gui
end

iHook.ScreenGui = CreateScreenGui()

-- ══════════════════════════════════════
-- THEME MANAGER
-- ══════════════════════════════════════
function iHook:SetTheme(name)
    if self.Themes[name] then
        self.Theme = Utility.DeepCopy(self.Themes[name])
        self.CurrentTheme = name
        for _, win in pairs(self.Windows) do
            if win.UpdateTheme then task.spawn(function() win:UpdateTheme() end) end
        end
        return true
    end
    return false
end

function iHook:GetTheme() return self.Theme end
function iHook:GetThemeColor(name) return self.Theme[name] end
function iHook:GetAvailableThemes()
    local t = {}
    for name in pairs(self.Themes) do table.insert(t, name) end
    return t
end

function iHook:AddTheme(name, data)
    if type(name) == "string" and type(data) == "table" then
        self.Themes[name] = Utility.DeepCopy(data)
        return true
    end
    return false
end

iHook:SetTheme("Dark")

-- ══════════════════════════════════════
-- NOTIFICATION CONTAINER
-- ══════════════════════════════════════
local NotifContainer = Utility.Create("Frame", {
    Name = "Notifications",
    Parent = iHook.ScreenGui,
    BackgroundTransparency = 1,
    Position = UDim2.new(1, -20, 0, SafeAreaInsets.Top + 20),
    Size = UDim2.new(0, IsMobile and 280 or 320, 1, -60),
    AnchorPoint = Vector2.new(1, 0),
    ZIndex = 99999
})

Utility.Create("UIListLayout", {
    Parent = NotifContainer,
    SortOrder = Enum.SortOrder.LayoutOrder,
    VerticalAlignment = Enum.VerticalAlignment.Top,
    HorizontalAlignment = Enum.HorizontalAlignment.Right,
    Padding = UDim.new(0, 10)
})

iHook.NotificationContainer = NotifContainer

-- ══════════════════════════════════════
-- NOTIFICATION SYSTEM
-- ══════════════════════════════════════
function iHook:Notify(options)
    options = options or {}
    local title = options.Title or "Notification"
    local content = options.Content or ""
    local subContent = options.SubContent
    local duration = options.Duration or 5
    local notifType = options.Type or "Info"
    local callback = options.Callback
    
    local theme = self.Theme
    local scale = Utility.GetScale()
    
    local typeColors = {
        Info = theme.Info,
        Success = theme.Success,
        Warning = theme.Warning,
        Error = theme.Error
    }
    local accentColor = typeColors[notifType] or theme.Accent
    
    local notif = Utility.Create("Frame", {
        Name = "Notification",
        Parent = NotifContainer,
        BackgroundColor3 = theme.Primary,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        ClipsDescendants = true,
        Position = UDim2.new(1, 50, 0, 0),
        ZIndex = 99999
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = notif})
    Utility.Create("UIStroke", {Parent = notif, Color = theme.Border, Thickness = 1, Transparency = 0.5})
    
    -- Accent Bar
    local accent = Utility.Create("Frame", {
        Name = "Accent",
        Parent = notif,
        BackgroundColor3 = accentColor,
        Size = UDim2.new(0, 4, 1, 0),
        BorderSizePixel = 0,
        ZIndex = 100000
    })
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 2), Parent = accent})
    
    -- Content
    local contentFrame = Utility.Create("Frame", {
        Name = "Content",
        Parent = notif,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Position = UDim2.new(0, 16, 0, 0),
        ZIndex = 99999
    })
    
    Utility.Create("UIPadding", {
        Parent = contentFrame,
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 4),
        PaddingRight = UDim.new(0, 4)
    })
    
    Utility.Create("UIListLayout", {
        Parent = contentFrame,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 4)
    })
    
    -- Title
    Utility.Create("TextLabel", {
        Parent = contentFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Font = Enum.Font.GothamBold,
        Text = title,
        TextColor3 = theme.Text,
        TextSize = 14 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        LayoutOrder = 1,
        ZIndex = 99999
    })
    
    -- Content Text
    if content ~= "" then
        Utility.Create("TextLabel", {
            Parent = contentFrame,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 0),
            AutomaticSize = Enum.AutomaticSize.Y,
            Font = Enum.Font.Gotham,
            Text = content,
            TextColor3 = theme.TextDark,
            TextSize = 12 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            LayoutOrder = 2,
            ZIndex = 99999
        })
    end
    
    -- Sub Content
    if subContent then
        Utility.Create("TextLabel", {
            Parent = contentFrame,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 0),
            AutomaticSize = Enum.AutomaticSize.Y,
            Font = Enum.Font.Gotham,
            Text = subContent,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            LayoutOrder = 3,
            ZIndex = 99999
        })
    end
    
    -- Progress Bar
    local progress = Utility.Create("Frame", {
        Name = "Progress",
        Parent = notif,
        BackgroundColor3 = accentColor,
        Size = UDim2.new(1, 0, 0, 2),
        Position = UDim2.new(0, 0, 1, -2),
        BorderSizePixel = 0,
        ZIndex = 100000
    })
    
    -- Slide in
    Utility.SmoothTween(notif, {Position = UDim2.new(0, 0, 0, 0)}, 0.3)
    
    -- Progress animation & auto dismiss
    if duration and duration > 0 then
        Utility.Tween(progress, {Size = UDim2.new(0, 0, 0, 2)}, duration, Enum.EasingStyle.Linear)
        task.delay(duration, function()
            if notif and notif.Parent then
                Utility.SmoothTween(notif, {Position = UDim2.new(1, 50, 0, 0)}, 0.3)
                task.delay(0.3, function()
                    if notif and notif.Parent then notif:Destroy() end
                end)
            end
        end)
    end
    
    -- Click to dismiss
    local clickBtn = Utility.Create("TextButton", {
        Parent = notif,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Text = "",
        ZIndex = 100001
    })
    
    clickBtn.MouseButton1Click:Connect(function()
        if callback then Utility.SafeCall(callback) end
        Utility.SmoothTween(notif, {Position = UDim2.new(1, 50, 0, 0)}, 0.2)
        task.delay(0.2, function()
            if notif and notif.Parent then notif:Destroy() end
        end)
    end)
    
    return notif
end

-- ══════════════════════════════════════
-- WINDOW CLASS
-- ══════════════════════════════════════
local Window = {}
Window.__index = Window

function iHook:CreateWindow(options)
    options = options or {}
    
    local scale = Utility.GetScale()
    local theme = self.Theme
    
    local windowData = setmetatable({
        Title = options.Title or "iHook",
        SubTitle = options.SubTitle or "",
        Size = options.Size or UDim2.fromOffset(IsMobile and 360 or 580, IsMobile and 400 or 480),
        Position = options.Position or UDim2.new(0.5, 0, 0.5, 0),
        MinimizeKey = options.MinimizeKey or Enum.KeyCode.RightControl,
        TabWidth = options.TabWidth or (IsMobile and 50 or 60),
        
        Tabs = {},
        TabButtons = {},
        ActiveTab = nil,
        Minimized = false,
        Connections = {},
        ID = Utility.GenerateID(16)
    }, Window)
    
    -- Main Frame
    local mainFrame = Utility.Create("Frame", {
        Name = "iHookWindow_" .. windowData.ID,
        Parent = self.ScreenGui,
        BackgroundColor3 = theme.Primary,
        Size = Utility.ScaleUDim2(windowData.Size, scale),
        Position = windowData.Position,
        AnchorPoint = Vector2.new(0.5, 0.5),
        ClipsDescendants = true,
        ZIndex = 100
    })
    
    windowData.Frame = mainFrame
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 12), Parent = mainFrame})
    Utility.Create("UIStroke", {Parent = mainFrame, Color = theme.Border, Thickness = 1, Transparency = 0.3})
    
    -- Shadow
    local shadowFrame = Utility.Create("Frame", {
        Name = "Shadow",
        Parent = mainFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 60, 1, 60),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 99
    })
    
    Utility.Create("ImageLabel", {
        Parent = shadowFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Image = "rbxassetid://6014261993",
        ImageColor3 = theme.Shadow,
        ImageTransparency = 0.5,
        ScaleType = Enum.ScaleType.Slice,
        SliceCenter = Rect.new(49, 49, 450, 450),
        ZIndex = 99
    })
    
    -- Title Bar
    local titleBarHeight = IsMobile and 48 or 52
    
    local titleBar = Utility.Create("Frame", {
        Name = "TitleBar",
        Parent = mainFrame,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(1, 0, 0, titleBarHeight),
        BorderSizePixel = 0,
        ZIndex = 110
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 12), Parent = titleBar})
    
    -- Bottom cover for title bar corners
    Utility.Create("Frame", {
        Parent = titleBar,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(1, 0, 0, 15),
        Position = UDim2.new(0, 0, 1, -15),
        BorderSizePixel = 0,
        ZIndex = 109
    })
    
    -- Divider
    Utility.Create("Frame", {
        Parent = titleBar,
        BackgroundColor3 = theme.Divider,
        Size = UDim2.new(1, 0, 0, 1),
        Position = UDim2.new(0, 0, 1, -1),
        BorderSizePixel = 0,
        ZIndex = 111
    })
    
    windowData.TitleBar = titleBar
    
    -- Logo
    local logoFrame = Utility.Create("Frame", {
        Name = "Logo",
        Parent = titleBar,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(0, 30, 0, 30),
        Position = UDim2.new(0, 15, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ZIndex = 113
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = logoFrame})
    Utility.Create("UIGradient", {
        Parent = logoFrame,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, theme.Accent),
            ColorSequenceKeypoint.new(1, theme.AccentDark)
        }),
        Rotation = 45
    })
    
    Utility.Create("TextLabel", {
        Parent = logoFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Font = Enum.Font.GothamBold,
        Text = string.sub(windowData.Title, 1, 1),
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 16,
        ZIndex = 114
    })
    
    -- Title Text
    local titleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        Parent = titleBar,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -160, 0, 20),
        Position = UDim2.new(0, 55, 0, windowData.SubTitle ~= "" and 9 or 16),
        Font = Enum.Font.GothamBold,
        Text = windowData.Title,
        TextColor3 = theme.Text,
        TextSize = 16 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        ZIndex = 113
    })
    
    windowData.TitleLabel = titleLabel
    
    -- Subtitle
    if windowData.SubTitle ~= "" then
        Utility.Create("TextLabel", {
            Name = "SubTitle",
            Parent = titleBar,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -160, 0, 15),
            Position = UDim2.new(0, 55, 0, 29),
            Font = Enum.Font.Gotham,
            Text = windowData.SubTitle,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 113
        })
    end
    
    -- Controls Container
    local controls = Utility.Create("Frame", {
        Name = "Controls",
        Parent = titleBar,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 75, 0, 32),
        Position = UDim2.new(1, -15, 0.5, 0),
        AnchorPoint = Vector2.new(1, 0.5),
        ZIndex = 112
    })
    
    Utility.Create("UIListLayout", {
        Parent = controls,
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Padding = UDim.new(0, 8),
        SortOrder = Enum.SortOrder.LayoutOrder
    })
    
    -- Minimize Button
    local minimizeBtn = Utility.Create("TextButton", {
        Name = "Minimize",
        Parent = controls,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(0, 32, 0, 32),
        Font = Enum.Font.GothamBold,
        Text = "—",
        TextColor3 = theme.TextDark,
        TextSize = 14,
        AutoButtonColor = false,
        LayoutOrder = 1,
        ZIndex = 113
    })
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = minimizeBtn})
    
    -- Close Button
    local closeBtn = Utility.Create("TextButton", {
        Name = "Close",
        Parent = controls,
        BackgroundColor3 = theme.Error,
        BackgroundTransparency = 0.7,
        Size = UDim2.new(0, 32, 0, 32),
        Font = Enum.Font.GothamBold,
        Text = "×",
        TextColor3 = theme.Error,
        TextSize = 20,
        AutoButtonColor = false,
        LayoutOrder = 2,
        ZIndex = 113
    })
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = closeBtn})
    
    windowData.MinimizeButton = minimizeBtn
    windowData.CloseButton = closeBtn
    
    -- Button Interactions
    minimizeBtn.MouseEnter:Connect(function()
        Utility.SmoothTween(minimizeBtn, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    minimizeBtn.MouseLeave:Connect(function()
        Utility.SmoothTween(minimizeBtn, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    minimizeBtn.MouseButton1Click:Connect(function()
        Utility.Ripple(minimizeBtn)
        windowData:Minimize()
    end)
    
    closeBtn.MouseEnter:Connect(function()
        Utility.SmoothTween(closeBtn, {BackgroundTransparency = 0.3, TextColor3 = Color3.new(1,1,1)}, 0.15)
    end)
    closeBtn.MouseLeave:Connect(function()
        Utility.SmoothTween(closeBtn, {BackgroundTransparency = 0.7, TextColor3 = theme.Error}, 0.15)
    end)
    closeBtn.MouseButton1Click:Connect(function()
        Utility.Ripple(closeBtn)
        windowData:Close()
    end)
    
    -- Dragging
    local dragging, dragStart, startPos = false, nil, nil
    
    local function updateDrag(input)
        local delta = input.Position - dragStart
        Utility.Tween(mainFrame, {
            Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        }, 0.05)
    end
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            if dragging then updateDrag(input) end
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateDrag(input)
        end
    end)
    
    -- Tab Container (Left Side)
    local tabContainer = Utility.Create("Frame", {
        Name = "TabContainer",
        Parent = mainFrame,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(0, windowData.TabWidth, 1, -titleBarHeight),
        Position = UDim2.new(0, 0, 0, titleBarHeight),
        BorderSizePixel = 0,
        ZIndex = 105
    })
    
    -- Tab divider
    Utility.Create("Frame", {
        Parent = tabContainer,
        BackgroundColor3 = theme.Divider,
        Size = UDim2.new(0, 1, 1, 0),
        Position = UDim2.new(1, -1, 0, 0),
        BorderSizePixel = 0,
        ZIndex = 106
    })
    
    local tabList = Utility.Create("ScrollingFrame", {
        Name = "TabList",
        Parent = tabContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -2, 1, -10),
        Position = UDim2.new(0, 0, 0, 5),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 0,
        ScrollingDirection = Enum.ScrollingDirection.Y,
        ZIndex = 106
    })
    
    Utility.Create("UIListLayout", {
        Parent = tabList,
        SortOrder = Enum.SortOrder.LayoutOrder,
        HorizontalAlignment = Enum.HorizontalAlignment.Center,
        Padding = UDim.new(0, 5)
    })
    
    Utility.Create("UIPadding", {
        Parent = tabList,
        PaddingTop = UDim.new(0, 5),
        PaddingBottom = UDim.new(0, 5)
    })
    
    windowData.TabContainer = tabContainer
    windowData.TabList = tabList
    
    -- Content Container (Right Side)
    local contentContainer = Utility.Create("Frame", {
        Name = "ContentContainer",
        Parent = mainFrame,
        BackgroundColor3 = theme.Background,
        Size = UDim2.new(1, -windowData.TabWidth, 1, -titleBarHeight),
        Position = UDim2.new(0, windowData.TabWidth, 0, titleBarHeight),
        BorderSizePixel = 0,
        ClipsDescendants = true,
        ZIndex = 101
    })
    
    windowData.ContentContainer = contentContainer
    
    -- Minimize Key
    table.insert(windowData.Connections, UserInputService.InputBegan:Connect(function(input, processed)
        if not processed and input.KeyCode == windowData.MinimizeKey then
            windowData:Minimize()
        end
    end))
    
    -- Add to windows list
    table.insert(self.Windows, windowData)
    
    -- Open Animation
    mainFrame.Size = UDim2.new(0, 0, 0, 0)
    mainFrame.BackgroundTransparency = 1
    Utility.BounceTween(mainFrame, {
        Size = Utility.ScaleUDim2(windowData.Size, scale),
        BackgroundTransparency = 0
    }, 0.4)
    
    return windowData
end

-- ══════════════════════════════════════
-- WINDOW METHODS
-- ══════════════════════════════════════
function Window:Minimize()
    local theme = iHook.Theme
    self.Minimized = not self.Minimized
    
    if self.Minimized then
        Utility.SmoothTween(self.Frame, {Size = UDim2.new(0, self.Frame.Size.X.Offset, 0, 52)}, 0.3)
        self.ContentContainer.Visible = false
        self.TabContainer.Visible = false
    else
        local scale = Utility.GetScale()
        Utility.SmoothTween(self.Frame, {Size = Utility.ScaleUDim2(self.Size, scale)}, 0.3)
        task.delay(0.1, function()
            self.ContentContainer.Visible = true
            self.TabContainer.Visible = true
        end)
    end
end

function Window:Close()
    Utility.SmoothTween(self.Frame, {
        Size = UDim2.new(0, 0, 0, 0),
        BackgroundTransparency = 1
    }, 0.3)
    
    task.delay(0.3, function()
        for _, conn in pairs(self.Connections) do
            if conn then conn:Disconnect() end
        end
        
        for i, win in pairs(iHook.Windows) do
            if win.ID == self.ID then
                table.remove(iHook.Windows, i)
                break
            end
        end
        
        if self.Frame then self.Frame:Destroy() end
    end)
end

function Window:SetTitle(title)
    self.Title = title
    if self.TitleLabel then self.TitleLabel.Text = title end
end

function Window:SelectTab(index)
    if type(index) == "number" then
        local tab = self.Tabs[index]
        if tab then tab:Select() end
    elseif type(index) == "string" then
        for _, tab in pairs(self.Tabs) do
            if tab.Title == index then
                tab:Select()
                break
            end
        end
    end
end

-- ══════════════════════════════════════
-- TAB CLASS
-- ══════════════════════════════════════
local Tab = {}
Tab.__index = Tab

function Window:AddTab(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local tabData = setmetatable({
        Title = options.Title or "Tab",
        Icon = options.Icon or "",
        Window = self,
        Sections = {},
        Elements = {},
        Selected = false,
        ID = Utility.GenerateID(12)
    }, Tab)
    
    local tabBtnSize = IsMobile and 42 or 48
    
    -- Tab Button
    local tabButton = Utility.Create("TextButton", {
        Name = "Tab_" .. tabData.ID,
        Parent = self.TabList,
        BackgroundColor3 = theme.TabInactive,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, -10, 0, tabBtnSize),
        Font = Enum.Font.Gotham,
        Text = "",
        AutoButtonColor = false,
        LayoutOrder = #self.Tabs + 1,
        ZIndex = 107
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = tabButton})
    
    -- Active Indicator
    local indicator = Utility.Create("Frame", {
        Name = "Indicator",
        Parent = tabButton,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(0, 3, 0.6, 0),
        Position = UDim2.new(0, 0, 0.2, 0),
        BorderSizePixel = 0,
        Visible = false,
        ZIndex = 108
    })
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = indicator})
    
    -- Icon (if provided)
    local iconLabel
    if options.Icon and options.Icon ~= "" then
        iconLabel = Utility.Create("ImageLabel", {
            Name = "Icon",
            Parent = tabButton,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 20, 0, 20),
            Position = UDim2.new(0.5, 0, 0.5, 0),
            AnchorPoint = Vector2.new(0.5, 0.5),
            Image = "rbxassetid://" .. options.Icon,
            ImageColor3 = theme.TextDark,
            ZIndex = 108
        })
    else
        -- Text fallback
        local shortTitle = string.sub(tabData.Title, 1, 2)
        Utility.Create("TextLabel", {
            Name = "ShortTitle",
            Parent = tabButton,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 1, 0),
            Font = Enum.Font.GothamBold,
            Text = shortTitle,
            TextColor3 = theme.TextDark,
            TextSize = 14 * scale,
            ZIndex = 108
        })
    end
    
    -- Tooltip
    local tooltip = Utility.Create("Frame", {
        Name = "Tooltip",
        Parent = tabButton,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(0, 0, 0, 28),
        Position = UDim2.new(1, 8, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ClipsDescendants = true,
        Visible = false,
        ZIndex = 200
    })
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = tooltip})
    
    local tooltipText = Utility.Create("TextLabel", {
        Parent = tooltip,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -16, 1, 0),
        Position = UDim2.new(0, 8, 0, 0),
        Font = Enum.Font.GothamMedium,
        Text = tabData.Title,
        TextColor3 = theme.Text,
        TextSize = 12,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 201
    })
    
    tabData.Button = tabButton
    tabData.Indicator = indicator
    tabData.Tooltip = tooltip
    
    -- Hover Effects
    tabButton.MouseEnter:Connect(function()
        if not tabData.Selected then
            Utility.SmoothTween(tabButton, {BackgroundTransparency = 0.3, BackgroundColor3 = theme.Hover}, 0.15)
        end
        -- Show tooltip
        tooltip.Visible = true
        local textWidth = #tabData.Title * 8 + 20
        Utility.SmoothTween(tooltip, {Size = UDim2.new(0, textWidth, 0, 28)}, 0.2)
    end)
    
    tabButton.MouseLeave:Connect(function()
        if not tabData.Selected then
            Utility.SmoothTween(tabButton, {BackgroundTransparency = 0.5, BackgroundColor3 = theme.TabInactive}, 0.15)
        end
        -- Hide tooltip
        Utility.SmoothTween(tooltip, {Size = UDim2.new(0, 0, 0, 28)}, 0.15)
        task.delay(0.15, function()
            if tooltip.Size.X.Offset < 5 then tooltip.Visible = false end
        end)
    end)
    
    -- Click to select
    tabButton.MouseButton1Click:Connect(function()
        Utility.Ripple(tabButton)
        if IsMobile then Utility.Haptic(0.1) end
        tabData:Select()
    end)
    
    -- Tab Content Frame
    local contentFrame = Utility.Create("ScrollingFrame", {
        Name = "TabContent_" .. tabData.ID,
        Parent = self.ContentContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 4,
        ScrollBarImageColor3 = theme.ScrollThumb,
        ScrollingDirection = Enum.ScrollingDirection.Y,
        Visible = false,
        ZIndex = 102
    })
    
    Utility.Create("UIListLayout", {
        Parent = contentFrame,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 12),
        HorizontalAlignment = Enum.HorizontalAlignment.Center
    })
    
    Utility.Create("UIPadding", {
        Parent = contentFrame,
        PaddingTop = UDim.new(0, 15),
        PaddingBottom = UDim.new(0, 15),
        PaddingLeft = UDim.new(0, 15),
        PaddingRight = UDim.new(0, 15)
    })
    
    tabData.Content = contentFrame
    
    -- Auto-resize canvas
    contentFrame:GetPropertyChangedSignal("AbsoluteCanvasSize"):Connect(function()
        -- Handled by UIListLayout
    end)
    
    local layout = contentFrame:FindFirstChildOfClass("UIListLayout")
    if layout then
        layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            contentFrame.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 30)
        end)
    end
    
    table.insert(self.Tabs, tabData)
    self.TabButtons[tabData.ID] = tabButton
    
    -- Update tab list canvas
    task.defer(function()
        local listLayout = self.TabList:FindFirstChildOfClass("UIListLayout")
        if listLayout then
            self.TabList.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 20)
        end
    end)
    
    -- Select first tab
    if #self.Tabs == 1 then
        tabData:Select()
    end
    
    return tabData
end

-- ══════════════════════════════════════
-- TAB METHODS
-- ══════════════════════════════════════
function Tab:Select()
    local theme = iHook.Theme
    
    -- Deselect all tabs
    for _, tab in pairs(self.Window.Tabs) do
        if tab.ID ~= self.ID then
            tab.Selected = false
            tab.Indicator.Visible = false
            tab.Content.Visible = false
            Utility.SmoothTween(tab.Button, {
                BackgroundColor3 = theme.TabInactive,
                BackgroundTransparency = 0.5
            }, 0.2)
            
            local icon = tab.Button:FindFirstChild("Icon")
            local shortTitle = tab.Button:FindFirstChild("ShortTitle")
            if icon then Utility.SmoothTween(icon, {ImageColor3 = theme.TextDark}, 0.2) end
            if shortTitle then Utility.SmoothTween(shortTitle, {TextColor3 = theme.TextDark}, 0.2) end
        end
    end
    
    -- Select this tab
    self.Selected = true
    self.Indicator.Visible = true
    self.Content.Visible = true
    self.Window.ActiveTab = self
    
    Utility.SmoothTween(self.Button, {
        BackgroundColor3 = theme.TabActive,
        BackgroundTransparency = 0.2
    }, 0.2)
    
    local icon = self.Button:FindFirstChild("Icon")
    local shortTitle = self.Button:FindFirstChild("ShortTitle")
    if icon then Utility.SmoothTween(icon, {ImageColor3 = theme.Text}, 0.2) end
    if shortTitle then Utility.SmoothTween(shortTitle, {TextColor3 = theme.Text}, 0.2) end
    
    -- Indicator animation
    self.Indicator.Size = UDim2.new(0, 3, 0, 0)
    Utility.BounceTween(self.Indicator, {Size = UDim2.new(0, 3, 0.6, 0)}, 0.3)
end

-- ══════════════════════════════════════
-- SECTION CLASS
-- ══════════════════════════════════════
local Section = {}
Section.__index = Section

function Tab:AddSection(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local sectionData = setmetatable({
        Title = options.Title or "Section",
        Tab = self,
        Elements = {},
        ID = Utility.GenerateID(12)
    }, Section)
    
    -- Section Frame
    local sectionFrame = Utility.Create("Frame", {
        Name = "Section_" .. sectionData.ID,
        Parent = self.Content,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        LayoutOrder = #self.Sections + 1,
        ZIndex = 103
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = sectionFrame})
    Utility.Create("UIStroke", {Parent = sectionFrame, Color = theme.Border, Thickness = 1, Transparency = 0.5})
    
    -- Section Header
    local header = Utility.Create("Frame", {
        Name = "Header",
        Parent = sectionFrame,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, 36),
        BorderSizePixel = 0,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = header})
    
    -- Bottom cover for header corners
    Utility.Create("Frame", {
        Parent = header,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, 12),
        Position = UDim2.new(0, 0, 1, -12),
        BorderSizePixel = 0,
        ZIndex = 103
    })
    
    -- Header Title
    Utility.Create("TextLabel", {
        Parent = header,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 1, 0),
        Position = UDim2.new(0, 12, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = sectionData.Title,
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Section Content
    local content = Utility.Create("Frame", {
        Name = "Content",
        Parent = sectionFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Position = UDim2.new(0, 0, 0, 36),
        ZIndex = 103
    })
    
    Utility.Create("UIListLayout", {
        Parent = content,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 8),
        HorizontalAlignment = Enum.HorizontalAlignment.Center
    })
    
    Utility.Create("UIPadding", {
        Parent = content,
        PaddingTop = UDim.new(0, 8),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 10),
        PaddingRight = UDim.new(0, 10)
    })
    
    sectionData.Frame = sectionFrame
    sectionData.Header = header
    sectionData.Content = content
    
    table.insert(self.Sections, sectionData)
    
    return sectionData
end

-- ══════════════════════════════════════
-- DIRECT TAB ELEMENTS (Without Section)
-- ══════════════════════════════════════

-- CreateElementContainer - Helper for all elements
local function CreateElementContainer(parent, height, layoutOrder)
    local theme = iHook.Theme
    
    local container = Utility.Create("Frame", {
        Name = "ElementContainer",
        Parent = parent,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, height or 45),
        LayoutOrder = layoutOrder or 0,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    return container
end

-- ══════════════════════════════════════
-- PARAGRAPH
-- ══════════════════════════════════════
function Tab:AddParagraph(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "Paragraph",
        Parent = self.Content,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 103
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = container})
    
    Utility.Create("UIPadding", {
        Parent = container,
        PaddingTop = UDim.new(0, 12),
        PaddingBottom = UDim.new(0, 12),
        PaddingLeft = UDim.new(0, 14),
        PaddingRight = UDim.new(0, 14)
    })
    
    Utility.Create("UIListLayout", {
        Parent = container,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 4)
    })
    
    -- Title
    if options.Title then
        Utility.Create("TextLabel", {
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 0),
            AutomaticSize = Enum.AutomaticSize.Y,
            Font = Enum.Font.GothamBold,
            Text = options.Title,
            TextColor3 = theme.Text,
            TextSize = 14 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            LayoutOrder = 1,
            ZIndex = 104
        })
    end
    
    -- Content
    if options.Content then
        Utility.Create("TextLabel", {
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 0, 0),
            AutomaticSize = Enum.AutomaticSize.Y,
            Font = Enum.Font.Gotham,
            Text = options.Content,
            TextColor3 = theme.TextDark,
            TextSize = 12 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextWrapped = true,
            LayoutOrder = 2,
            ZIndex = 104
        })
    end
    
    table.insert(self.Elements, {Type = "Paragraph", Frame = container})
    
    return {
        SetTitle = function(_, title)
            local titleLabel = container:FindFirstChild("TextLabel")
            if titleLabel then titleLabel.Text = title end
        end,
        SetContent = function(_, content)
            local labels = container:GetChildren()
            for _, label in pairs(labels) do
                if label:IsA("TextLabel") and label.LayoutOrder == 2 then
                    label.Text = content
                    break
                end
            end
        end
    }
end

function Section:AddParagraph(options)
    return Tab.AddParagraph({Content = self.Content, Elements = self.Elements}, options)
end

-- ══════════════════════════════════════
-- BUTTON
-- ══════════════════════════════════════
function Tab:AddButton(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "Button",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 58 or 42),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Button
    local button = Utility.Create("TextButton", {
        Name = "Btn",
        Parent = container,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(1, -20, 0, options.Description and 32 or 28),
        Position = UDim2.new(0, 10, 0, options.Description and 18 or 7),
        Font = Enum.Font.GothamBold,
        Text = options.Title or "Button",
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 13 * scale,
        AutoButtonColor = false,
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})
    
    Utility.Create("UIGradient", {
        Parent = button,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.new(1, 1, 1)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(220, 220, 220))
        }),
        Rotation = 90,
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 0.95),
            NumberSequenceKeypoint.new(1, 1)
        })
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -20, 0, 14),
            Position = UDim2.new(0, 10, 0, 2),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    -- Hover
    button.MouseEnter:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.AccentHover}, 0.15)
    end)
    
    button.MouseLeave:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.Accent}, 0.15)
    end)
    
    -- Press effect
    button.MouseButton1Down:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.AccentDark}, 0.1)
    end)
    
    button.MouseButton1Up:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.AccentHover}, 0.1)
    end)
    
    -- Click
    button.MouseButton1Click:Connect(function()
        Utility.Ripple(button, Mouse.X, Mouse.Y)
        if IsMobile then Utility.Haptic(0.15) end
        if options.Callback then
            Utility.SafeCall(options.Callback)
        end
    end)
    
    table.insert(self.Elements, {Type = "Button", Frame = container, Button = button})
    
    return {
        SetText = function(_, text)
            button.Text = text
        end,
        SetCallback = function(_, callback)
            options.Callback = callback
        end,
        Fire = function(_)
            if options.Callback then Utility.SafeCall(options.Callback) end
        end
    }
end

function Section:AddButton(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "Button",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 58 or 42),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    local button = Utility.Create("TextButton", {
        Name = "Btn",
        Parent = container,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(1, -16, 0, options.Description and 30 or 28),
        Position = UDim2.new(0, 8, 0, options.Description and 20 or 7),
        Font = Enum.Font.GothamBold,
        Text = options.Title or "Button",
        TextColor3 = Color3.new(1, 1, 1),
        TextSize = 13 * scale,
        AutoButtonColor = false,
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})
    
    if options.Description then
        Utility.Create("TextLabel", {
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -16, 0, 14),
            Position = UDim2.new(0, 8, 0, 3),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    button.MouseEnter:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.AccentHover}, 0.15)
    end)
    
    button.MouseLeave:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.Accent}, 0.15)
    end)
    
    button.MouseButton1Click:Connect(function()
        Utility.Ripple(button, Mouse.X, Mouse.Y)
        if IsMobile then Utility.Haptic(0.15) end
        if options.Callback then Utility.SafeCall(options.Callback) end
    end)
    
    table.insert(self.Elements, {Type = "Button", Frame = container, Button = button})
    
    return {
        SetText = function(_, text) button.Text = text end,
        SetCallback = function(_, callback) options.Callback = callback end,
        Fire = function(_) if options.Callback then Utility.SafeCall(options.Callback) end end
    }
end

-- ══════════════════════════════════════
-- TOGGLE (SWITCH)
-- ══════════════════════════════════════
function Tab:AddToggle(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or false
    
    local container = Utility.Create("Frame", {
        Name = "Toggle",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 55 or 42),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -70, 0, 20),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 11),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Toggle",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -70, 0, 16),
            Position = UDim2.new(0, 12, 0, 28),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    -- Switch Background
    local switchBg = Utility.Create("Frame", {
        Name = "SwitchBg",
        Parent = container,
        BackgroundColor3 = value and theme.ToggleOn or theme.ToggleOff,
        Size = UDim2.new(0, 44, 0, 24),
        Position = UDim2.new(1, -56, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = switchBg})
    
    -- Switch Knob
    local knob = Utility.Create("Frame", {
        Name = "Knob",
        Parent = switchBg,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 18, 0, 18),
        Position = value and UDim2.new(1, -21, 0.5, 0) or UDim2.new(0, 3, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knob})
    
    -- Knob shadow
    Utility.Create("ImageLabel", {
        Parent = knob,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 6, 1, 6),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        Image = "rbxassetid://6014261993",
        ImageColor3 = Color3.new(0, 0, 0),
        ImageTransparency = 0.8,
        ScaleType = Enum.ScaleType.Slice,
        SliceCenter = Rect.new(49, 49, 450, 450),
        ZIndex = 105
    })
    
    -- Clickable area
    local clickArea = Utility.Create("TextButton", {
        Name = "ClickArea",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Text = "",
        ZIndex = 107
    })
    
    local function updateToggle(newValue, skipCallback)
        value = newValue
        
        Utility.SmoothTween(switchBg, {BackgroundColor3 = value and theme.ToggleOn or theme.ToggleOff}, 0.2)
        Utility.BounceTween(knob, {Position = value and UDim2.new(1, -21, 0.5, 0) or UDim2.new(0, 3, 0.5, 0)}, 0.25)
        
        if not skipCallback and options.Callback then
            Utility.SafeCall(options.Callback, value)
        end
        
        -- Update flags
        if flag then
            iHook.Flags[flag] = value
        end
    end
    
    clickArea.MouseButton1Click:Connect(function()
        if IsMobile then Utility.Haptic(0.1) end
        updateToggle(not value)
    end)
    
    -- Hover effect
    clickArea.MouseEnter:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    clickArea.MouseLeave:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    
    -- Create element object
    local toggleObj = {
        Type = "Toggle",
        Frame = container,
        Value = value,
        
        SetValue = function(self, newValue, skipCallback)
            updateToggle(newValue, skipCallback)
            self.Value = newValue
        end,
        
        OnChanged = function(self, callback)
            options.Callback = callback
        end,
        
        Destroy = function(self)
            container:Destroy()
        end
    }
    
    -- Set initial flag
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = toggleObj
    end
    
    table.insert(self.Elements, toggleObj)
    
    return toggleObj
end

function Section:AddToggle(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or false
    
    local container = Utility.Create("Frame", {
        Name = "Toggle",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 52 or 40),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -65, 0, 18),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 11),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Toggle",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -65, 0, 14),
            Position = UDim2.new(0, 10, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    local switchBg = Utility.Create("Frame", {
        Name = "SwitchBg",
        Parent = container,
        BackgroundColor3 = value and theme.ToggleOn or theme.ToggleOff,
        Size = UDim2.new(0, 40, 0, 22),
        Position = UDim2.new(1, -50, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = switchBg})
    
    local knob = Utility.Create("Frame", {
        Name = "Knob",
        Parent = switchBg,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 16, 0, 16),
        Position = value and UDim2.new(1, -19, 0.5, 0) or UDim2.new(0, 3, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knob})
    
    local clickArea = Utility.Create("TextButton", {
        Name = "ClickArea",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Text = "",
        ZIndex = 107
    })
    
    local function updateToggle(newValue, skipCallback)
        value = newValue
        Utility.SmoothTween(switchBg, {BackgroundColor3 = value and theme.ToggleOn or theme.ToggleOff}, 0.2)
        Utility.BounceTween(knob, {Position = value and UDim2.new(1, -19, 0.5, 0) or UDim2.new(0, 3, 0.5, 0)}, 0.25)
        if not skipCallback and options.Callback then Utility.SafeCall(options.Callback, value) end
        if flag then iHook.Flags[flag] = value end
    end
    
    clickArea.MouseButton1Click:Connect(function()
        if IsMobile then Utility.Haptic(0.1) end
        updateToggle(not value)
    end)
    
    local toggleObj = {
        Type = "Toggle",
        Frame = container,
        Value = value,
        SetValue = function(self, newValue, skipCallback)
            updateToggle(newValue, skipCallback)
            self.Value = newValue
        end,
        OnChanged = function(self, callback)
            options.Callback = callback
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = toggleObj
    end
    
    table.insert(self.Elements, toggleObj)
    return toggleObj
end

-- ══════════════════════════════════════
-- SLIDER
-- ══════════════════════════════════════
function Tab:AddSlider(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local min = options.Min or 0
    local max = options.Max or 100
    local default = options.Default or min
    local rounding = options.Rounding or 0
    local suffix = options.Suffix or ""
    local value = default
    
    local container = Utility.Create("Frame", {
        Name = "Slider",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 70 or 58),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    local titleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.6, -10, 0, 18),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 10),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Slider",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Value label
    local valueLabel = Utility.Create("TextLabel", {
        Name = "Value",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.4, -10, 0, 18),
        Position = UDim2.new(0.6, 0, 0, options.Description and 8 or 10),
        Font = Enum.Font.GothamBold,
        Text = Utility.Round(value, rounding) .. suffix,
        TextColor3 = theme.Accent,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Right,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -24, 0, 14),
            Position = UDim2.new(0, 12, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    -- Slider Track
    local track = Utility.Create("Frame", {
        Name = "Track",
        Parent = container,
        BackgroundColor3 = theme.SliderTrack,
        Size = UDim2.new(1, -24, 0, 8),
        Position = UDim2.new(0, 12, 1, -20),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = track})
    
    -- Slider Fill
    local initialPercent = (value - min) / (max - min)
    
    local fill = Utility.Create("Frame", {
        Name = "Fill",
        Parent = track,
        BackgroundColor3 = theme.SliderFill,
        Size = UDim2.new(initialPercent, 0, 1, 0),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = fill})
    
    Utility.Create("UIGradient", {
        Parent = fill,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.new(1, 1, 1)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(200, 200, 200))
        }),
        Rotation = 90,
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 0.9),
            NumberSequenceKeypoint.new(1, 1)
        })
    })
    
    -- Slider Knob
    local knob = Utility.Create("Frame", {
        Name = "Knob",
        Parent = track,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 18, 0, 18),
        Position = UDim2.new(initialPercent, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 107
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knob})
    Utility.Create("UIStroke", {Parent = knob, Color = theme.Accent, Thickness = 2})
    
    -- Knob inner glow
    local knobGlow = Utility.Create("Frame", {
        Name = "Glow",
        Parent = knob,
        BackgroundColor3 = theme.Accent,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(0, 8, 0, 8),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 108
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knobGlow})
    
    -- Dragging logic
    local dragging = false
    
    local function updateSlider(input)
        local trackPos = track.AbsolutePosition.X
        local trackSize = track.AbsoluteSize.X
        local mouseX = input.Position.X
        
        local percent = math.clamp((mouseX - trackPos) / trackSize, 0, 1)
        local newValue = min + (max - min) * percent
        newValue = Utility.Round(newValue, rounding)
        
        if newValue ~= value then
            value = newValue
            valueLabel.Text = value .. suffix
            
            Utility.SmoothTween(fill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.05)
            Utility.SmoothTween(knob, {Position = UDim2.new(percent, 0, 0.5, 0)}, 0.05)
            
            if options.Callback then
                Utility.SafeCall(options.Callback, value)
            end
            
            if flag then
                iHook.Flags[flag] = value
            end
        end
    end
    
    -- Input connections
    local inputBegan = Utility.Create("TextButton", {
        Name = "InputArea",
        Parent = track,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 20, 1, 20),
        Position = UDim2.new(0, -10, 0, -10),
        Text = "",
        ZIndex = 110
    })
    
    inputBegan.MouseButton1Down:Connect(function()
        dragging = true
        if IsMobile then Utility.Haptic(0.05) end
        Utility.SmoothTween(knob, {Size = UDim2.new(0, 22, 0, 22)}, 0.1)
        Utility.SmoothTween(knobGlow, {BackgroundTransparency = 0.3}, 0.1)
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            if dragging then
                dragging = false
                Utility.SmoothTween(knob, {Size = UDim2.new(0, 18, 0, 18)}, 0.1)
                Utility.SmoothTween(knobGlow, {BackgroundTransparency = 0.5}, 0.1)
            end
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateSlider(input)
        end
    end)
    
    inputBegan.MouseButton1Click:Connect(function()
        local mouse = UserInputService:GetMouseLocation()
        updateSlider({Position = Vector3.new(mouse.X, mouse.Y, 0)})
    end)
    
    -- Hover effects
    container.MouseEnter:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    container.MouseLeave:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    
    local sliderObj = {
        Type = "Slider",
        Frame = container,
        Value = value,
        
        SetValue = function(self, newValue, skipCallback)
            newValue = math.clamp(newValue, min, max)
            newValue = Utility.Round(newValue, rounding)
            value = newValue
            self.Value = value
            
            local percent = (value - min) / (max - min)
            valueLabel.Text = value .. suffix
            fill.Size = UDim2.new(percent, 0, 1, 0)
            knob.Position = UDim2.new(percent, 0, 0.5, 0)
            
            if not skipCallback and options.Callback then
                Utility.SafeCall(options.Callback, value)
            end
            
            if flag then iHook.Flags[flag] = value end
        end,
        
        OnChanged = function(self, callback)
            options.Callback = callback
        end,
        
        GetValue = function(self)
            return value
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = sliderObj
    end
    
    table.insert(self.Elements, sliderObj)
    return sliderObj
end

function Section:AddSlider(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local min = options.Min or 0
    local max = options.Max or 100
    local default = options.Default or min
    local rounding = options.Rounding or 0
    local suffix = options.Suffix or ""
    local value = default
    
    local container = Utility.Create("Frame", {
        Name = "Slider",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 65 or 55),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.6, -10, 0, 16),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 8),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Slider",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    local valueLabel = Utility.Create("TextLabel", {
        Name = "Value",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.4, -10, 0, 16),
        Position = UDim2.new(0.6, 0, 0, options.Description and 6 or 8),
        Font = Enum.Font.GothamBold,
        Text = Utility.Round(value, rounding) .. suffix,
        TextColor3 = theme.Accent,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Right,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -20, 0, 12),
            Position = UDim2.new(0, 10, 0, 24),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    local track = Utility.Create("Frame", {
        Name = "Track",
        Parent = container,
        BackgroundColor3 = theme.SliderTrack,
        Size = UDim2.new(1, -20, 0, 6),
        Position = UDim2.new(0, 10, 1, -16),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = track})
    
    local initialPercent = (value - min) / (max - min)
    
    local fill = Utility.Create("Frame", {
        Name = "Fill",
        Parent = track,
        BackgroundColor3 = theme.SliderFill,
        Size = UDim2.new(initialPercent, 0, 1, 0),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = fill})
    
    local knob = Utility.Create("Frame", {
        Name = "Knob",
        Parent = track,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 14, 0, 14),
        Position = UDim2.new(initialPercent, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 107
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = knob})
    Utility.Create("UIStroke", {Parent = knob, Color = theme.Accent, Thickness = 2})
    
    local dragging = false
    
    local function updateSlider(input)
        local trackPos = track.AbsolutePosition.X
        local trackSize = track.AbsoluteSize.X
        local mouseX = input.Position.X
        
        local percent = math.clamp((mouseX - trackPos) / trackSize, 0, 1)
        local newValue = min + (max - min) * percent
        newValue = Utility.Round(newValue, rounding)
        
        if newValue ~= value then
            value = newValue
            valueLabel.Text = value .. suffix
            Utility.SmoothTween(fill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.05)
            Utility.SmoothTween(knob, {Position = UDim2.new(percent, 0, 0.5, 0)}, 0.05)
            if options.Callback then Utility.SafeCall(options.Callback, value) end
            if flag then iHook.Flags[flag] = value end
        end
    end
    
    local inputArea = Utility.Create("TextButton", {
        Name = "InputArea",
        Parent = track,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 16, 1, 16),
        Position = UDim2.new(0, -8, 0, -8),
        Text = "",
        ZIndex = 110
    })
    
    inputArea.MouseButton1Down:Connect(function()
        dragging = true
        if IsMobile then Utility.Haptic(0.05) end
        Utility.SmoothTween(knob, {Size = UDim2.new(0, 18, 0, 18)}, 0.1)
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) and dragging then
            dragging = false
            Utility.SmoothTween(knob, {Size = UDim2.new(0, 14, 0, 14)}, 0.1)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateSlider(input)
        end
    end)
    
    inputArea.MouseButton1Click:Connect(function()
        local mouse = UserInputService:GetMouseLocation()
        updateSlider({Position = Vector3.new(mouse.X, mouse.Y, 0)})
    end)
    
    local sliderObj = {
        Type = "Slider",
        Frame = container,
        Value = value,
        SetValue = function(self, newValue, skipCallback)
            newValue = math.clamp(newValue, min, max)
            newValue = Utility.Round(newValue, rounding)
            value = newValue
            self.Value = value
            local percent = (value - min) / (max - min)
            valueLabel.Text = value .. suffix
            fill.Size = UDim2.new(percent, 0, 1, 0)
            knob.Position = UDim2.new(percent, 0, 0.5, 0)
            if not skipCallback and options.Callback then Utility.SafeCall(options.Callback, value) end
            if flag then iHook.Flags[flag] = value end
        end,
        OnChanged = function(self, callback) options.Callback = callback end,
        GetValue = function(self) return value end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = sliderObj
    end
    
    table.insert(self.Elements, sliderObj)
    return sliderObj
end

-- ══════════════════════════════════════
-- DROPDOWN
-- ══════════════════════════════════════
function Tab:AddDropdown(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local values = options.Values or {}
    local multi = options.Multi or false
    local default = options.Default
    local value = multi and {} or nil
    
    -- Set default value
    if multi then
        if type(default) == "table" then
            for _, v in pairs(default) do
                value[v] = true
            end
        end
    else
        if default then
            if type(default) == "number" and values[default] then
                value = values[default]
            elseif type(default) == "string" then
                value = default
            end
        end
    end
    
    local isOpen = false
    
    local container = Utility.Create("Frame", {
        Name = "Dropdown",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 70 or 58),
        ClipsDescendants = false,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 0, 18),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 6),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Dropdown",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -20, 0, 14),
            Position = UDim2.new(0, 12, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    -- Dropdown Button
    local dropBtn = Utility.Create("TextButton", {
        Name = "DropdownBtn",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(1, -24, 0, 28),
        Position = UDim2.new(0, 12, 1, -36),
        Font = Enum.Font.Gotham,
        Text = "",
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = dropBtn})
    Utility.Create("UIStroke", {Parent = dropBtn, Color = theme.Border, Thickness = 1})
    
    -- Selected text
    local function getDisplayText()
        if multi then
            local selected = {}
            for v, s in pairs(value) do
                if s then table.insert(selected, v) end
            end
            if #selected == 0 then return "Select..." end
            if #selected > 2 then return #selected .. " selected" end
            return table.concat(selected, ", ")
        else
            return value or "Select..."
        end
    end
    
    local selectedLabel = Utility.Create("TextLabel", {
        Name = "Selected",
        Parent = dropBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -30, 1, 0),
        Position = UDim2.new(0, 10, 0, 0),
        Font = Enum.Font.Gotham,
        Text = getDisplayText(),
        TextColor3 = value and theme.Text or theme.TextDarker,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        ZIndex = 107
    })
    
    -- Arrow icon
    local arrow = Utility.Create("TextLabel", {
        Name = "Arrow",
        Parent = dropBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 20, 1, 0),
        Position = UDim2.new(1, -25, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = "▼",
        TextColor3 = theme.TextDark,
        TextSize = 10,
        ZIndex = 107
    })
    
    -- Options Container
    local optionsContainer = Utility.Create("Frame", {
        Name = "Options",
        Parent = container,
        BackgroundColor3 = theme.DropdownBg,
        Size = UDim2.new(1, -24, 0, 0),
        Position = UDim2.new(0, 12, 1, -4),
        ClipsDescendants = true,
        Visible = false,
        ZIndex = 200
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = optionsContainer})
    Utility.Create("UIStroke", {Parent = optionsContainer, Color = theme.Border, Thickness = 1})
    
    local optionsList = Utility.Create("ScrollingFrame", {
        Name = "List",
        Parent = optionsContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 3,
        ScrollBarImageColor3 = theme.ScrollThumb,
        ZIndex = 201
    })
    
    Utility.Create("UIListLayout", {
        Parent = optionsList,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 2)
    })
    
    Utility.Create("UIPadding", {
        Parent = optionsList,
        PaddingTop = UDim.new(0, 4),
        PaddingBottom = UDim.new(0, 4),
        PaddingLeft = UDim.new(0, 4),
        PaddingRight = UDim.new(0, 4)
    })
    
    -- Create option buttons
    local optionButtons = {}
    
    local function createOption(optionValue)
        local isSelected = multi and value[optionValue] or value == optionValue
        
        local optionBtn = Utility.Create("TextButton", {
            Name = "Option_" .. optionValue,
            Parent = optionsList,
            BackgroundColor3 = isSelected and theme.Accent or theme.Tertiary,
            BackgroundTransparency = isSelected and 0.3 or 0.5,
            Size = UDim2.new(1, -4, 0, 28),
            Font = Enum.Font.Gotham,
            Text = "",
            AutoButtonColor = false,
            ZIndex = 202
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = optionBtn})
        
        local optionLabel = Utility.Create("TextLabel", {
            Parent = optionBtn,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, multi and -30 or -10, 1, 0),
            Position = UDim2.new(0, 8, 0, 0),
            Font = Enum.Font.Gotham,
            Text = optionValue,
            TextColor3 = isSelected and theme.Text or theme.TextDark,
            TextSize = 12 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 203
        })
        
        -- Checkbox for multi
        local checkbox
        if multi then
            checkbox = Utility.Create("Frame", {
                Name = "Checkbox",
                Parent = optionBtn,
                BackgroundColor3 = isSelected and theme.Accent or theme.ToggleOff,
                Size = UDim2.new(0, 16, 0, 16),
                Position = UDim2.new(1, -24, 0.5, 0),
                AnchorPoint = Vector2.new(0, 0.5),
                ZIndex = 203
            })
            
            Utility.Create("UICorner", {CornerRadius = UDim.new(0, 4), Parent = checkbox})
            
            local checkmark = Utility.Create("TextLabel", {
                Parent = checkbox,
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 1, 0),
                Font = Enum.Font.GothamBold,
                Text = isSelected and "✓" or "",
                TextColor3 = Color3.new(1, 1, 1),
                TextSize = 12,
                ZIndex = 204
            })
        end
        
        -- Hover
        optionBtn.MouseEnter:Connect(function()
            if not (multi and value[optionValue] or value == optionValue) then
                Utility.SmoothTween(optionBtn, {BackgroundColor3 = theme.Hover, BackgroundTransparency = 0.3}, 0.15)
            end
        end)
        
        optionBtn.MouseLeave:Connect(function()
            local selected = multi and value[optionValue] or value == optionValue
            Utility.SmoothTween(optionBtn, {
                BackgroundColor3 = selected and theme.Accent or theme.Tertiary,
                BackgroundTransparency = selected and 0.3 or 0.5
            }, 0.15)
        end)
        
        -- Click
        optionBtn.MouseButton1Click:Connect(function()
            if IsMobile then Utility.Haptic(0.1) end
            
            if multi then
                value[optionValue] = not value[optionValue]
                local selected = value[optionValue]
                
                Utility.SmoothTween(optionBtn, {
                    BackgroundColor3 = selected and theme.Accent or theme.Tertiary,
                    BackgroundTransparency = selected and 0.3 or 0.5
                }, 0.15)
                Utility.SmoothTween(optionLabel, {TextColor3 = selected and theme.Text or theme.TextDark}, 0.15)
                
                if checkbox then
                    Utility.SmoothTween(checkbox, {BackgroundColor3 = selected and theme.Accent or theme.ToggleOff}, 0.15)
                    checkbox:FindFirstChild("TextLabel").Text = selected and "✓" or ""
                end
                
                selectedLabel.Text = getDisplayText()
                selectedLabel.TextColor3 = theme.Text
                
                if options.Callback then
                    Utility.SafeCall(options.Callback, value)
                end
            else
                -- Deselect all
                for _, btn in pairs(optionButtons) do
                    Utility.SmoothTween(btn.Button, {BackgroundColor3 = theme.Tertiary, BackgroundTransparency = 0.5}, 0.15)
                    Utility.SmoothTween(btn.Label, {TextColor3 = theme.TextDark}, 0.15)
                end
                
                -- Select this one
                value = optionValue
                Utility.SmoothTween(optionBtn, {BackgroundColor3 = theme.Accent, BackgroundTransparency = 0.3}, 0.15)
                Utility.SmoothTween(optionLabel, {TextColor3 = theme.Text}, 0.15)
                
                selectedLabel.Text = value
                selectedLabel.TextColor3 = theme.Text
                
                if options.Callback then
                    Utility.SafeCall(options.Callback, value)
                end
                
                -- Close dropdown
                task.delay(0.1, function()
                    if isOpen then
                        isOpen = false
                        Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -24, 0, 0)}, 0.2)
                        Utility.SmoothTween(arrow, {Rotation = 0}, 0.2)
                        task.delay(0.2, function()
                            optionsContainer.Visible = false
                        end)
                    end
                end)
            end
            
            if flag then
                iHook.Flags[flag] = value
            end
        end)
        
        table.insert(optionButtons, {Button = optionBtn, Label = optionLabel, Value = optionValue})
    end
    
    for _, v in ipairs(values) do
        createOption(v)
    end
    
    -- Update canvas size
    local listLayout = optionsList:FindFirstChildOfClass("UIListLayout")
    if listLayout then
        optionsList.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 8)
    end
    
    -- Toggle dropdown
    local function toggleDropdown()
        isOpen = not isOpen
        
        if isOpen then
            optionsContainer.Visible = true
            local numOptions = #values
            local optionHeight = math.min(numOptions * 30 + 8, 180)
            Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -24, 0, optionHeight)}, 0.25)
            Utility.SmoothTween(arrow, {Rotation = 180}, 0.25)
        else
            Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -24, 0, 0)}, 0.2)
            Utility.SmoothTween(arrow, {Rotation = 0}, 0.2)
            task.delay(0.2, function()
                if not isOpen then
                    optionsContainer.Visible = false
                end
            end)
        end
    end
    
    dropBtn.MouseButton1Click:Connect(function()
        Utility.Ripple(dropBtn, Mouse.X, Mouse.Y)
        toggleDropdown()
    end)
    
    -- Hover effects
    dropBtn.MouseEnter:Connect(function()
        Utility.SmoothTween(dropBtn, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    dropBtn.MouseLeave:Connect(function()
        Utility.SmoothTween(dropBtn, {BackgroundColor3 = theme.InputBg}, 0.15)
    end)
    
    local dropdownObj = {
        Type = "Dropdown",
        Frame = container,
        Value = value,
        
        SetValue = function(self, newValue)
            if multi then
                if type(newValue) == "table" then
                    value = {}
                    for k, v in pairs(newValue) do
                        if type(k) == "string" then
                            value[k] = v
                        else
                            value[v] = true
                        end
                    end
                end
            else
                value = newValue
            end
            self.Value = value
            selectedLabel.Text = getDisplayText()
            selectedLabel.TextColor3 = value and theme.Text or theme.TextDarker
            
            -- Update option buttons
            for _, btn in pairs(optionButtons) do
                local selected = multi and value[btn.Value] or value == btn.Value
                btn.Button.BackgroundColor3 = selected and theme.Accent or theme.Tertiary
                btn.Button.BackgroundTransparency = selected and 0.3 or 0.5
                btn.Label.TextColor3 = selected and theme.Text or theme.TextDark
                
                if multi then
                    local cb = btn.Button:FindFirstChild("Checkbox")
                    if cb then
                        cb.BackgroundColor3 = selected and theme.Accent or theme.ToggleOff
                        cb:FindFirstChild("TextLabel").Text = selected and "✓" or ""
                    end
                end
            end
            
            if flag then iHook.Flags[flag] = value end
        end,
        
        Refresh = function(self, newValues)
            values = newValues
            
            -- Clear existing options
            for _, btn in pairs(optionButtons) do
                btn.Button:Destroy()
            end
            optionButtons = {}
            
            -- Create new options
            for _, v in ipairs(values) do
                createOption(v)
            end
            
            -- Update canvas
            task.defer(function()
                local layout = optionsList:FindFirstChildOfClass("UIListLayout")
                if layout then
                    optionsList.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 8)
                end
            end)
        end,
        
        OnChanged = function(self, callback)
            options.Callback = callback
        end,
        
        GetValue = function(self)
            return value
        end,
        
        Open = function(self)
            if not isOpen then toggleDropdown() end
        end,
        
        Close = function(self)
            if isOpen then toggleDropdown() end
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = dropdownObj
    end
    
    table.insert(self.Elements, dropdownObj)
    return dropdownObj
end

function Section:AddDropdown(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local values = options.Values or {}
    local multi = options.Multi or false
    local default = options.Default
    local value = multi and {} or nil
    
    if multi then
        if type(default) == "table" then
            for _, v in pairs(default) do value[v] = true end
        end
    else
        if default then
            if type(default) == "number" and values[default] then
                value = values[default]
            elseif type(default) == "string" then
                value = default
            end
        end
    end
    
    local isOpen = false
    
    local container = Utility.Create("Frame", {
        Name = "Dropdown",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 65 or 55),
        ClipsDescendants = false,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -16, 0, 16),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 5),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Dropdown",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -16, 0, 12),
            Position = UDim2.new(0, 10, 0, 22),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    local dropBtn = Utility.Create("TextButton", {
        Name = "DropdownBtn",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(1, -20, 0, 24),
        Position = UDim2.new(0, 10, 1, -30),
        Font = Enum.Font.Gotham,
        Text = "",
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = dropBtn})
    Utility.Create("UIStroke", {Parent = dropBtn, Color = theme.Border, Thickness = 1})
    
    local function getDisplayText()
        if multi then
            local selected = {}
            for v, s in pairs(value) do
                if s then table.insert(selected, v) end
            end
            if #selected == 0 then return "Select..." end
            if #selected > 2 then return #selected .. " selected" end
            return table.concat(selected, ", ")
        else
            return value or "Select..."
        end
    end
    
    local selectedLabel = Utility.Create("TextLabel", {
        Name = "Selected",
        Parent = dropBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -26, 1, 0),
        Position = UDim2.new(0, 8, 0, 0),
        Font = Enum.Font.Gotham,
        Text = getDisplayText(),
        TextColor3 = value and theme.Text or theme.TextDarker,
        TextSize = 11 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        ZIndex = 107
    })
    
    local arrow = Utility.Create("TextLabel", {
        Name = "Arrow",
        Parent = dropBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 18, 1, 0),
        Position = UDim2.new(1, -22, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = "▼",
        TextColor3 = theme.TextDark,
        TextSize = 9,
        ZIndex = 107
    })
    
    local optionsContainer = Utility.Create("Frame", {
        Name = "Options",
        Parent = container,
        BackgroundColor3 = theme.DropdownBg,
        Size = UDim2.new(1, -20, 0, 0),
        Position = UDim2.new(0, 10, 1, -4),
        ClipsDescendants = true,
        Visible = false,
        ZIndex = 200
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = optionsContainer})
    Utility.Create("UIStroke", {Parent = optionsContainer, Color = theme.Border, Thickness = 1})
    
    local optionsList = Utility.Create("ScrollingFrame", {
        Name = "List",
        Parent = optionsContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        CanvasSize = UDim2.new(0, 0, 0, 0),
        ScrollBarThickness = 2,
        ScrollBarImageColor3 = theme.ScrollThumb,
        ZIndex = 201
    })
    
    Utility.Create("UIListLayout", {Parent = optionsList, SortOrder = Enum.SortOrder.LayoutOrder, Padding = UDim.new(0, 2)})
    Utility.Create("UIPadding", {Parent = optionsList, PaddingTop = UDim.new(0, 3), PaddingBottom = UDim.new(0, 3), PaddingLeft = UDim.new(0, 3), PaddingRight = UDim.new(0, 3)})
    
    local optionButtons = {}
    
    local function createOption(optionValue)
        local isSelected = multi and value[optionValue] or value == optionValue
        
        local optionBtn = Utility.Create("TextButton", {
            Name = "Option_" .. optionValue,
            Parent = optionsList,
            BackgroundColor3 = isSelected and theme.Accent or theme.Tertiary,
            BackgroundTransparency = isSelected and 0.3 or 0.5,
            Size = UDim2.new(1, -2, 0, 24),
            Font = Enum.Font.Gotham,
            Text = "",
            AutoButtonColor = false,
            ZIndex = 202
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(0, 4), Parent = optionBtn})
        
        local optionLabel = Utility.Create("TextLabel", {
            Parent = optionBtn,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, multi and -26 or -8, 1, 0),
            Position = UDim2.new(0, 6, 0, 0),
            Font = Enum.Font.Gotham,
            Text = optionValue,
            TextColor3 = isSelected and theme.Text or theme.TextDark,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 203
        })
        
        local checkbox
        if multi then
            checkbox = Utility.Create("Frame", {
                Name = "Checkbox",
                Parent = optionBtn,
                BackgroundColor3 = isSelected and theme.Accent or theme.ToggleOff,
                Size = UDim2.new(0, 14, 0, 14),
                Position = UDim2.new(1, -20, 0.5, 0),
                AnchorPoint = Vector2.new(0, 0.5),
                ZIndex = 203
            })
            Utility.Create("UICorner", {CornerRadius = UDim.new(0, 3), Parent = checkbox})
            Utility.Create("TextLabel", {
                Parent = checkbox,
                BackgroundTransparency = 1,
                Size = UDim2.new(1, 0, 1, 0),
                Font = Enum.Font.GothamBold,
                Text = isSelected and "✓" or "",
                TextColor3 = Color3.new(1, 1, 1),
                TextSize = 10,
                ZIndex = 204
            })
        end
        
        optionBtn.MouseEnter:Connect(function()
            if not (multi and value[optionValue] or value == optionValue) then
                Utility.SmoothTween(optionBtn, {BackgroundColor3 = theme.Hover, BackgroundTransparency = 0.3}, 0.15)
            end
        end)
        
        optionBtn.MouseLeave:Connect(function()
            local selected = multi and value[optionValue] or value == optionValue
            Utility.SmoothTween(optionBtn, {BackgroundColor3 = selected and theme.Accent or theme.Tertiary, BackgroundTransparency = selected and 0.3 or 0.5}, 0.15)
        end)
        
        optionBtn.MouseButton1Click:Connect(function()
            if IsMobile then Utility.Haptic(0.1) end
            
            if multi then
                value[optionValue] = not value[optionValue]
                local selected = value[optionValue]
                Utility.SmoothTween(optionBtn, {BackgroundColor3 = selected and theme.Accent or theme.Tertiary, BackgroundTransparency = selected and 0.3 or 0.5}, 0.15)
                Utility.SmoothTween(optionLabel, {TextColor3 = selected and theme.Text or theme.TextDark}, 0.15)
                if checkbox then
                    Utility.SmoothTween(checkbox, {BackgroundColor3 = selected and theme.Accent or theme.ToggleOff}, 0.15)
                    checkbox:FindFirstChild("TextLabel").Text = selected and "✓" or ""
                end
                selectedLabel.Text = getDisplayText()
                if options.Callback then Utility.SafeCall(options.Callback, value) end
            else
                for _, btn in pairs(optionButtons) do
                    Utility.SmoothTween(btn.Button, {BackgroundColor3 = theme.Tertiary, BackgroundTransparency = 0.5}, 0.15)
                    Utility.SmoothTween(btn.Label, {TextColor3 = theme.TextDark}, 0.15)
                end
                value = optionValue
                Utility.SmoothTween(optionBtn, {BackgroundColor3 = theme.Accent, BackgroundTransparency = 0.3}, 0.15)
                Utility.SmoothTween(optionLabel, {TextColor3 = theme.Text}, 0.15)
                selectedLabel.Text = value
                selectedLabel.TextColor3 = theme.Text
                if options.Callback then Utility.SafeCall(options.Callback, value) end
                task.delay(0.1, function()
                    if isOpen then
                        isOpen = false
                        Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -20, 0, 0)}, 0.2)
                        Utility.SmoothTween(arrow, {Rotation = 0}, 0.2)
                        task.delay(0.2, function() optionsContainer.Visible = false end)
                    end
                end)
            end
            if flag then iHook.Flags[flag] = value end
        end)
        
        table.insert(optionButtons, {Button = optionBtn, Label = optionLabel, Value = optionValue})
    end
    
    for _, v in ipairs(values) do createOption(v) end
    
    local listLayout = optionsList:FindFirstChildOfClass("UIListLayout")
    if listLayout then optionsList.CanvasSize = UDim2.new(0, 0, 0, listLayout.AbsoluteContentSize.Y + 6) end
    
    local function toggleDropdown()
        isOpen = not isOpen
        if isOpen then
            optionsContainer.Visible = true
            local optionHeight = math.min(#values * 26 + 6, 150)
            Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -20, 0, optionHeight)}, 0.25)
            Utility.SmoothTween(arrow, {Rotation = 180}, 0.25)
        else
            Utility.SmoothTween(optionsContainer, {Size = UDim2.new(1, -20, 0, 0)}, 0.2)
            Utility.SmoothTween(arrow, {Rotation = 0}, 0.2)
            task.delay(0.2, function() if not isOpen then optionsContainer.Visible = false end end)
        end
    end
    
    dropBtn.MouseButton1Click:Connect(function()
        Utility.Ripple(dropBtn, Mouse.X, Mouse.Y)
        toggleDropdown()
    end)
    
    local dropdownObj = {
        Type = "Dropdown",
        Frame = container,
        Value = value,
        SetValue = function(self, newValue)
            if multi then
                if type(newValue) == "table" then
                    value = {}
                    for k, v in pairs(newValue) do
                        if type(k) == "string" then value[k] = v else value[v] = true end
                    end
                end
            else
                value = newValue
            end
            self.Value = value
            selectedLabel.Text = getDisplayText()
            for _, btn in pairs(optionButtons) do
                local selected = multi and value[btn.Value] or value == btn.Value
                btn.Button.BackgroundColor3 = selected and theme.Accent or theme.Tertiary
                btn.Button.BackgroundTransparency = selected and 0.3 or 0.5
                btn.Label.TextColor3 = selected and theme.Text or theme.TextDark
                if multi then
                    local cb = btn.Button:FindFirstChild("Checkbox")
                    if cb then
                        cb.BackgroundColor3 = selected and theme.Accent or theme.ToggleOff
                        cb:FindFirstChild("TextLabel").Text = selected and "✓" or ""
                    end
                end
            end
            if flag then iHook.Flags[flag] = value end
        end,
        OnChanged = function(self, callback) options.Callback = callback end,
        GetValue = function(self) return value end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = dropdownObj
    end
    
    table.insert(self.Elements, dropdownObj)
    return dropdownObj
end

-- ══════════════════════════════════════
-- TEXTBOX / INPUT
-- ══════════════════════════════════════
function Tab:AddInput(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or ""
    local placeholder = options.Placeholder or "Enter text..."
    local numeric = options.Numeric or false
    local finished = options.Finished or false
    local clearOnFocus = options.ClearOnFocus or false
    local maxLength = options.MaxLength or 100
    
    local container = Utility.Create("Frame", {
        Name = "Input",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 70 or 58),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 0, 18),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 6),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Input",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -20, 0, 14),
            Position = UDim2.new(0, 12, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    -- Input Box
    local inputFrame = Utility.Create("Frame", {
        Name = "InputFrame",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(1, -24, 0, 28),
        Position = UDim2.new(0, 12, 1, -36),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = inputFrame})
    
    local inputStroke = Utility.Create("UIStroke", {
        Parent = inputFrame,
        Color = theme.Border,
        Thickness = 1
    })
    
    -- TextBox
    local textBox = Utility.Create("TextBox", {
        Name = "TextBox",
        Parent = inputFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -20, 1, 0),
        Position = UDim2.new(0, 10, 0, 0),
        Font = Enum.Font.Gotham,
        Text = value,
        PlaceholderText = placeholder,
        PlaceholderColor3 = theme.TextDisabled,
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ClearTextOnFocus = clearOnFocus,
        ZIndex = 107
    })
    
    -- Clear button
    local clearBtn = Utility.Create("TextButton", {
        Name = "Clear",
        Parent = inputFrame,
        BackgroundColor3 = theme.Error,
        BackgroundTransparency = 0.8,
        Size = UDim2.new(0, 20, 0, 20),
        Position = UDim2.new(1, -24, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Font = Enum.Font.GothamBold,
        Text = "×",
        TextColor3 = theme.Error,
        TextSize = 14,
        Visible = value ~= "",
        AutoButtonColor = false,
        ZIndex = 108
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = clearBtn})
    
    -- Focus effects
    textBox.Focused:Connect(function()
        Utility.SmoothTween(inputStroke, {Color = theme.Accent}, 0.15)
        Utility.SmoothTween(inputFrame, {BackgroundColor3 = Utility.Lighten(theme.InputBg, 0.02)}, 0.15)
    end)
    
    textBox.FocusLost:Connect(function(enterPressed)
        Utility.SmoothTween(inputStroke, {Color = theme.Border}, 0.15)
        Utility.SmoothTween(inputFrame, {BackgroundColor3 = theme.InputBg}, 0.15)
        
        if finished and enterPressed then
            if options.Callback then
                Utility.SafeCall(options.Callback, value)
            end
        end
    end)
    
    -- Text changed
    textBox:GetPropertyChangedSignal("Text"):Connect(function()
        local newText = textBox.Text
        
        -- Max length
        if #newText > maxLength then
            newText = string.sub(newText, 1, maxLength)
            textBox.Text = newText
        end
        
        -- Numeric filter
        if numeric then
            newText = newText:gsub("[^%d%.%-]", "")
            if newText ~= textBox.Text then
                textBox.Text = newText
            end
        end
        
        value = newText
        clearBtn.Visible = value ~= ""
        
        if flag then
            iHook.Flags[flag] = value
        end
        
        if not finished and options.Callback then
            Utility.SafeCall(options.Callback, value)
        end
    end)
    
    -- Clear button
    clearBtn.MouseButton1Click:Connect(function()
        textBox.Text = ""
        value = ""
        clearBtn.Visible = false
        if flag then iHook.Flags[flag] = value end
        if options.Callback then Utility.SafeCall(options.Callback, value) end
    end)
    
    clearBtn.MouseEnter:Connect(function()
        Utility.SmoothTween(clearBtn, {BackgroundTransparency = 0.5}, 0.15)
    end)
    
    clearBtn.MouseLeave:Connect(function()
        Utility.SmoothTween(clearBtn, {BackgroundTransparency = 0.8}, 0.15)
    end)
    
    -- Hover
    container.MouseEnter:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    container.MouseLeave:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    
    local inputObj = {
        Type = "Input",
        Frame = container,
        Value = value,
        
        SetValue = function(self, newValue)
            value = tostring(newValue)
            textBox.Text = value
            self.Value = value
            clearBtn.Visible = value ~= ""
            if flag then iHook.Flags[flag] = value end
        end,
        
        OnChanged = function(self, callback)
            options.Callback = callback
        end,
        
        GetValue = function(self)
            return value
        end,
        
        Focus = function(self)
            textBox:CaptureFocus()
        end,
        
        Clear = function(self)
            textBox.Text = ""
            value = ""
            clearBtn.Visible = false
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = inputObj
    end
    
    table.insert(self.Elements, inputObj)
    return inputObj
end

function Section:AddInput(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or ""
    local placeholder = options.Placeholder or "Enter text..."
    local numeric = options.Numeric or false
    local finished = options.Finished or false
    local maxLength = options.MaxLength or 100
    
    local container = Utility.Create("Frame", {
        Name = "Input",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 65 or 52),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -16, 0, 16),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 5),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Input",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -16, 0, 12),
            Position = UDim2.new(0, 10, 0, 22),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    local inputFrame = Utility.Create("Frame", {
        Name = "InputFrame",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(1, -20, 0, 24),
        Position = UDim2.new(0, 10, 1, -30),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = inputFrame})
    local inputStroke = Utility.Create("UIStroke", {Parent = inputFrame, Color = theme.Border, Thickness = 1})
    
    local textBox = Utility.Create("TextBox", {
        Name = "TextBox",
        Parent = inputFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -16, 1, 0),
        Position = UDim2.new(0, 8, 0, 0),
        Font = Enum.Font.Gotham,
        Text = value,
        PlaceholderText = placeholder,
        PlaceholderColor3 = theme.TextDisabled,
        TextColor3 = theme.Text,
        TextSize = 11 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 107
    })
    
    textBox.Focused:Connect(function()
        Utility.SmoothTween(inputStroke, {Color = theme.Accent}, 0.15)
    end)
    
    textBox.FocusLost:Connect(function(enterPressed)
        Utility.SmoothTween(inputStroke, {Color = theme.Border}, 0.15)
        if finished and enterPressed and options.Callback then
            Utility.SafeCall(options.Callback, value)
        end
    end)
    
    textBox:GetPropertyChangedSignal("Text"):Connect(function()
        local newText = textBox.Text
        if #newText > maxLength then
            newText = string.sub(newText, 1, maxLength)
            textBox.Text = newText
        end
        if numeric then
            newText = newText:gsub("[^%d%.%-]", "")
            if newText ~= textBox.Text then textBox.Text = newText end
        end
        value = newText
        if flag then iHook.Flags[flag] = value end
        if not finished and options.Callback then Utility.SafeCall(options.Callback, value) end
    end)
    
    local inputObj = {
        Type = "Input",
        Frame = container,
        Value = value,
        SetValue = function(self, newValue)
            value = tostring(newValue)
            textBox.Text = value
            self.Value = value
            if flag then iHook.Flags[flag] = value end
        end,
        OnChanged = function(self, callback) options.Callback = callback end,
        GetValue = function(self) return value end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = inputObj
    end
    
    table.insert(self.Elements, inputObj)
    return inputObj
end

-- ══════════════════════════════════════
-- KEYBIND
-- ══════════════════════════════════════
function Tab:AddKeybind(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local default = options.Default or "None"
    local mode = options.Mode or "Toggle" -- Toggle, Hold, Always
    local value = default
    local holding = false
    local listening = false
    local toggled = false
    local connection = nil
    
    local container = Utility.Create("Frame", {
        Name = "Keybind",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 55 or 42),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -110, 0, 18),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 12),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Keybind",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -110, 0, 14),
            Position = UDim2.new(0, 12, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            TextTruncate = Enum.TextTruncate.AtEnd,
            ZIndex = 105
        })
    end
    
    -- Keybind Button
    local keybindBtn = Utility.Create("TextButton", {
        Name = "KeybindBtn",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(0, 90, 0, 26),
        Position = UDim2.new(1, -102, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Font = Enum.Font.GothamMedium,
        Text = value,
        TextColor3 = theme.TextDark,
        TextSize = 11 * scale,
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = keybindBtn})
    local keybindStroke = Utility.Create("UIStroke", {Parent = keybindBtn, Color = theme.Border, Thickness = 1})
    
    -- Helper functions
    local function getKeyName(key)
        local name = tostring(key):gsub("Enum.KeyCode.", ""):gsub("Enum.UserInputType.", "")
        local keyNames = {
            MouseButton1 = "MB1",
            MouseButton2 = "MB2",
            MouseButton3 = "MB3",
            LeftShift = "LShift",
            RightShift = "RShift",
            LeftControl = "LCtrl",
            RightControl = "RCtrl",
            LeftAlt = "LAlt",
            RightAlt = "RAlt",
            BackSpace = "Backspace",
            Return = "Enter",
            Escape = "Esc"
        }
        return keyNames[name] or name
    end
    
    local function isValidKey(key)
        local blacklist = {
            Enum.KeyCode.Unknown,
            Enum.KeyCode.W,
            Enum.KeyCode.A,
            Enum.KeyCode.S,
            Enum.KeyCode.D,
            Enum.KeyCode.Space,
            Enum.KeyCode.Tab,
            Enum.UserInputType.MouseMovement,
            Enum.UserInputType.Focus
        }
        for _, v in pairs(blacklist) do
            if key == v then return false end
        end
        return true
    end
    
    local function startListening()
        listening = true
        keybindBtn.Text = "..."
        Utility.SmoothTween(keybindStroke, {Color = theme.Accent}, 0.15)
        Utility.SmoothTween(keybindBtn, {BackgroundColor3 = theme.Hover}, 0.15)
        
        connection = UserInputService.InputBegan:Connect(function(input, processed)
            if processed then return end
            
            local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
            
            if key == Enum.KeyCode.Escape then
                -- Cancel
                value = "None"
                keybindBtn.Text = value
            elseif isValidKey(key) then
                value = getKeyName(key)
                keybindBtn.Text = value
                
                if options.ChangedCallback then
                    Utility.SafeCall(options.ChangedCallback, key)
                end
            end
            
            listening = false
            Utility.SmoothTween(keybindStroke, {Color = theme.Border}, 0.15)
            Utility.SmoothTween(keybindBtn, {BackgroundColor3 = theme.InputBg}, 0.15)
            
            if connection then
                connection:Disconnect()
                connection = nil
            end
            
            if flag then
                iHook.Flags[flag] = value
            end
        end)
    end
    
    keybindBtn.MouseButton1Click:Connect(function()
        if IsMobile then Utility.Haptic(0.1) end
        if not listening then
            startListening()
        end
    end)
    
    keybindBtn.MouseEnter:Connect(function()
        if not listening then
            Utility.SmoothTween(keybindBtn, {BackgroundColor3 = theme.Hover}, 0.15)
        end
    end)
    
    keybindBtn.MouseLeave:Connect(function()
        if not listening then
            Utility.SmoothTween(keybindBtn, {BackgroundColor3 = theme.InputBg}, 0.15)
        end
    end)
    
    -- Keybind input handler
    local inputBeganConn = UserInputService.InputBegan:Connect(function(input, processed)
        if processed or listening then return end
        
        local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
        local keyName = getKeyName(key)
        
        if keyName == value and value ~= "None" then
            if mode == "Toggle" then
                toggled = not toggled
                if options.Callback then
                    Utility.SafeCall(options.Callback, toggled)
                end
            elseif mode == "Hold" then
                holding = true
                if options.Callback then
                    Utility.SafeCall(options.Callback, true)
                end
            elseif mode == "Always" then
                if options.Callback then
                    Utility.SafeCall(options.Callback, true)
                end
            end
        end
    end)
    
    local inputEndedConn = UserInputService.InputEnded:Connect(function(input)
        if listening then return end
        
        local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
        local keyName = getKeyName(key)
        
        if keyName == value and value ~= "None" then
            if mode == "Hold" and holding then
                holding = false
                if options.Callback then
                    Utility.SafeCall(options.Callback, false)
                end
            end
        end
    end)
    
    -- Store connections for cleanup
    table.insert(iHook.Connections, inputBeganConn)
    table.insert(iHook.Connections, inputEndedConn)
    
    -- Hover effect on container
    container.MouseEnter:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    container.MouseLeave:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    
    local keybindObj = {
        Type = "Keybind",
        Frame = container,
        Value = value,
        
        SetValue = function(self, newKey, newMode)
            value = newKey or value
            mode = newMode or mode
            keybindBtn.Text = value
            self.Value = value
            if flag then iHook.Flags[flag] = value end
        end,
        
        OnChanged = function(self, callback)
            options.ChangedCallback = callback
        end,
        
        OnClick = function(self, callback)
            options.Callback = callback
        end,
        
        GetState = function(self)
            if mode == "Toggle" then
                return toggled
            elseif mode == "Hold" then
                return holding
            end
            return false
        end,
        
        GetValue = function(self)
            return value
        end,
        
        GetMode = function(self)
            return mode
        end,
        
        SetMode = function(self, newMode)
            mode = newMode
        end,
        
        Destroy = function(self)
            if inputBeganConn then inputBeganConn:Disconnect() end
            if inputEndedConn then inputEndedConn:Disconnect() end
            container:Destroy()
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = keybindObj
    end
    
    table.insert(self.Elements, keybindObj)
    return keybindObj
end

function Section:AddKeybind(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local default = options.Default or "None"
    local mode = options.Mode or "Toggle"
    local value = default
    local holding = false
    local listening = false
    local toggled = false
    local connection = nil
    
    local container = Utility.Create("Frame", {
        Name = "Keybind",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 52 or 40),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -90, 0, 16),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 12),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Keybind",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -90, 0, 12),
            Position = UDim2.new(0, 10, 0, 24),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    local keybindBtn = Utility.Create("TextButton", {
        Name = "KeybindBtn",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(0, 70, 0, 22),
        Position = UDim2.new(1, -80, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Font = Enum.Font.GothamMedium,
        Text = value,
        TextColor3 = theme.TextDark,
        TextSize = 10 * scale,
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = keybindBtn})
    local keybindStroke = Utility.Create("UIStroke", {Parent = keybindBtn, Color = theme.Border, Thickness = 1})
    
    local function getKeyName(key)
        local name = tostring(key):gsub("Enum.KeyCode.", ""):gsub("Enum.UserInputType.", "")
        local keyNames = {MouseButton1 = "MB1", MouseButton2 = "MB2", LeftShift = "LShift", RightShift = "RShift", LeftControl = "LCtrl", RightControl = "RCtrl", BackSpace = "Back", Return = "Enter"}
        return keyNames[name] or name
    end
    
    local function isValidKey(key)
        local blacklist = {Enum.KeyCode.Unknown, Enum.KeyCode.W, Enum.KeyCode.A, Enum.KeyCode.S, Enum.KeyCode.D, Enum.KeyCode.Space}
        for _, v in pairs(blacklist) do if key == v then return false end end
        return true
    end
    
    local function startListening()
        listening = true
        keybindBtn.Text = "..."
        Utility.SmoothTween(keybindStroke, {Color = theme.Accent}, 0.15)
        
        connection = UserInputService.InputBegan:Connect(function(input, processed)
            if processed then return end
            local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
            if key == Enum.KeyCode.Escape then
                value = "None"
            elseif isValidKey(key) then
                value = getKeyName(key)
                if options.ChangedCallback then Utility.SafeCall(options.ChangedCallback, key) end
            end
            keybindBtn.Text = value
            listening = false
            Utility.SmoothTween(keybindStroke, {Color = theme.Border}, 0.15)
            if connection then connection:Disconnect() connection = nil end
            if flag then iHook.Flags[flag] = value end
        end)
    end
    
    keybindBtn.MouseButton1Click:Connect(function()
        if IsMobile then Utility.Haptic(0.1) end
        if not listening then startListening() end
    end)
    
    local inputBeganConn = UserInputService.InputBegan:Connect(function(input, processed)
        if processed or listening then return end
        local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
        if getKeyName(key) == value and value ~= "None" then
            if mode == "Toggle" then
                toggled = not toggled
                if options.Callback then Utility.SafeCall(options.Callback, toggled) end
            elseif mode == "Hold" then
                holding = true
                if options.Callback then Utility.SafeCall(options.Callback, true) end
            elseif mode == "Always" then
                if options.Callback then Utility.SafeCall(options.Callback, true) end
            end
        end
    end)
    
    local inputEndedConn = UserInputService.InputEnded:Connect(function(input)
        if listening then return end
        local key = input.KeyCode ~= Enum.KeyCode.Unknown and input.KeyCode or input.UserInputType
        if getKeyName(key) == value and value ~= "None" and mode == "Hold" and holding then
            holding = false
            if options.Callback then Utility.SafeCall(options.Callback, false) end
        end
    end)
    
    table.insert(iHook.Connections, inputBeganConn)
    table.insert(iHook.Connections, inputEndedConn)
    
    local keybindObj = {
        Type = "Keybind",
        Frame = container,
        Value = value,
        SetValue = function(self, newKey, newMode) value = newKey or value; mode = newMode or mode; keybindBtn.Text = value; if flag then iHook.Flags[flag] = value end end,
        OnChanged = function(self, callback) options.ChangedCallback = callback end,
        OnClick = function(self, callback) options.Callback = callback end,
        GetState = function(self) return mode == "Toggle" and toggled or holding end,
        GetValue = function(self) return value end
    }
    
    if flag then iHook.Flags[flag] = value; iHook.Options[flag] = keybindObj end
    table.insert(self.Elements, keybindObj)
    return keybindObj
end

-- ══════════════════════════════════════
-- COLORPICKER
-- ══════════════════════════════════════
function Tab:AddColorpicker(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local default = options.Default or Color3.fromRGB(255, 255, 255)
    local transparency = options.Transparency
    local value = default
    local trans = transparency or 0
    local isOpen = false
    
    local h, s, v = Utility.RGBToHSV(value)
    
    local container = Utility.Create("Frame", {
        Name = "Colorpicker",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, options.Description and 55 or 42),
        ClipsDescendants = false,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -60, 0, 18),
        Position = UDim2.new(0, 12, 0, options.Description and 8 or 12),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Colorpicker",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Description
    if options.Description then
        Utility.Create("TextLabel", {
            Name = "Description",
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -60, 0, 14),
            Position = UDim2.new(0, 12, 0, 26),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 11 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    -- Color Preview Button
    local colorBtn = Utility.Create("TextButton", {
        Name = "ColorBtn",
        Parent = container,
        BackgroundColor3 = value,
        Size = UDim2.new(0, 36, 0, 26),
        Position = UDim2.new(1, -48, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Text = "",
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = colorBtn})
    Utility.Create("UIStroke", {Parent = colorBtn, Color = theme.Border, Thickness = 1})
    
    -- Checkerboard pattern for transparency
    local checkerboard = Utility.Create("ImageLabel", {
        Name = "Checkerboard",
        Parent = colorBtn,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Image = "rbxassetid://4865940943",
        ImageTransparency = transparency and trans or 1,
        ScaleType = Enum.ScaleType.Tile,
        TileSize = UDim2.new(0, 8, 0, 8),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = checkerboard})
    
    -- Picker Container
    local pickerContainer = Utility.Create("Frame", {
        Name = "Picker",
        Parent = container,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(0, 220, 0, 0),
        Position = UDim2.new(1, -48, 1, 8),
        AnchorPoint = Vector2.new(1, 0),
        ClipsDescendants = true,
        Visible = false,
        ZIndex = 300
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 10), Parent = pickerContainer})
    Utility.Create("UIStroke", {Parent = pickerContainer, Color = theme.Border, Thickness = 1})
    
    -- Saturation/Value Box
    local satValBox = Utility.Create("ImageButton", {
        Name = "SatValBox",
        Parent = pickerContainer,
        BackgroundColor3 = Color3.fromHSV(h, 1, 1),
        Size = UDim2.new(1, -20, 0, 120),
        Position = UDim2.new(0, 10, 0, 10),
        AutoButtonColor = false,
        ZIndex = 301
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = satValBox})
    
    -- Saturation gradient (left to right: white to color)
    Utility.Create("UIGradient", {
        Parent = satValBox,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.new(1, 1, 1)),
            ColorSequenceKeypoint.new(1, Color3.new(1, 1, 1))
        }),
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 0),
            NumberSequenceKeypoint.new(1, 1)
        })
    })
    
    -- Value overlay (top to bottom: transparent to black)
    local valueOverlay = Utility.Create("Frame", {
        Name = "ValueOverlay",
        Parent = satValBox,
        BackgroundColor3 = Color3.new(0, 0, 0),
        BackgroundTransparency = 0,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 302
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = valueOverlay})
    Utility.Create("UIGradient", {
        Parent = valueOverlay,
        Color = ColorSequence.new(Color3.new(0, 0, 0)),
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 1),
            NumberSequenceKeypoint.new(1, 0)
        }),
        Rotation = 90
    })
    
    -- SatVal cursor
    local satValCursor = Utility.Create("Frame", {
        Name = "Cursor",
        Parent = satValBox,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 14, 0, 14),
        Position = UDim2.new(s, 0, 1 - v, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 303
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = satValCursor})
    Utility.Create("UIStroke", {Parent = satValCursor, Color = Color3.new(0, 0, 0), Thickness = 2})
    
    -- Hue Slider
    local hueSlider = Utility.Create("ImageButton", {
        Name = "HueSlider",
        Parent = pickerContainer,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(1, -20, 0, 16),
        Position = UDim2.new(0, 10, 0, 140),
        AutoButtonColor = false,
        ZIndex = 301
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = hueSlider})
    
    Utility.Create("UIGradient", {
        Parent = hueSlider,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromHSV(0, 1, 1)),
            ColorSequenceKeypoint.new(0.167, Color3.fromHSV(0.167, 1, 1)),
            ColorSequenceKeypoint.new(0.333, Color3.fromHSV(0.333, 1, 1)),
            ColorSequenceKeypoint.new(0.5, Color3.fromHSV(0.5, 1, 1)),
            ColorSequenceKeypoint.new(0.667, Color3.fromHSV(0.667, 1, 1)),
            ColorSequenceKeypoint.new(0.833, Color3.fromHSV(0.833, 1, 1)),
            ColorSequenceKeypoint.new(1, Color3.fromHSV(1, 1, 1))
        })
    })
    
    -- Hue cursor
    local hueCursor = Utility.Create("Frame", {
        Name = "Cursor",
        Parent = hueSlider,
        BackgroundColor3 = Color3.new(1, 1, 1),
        Size = UDim2.new(0, 6, 1, 4),
        Position = UDim2.new(h, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 302
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = hueCursor})
    Utility.Create("UIStroke", {Parent = hueCursor, Color = Color3.new(0, 0, 0), Thickness = 1})
    
    -- Transparency Slider (if enabled)
    local transSlider, transCursor
    local pickerHeight = 170
    
    if transparency then
        pickerHeight = 200
        
        transSlider = Utility.Create("ImageButton", {
            Name = "TransSlider",
            Parent = pickerContainer,
            BackgroundColor3 = Color3.new(1, 1, 1),
            Size = UDim2.new(1, -20, 0, 16),
            Position = UDim2.new(0, 10, 0, 166),
            AutoButtonColor = false,
            ZIndex = 301
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = transSlider})
        
        -- Checkerboard background
        Utility.Create("ImageLabel", {
            Name = "Checkerboard",
            Parent = transSlider,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, 0, 1, 0),
            Image = "rbxassetid://4865940943",
            ScaleType = Enum.ScaleType.Tile,
            TileSize = UDim2.new(0, 8, 0, 8),
            ZIndex = 300
        })
        
        -- Transparency gradient
        local transGradient = Utility.Create("Frame", {
            Name = "Gradient",
            Parent = transSlider,
            BackgroundColor3 = value,
            Size = UDim2.new(1, 0, 1, 0),
            ZIndex = 301
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = transGradient})
        Utility.Create("UIGradient", {
            Parent = transGradient,
            Transparency = NumberSequence.new({
                NumberSequenceKeypoint.new(0, 0),
                NumberSequenceKeypoint.new(1, 1)
            })
        })
        
        transCursor = Utility.Create("Frame", {
            Name = "Cursor",
            Parent = transSlider,
            BackgroundColor3 = Color3.new(1, 1, 1),
            Size = UDim2.new(0, 6, 1, 4),
            Position = UDim2.new(1 - trans, 0, 0.5, 0),
            AnchorPoint = Vector2.new(0.5, 0.5),
            ZIndex = 302
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = transCursor})
        Utility.Create("UIStroke", {Parent = transCursor, Color = Color3.new(0, 0, 0), Thickness = 1})
    end
    
    -- Update function
    local function updateColor()
        value = Color3.fromHSV(h, s, v)
        colorBtn.BackgroundColor3 = value
        satValBox.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
        
        if transparency then
            checkerboard.ImageTransparency = 1 - trans
            colorBtn.BackgroundTransparency = trans
        end
        
        if options.Callback then
            if transparency then
                Utility.SafeCall(options.Callback, value, trans)
            else
                Utility.SafeCall(options.Callback, value)
            end
        end
        
        if flag then
            iHook.Flags[flag] = value
            if transparency then
                iHook.Flags[flag .. "_Transparency"] = trans
            end
        end
    end
    
    -- SatVal dragging
    local satValDragging = false
    
    satValBox.MouseButton1Down:Connect(function()
        satValDragging = true
        if IsMobile then Utility.Haptic(0.05) end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            satValDragging = false
        end
    end)
    
    local function updateSatVal(input)
        local pos = satValBox.AbsolutePosition
        local size = satValBox.AbsoluteSize
        
        s = math.clamp((input.Position.X - pos.X) / size.X, 0, 1)
        v = 1 - math.clamp((input.Position.Y - pos.Y) / size.Y, 0, 1)
        
        satValCursor.Position = UDim2.new(s, 0, 1 - v, 0)
        updateColor()
    end
    
    satValBox.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            updateSatVal(input)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if satValDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateSatVal(input)
        end
    end)
    
    -- Hue dragging
    local hueDragging = false
    
    hueSlider.MouseButton1Down:Connect(function()
        hueDragging = true
        if IsMobile then Utility.Haptic(0.05) end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            hueDragging = false
        end
    end)
    
    local function updateHue(input)
        local pos = hueSlider.AbsolutePosition
        local size = hueSlider.AbsoluteSize
        
        h = math.clamp((input.Position.X - pos.X) / size.X, 0, 1)
        hueCursor.Position = UDim2.new(h, 0, 0.5, 0)
        updateColor()
    end
    
    hueSlider.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            updateHue(input)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if hueDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            updateHue(input)
        end
    end)
    
    -- Transparency dragging
    if transparency then
        local transDragging = false
        
        transSlider.MouseButton1Down:Connect(function()
            transDragging = true
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                transDragging = false
            end
        end)
        
        local function updateTrans(input)
            local pos = transSlider.AbsolutePosition
            local size = transSlider.AbsoluteSize
            
            trans = 1 - math.clamp((input.Position.X - pos.X) / size.X, 0, 1)
            transCursor.Position = UDim2.new(1 - trans, 0, 0.5, 0)
            updateColor()
        end
        
        transSlider.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                updateTrans(input)
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if transDragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
                updateTrans(input)
            end
        end)
    end
    
    -- Toggle picker
    local function togglePicker()
        isOpen = not isOpen
        
        if isOpen then
            pickerContainer.Visible = true
            Utility.SmoothTween(pickerContainer, {Size = UDim2.new(0, 220, 0, pickerHeight)}, 0.25)
        else
            Utility.SmoothTween(pickerContainer, {Size = UDim2.new(0, 220, 0, 0)}, 0.2)
            task.delay(0.2, function()
                if not isOpen then
                    pickerContainer.Visible = false
                end
            end)
        end
    end
    
    colorBtn.MouseButton1Click:Connect(function()
        Utility.Ripple(colorBtn)
        togglePicker()
    end)
    
    -- Hover
    container.MouseEnter:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Hover}, 0.15)
    end)
    
    container.MouseLeave:Connect(function()
        Utility.SmoothTween(container, {BackgroundColor3 = theme.Tertiary}, 0.15)
    end)
    
    local colorpickerObj = {
        Type = "Colorpicker",
        Frame = container,
        Value = value,
        Transparency = trans,
        
        SetValue = function(self, newColor)
            value = newColor
            h, s, v = Utility.RGBToHSV(value)
            colorBtn.BackgroundColor3 = value
            satValBox.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
            satValCursor.Position = UDim2.new(s, 0, 1 - v, 0)
            hueCursor.Position = UDim2.new(h, 0, 0.5, 0)
            self.Value = value
            if flag then iHook.Flags[flag] = value end
        end,
        
        SetValueRGB = function(self, newColor)
            self:SetValue(newColor)
        end,
        
        OnChanged = function(self, callback)
            options.Callback = callback
        end,
        
        GetValue = function(self)
            return value
        end,
        
        GetTransparency = function(self)
            return trans
        end
    }
    
    if flag then
        iHook.Flags[flag] = value
        iHook.Options[flag] = colorpickerObj
    end
    
    table.insert(self.Elements, colorpickerObj)
    return colorpickerObj
end

function Section:AddColorpicker(flag, options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local default = options.Default or Color3.fromRGB(255, 255, 255)
    local transparency = options.Transparency
    local value = default
    local trans = transparency or 0
    local isOpen = false
    local h, s, v = Utility.RGBToHSV(value)
    
    local container = Utility.Create("Frame", {
        Name = "Colorpicker",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, options.Description and 50 or 40),
        ClipsDescendants = false,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -50, 0, 16),
        Position = UDim2.new(0, 10, 0, options.Description and 6 or 12),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Colorpicker",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    if options.Description then
        Utility.Create("TextLabel", {
            Parent = container,
            BackgroundTransparency = 1,
            Size = UDim2.new(1, -50, 0, 12),
            Position = UDim2.new(0, 10, 0, 24),
            Font = Enum.Font.Gotham,
            Text = options.Description,
            TextColor3 = theme.TextDarker,
            TextSize = 10 * scale,
            TextXAlignment = Enum.TextXAlignment.Left,
            ZIndex = 105
        })
    end
    
    local colorBtn = Utility.Create("TextButton", {
        Name = "ColorBtn",
        Parent = container,
        BackgroundColor3 = value,
        Size = UDim2.new(0, 30, 0, 22),
        Position = UDim2.new(1, -40, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Text = "",
        AutoButtonColor = false,
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = colorBtn})
    Utility.Create("UIStroke", {Parent = colorBtn, Color = theme.Border, Thickness = 1})
    
    local pickerContainer = Utility.Create("Frame", {
        Name = "Picker",
        Parent = container,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(0, 180, 0, 0),
        Position = UDim2.new(1, -40, 1, 8),
        AnchorPoint = Vector2.new(1, 0),
        ClipsDescendants = true,
        Visible = false,
        ZIndex = 300
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = pickerContainer})
    Utility.Create("UIStroke", {Parent = pickerContainer, Color = theme.Border, Thickness = 1})
    
    local satValBox = Utility.Create("ImageButton", {
        Name = "SatValBox",
        Parent = pickerContainer,
        BackgroundColor3 = Color3.fromHSV(h, 1, 1),
        Size = UDim2.new(1, -16, 0, 100),
        Position = UDim2.new(0, 8, 0, 8),
        AutoButtonColor = false,
        ZIndex = 301
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = satValBox})
    Utility.Create("UIGradient", {Parent = satValBox, Color = ColorSequence.new(Color3.new(1,1,1)), Transparency = NumberSequence.new({NumberSequenceKeypoint.new(0, 0), NumberSequenceKeypoint.new(1, 1)})})
    
    local valueOverlay = Utility.Create("Frame", {Parent = satValBox, BackgroundColor3 = Color3.new(0,0,0), Size = UDim2.new(1,0,1,0), ZIndex = 302})
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = valueOverlay})
    Utility.Create("UIGradient", {Parent = valueOverlay, Color = ColorSequence.new(Color3.new(0,0,0)), Transparency = NumberSequence.new({NumberSequenceKeypoint.new(0, 1), NumberSequenceKeypoint.new(1, 0)}), Rotation = 90})
    
    local satValCursor = Utility.Create("Frame", {Parent = satValBox, BackgroundColor3 = Color3.new(1,1,1), Size = UDim2.new(0,12,0,12), Position = UDim2.new(s, 0, 1-v, 0), AnchorPoint = Vector2.new(0.5, 0.5), ZIndex = 303})
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = satValCursor})
    Utility.Create("UIStroke", {Parent = satValCursor, Color = Color3.new(0,0,0), Thickness = 2})
    
    local hueSlider = Utility.Create("ImageButton", {Parent = pickerContainer, BackgroundColor3 = Color3.new(1,1,1), Size = UDim2.new(1, -16, 0, 14), Position = UDim2.new(0, 8, 0, 116), AutoButtonColor = false, ZIndex = 301})
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = hueSlider})
    Utility.Create("UIGradient", {Parent = hueSlider, Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromHSV(0,1,1)), ColorSequenceKeypoint.new(0.167, Color3.fromHSV(0.167,1,1)),
        ColorSequenceKeypoint.new(0.333, Color3.fromHSV(0.333,1,1)), ColorSequenceKeypoint.new(0.5, Color3.fromHSV(0.5,1,1)),
        ColorSequenceKeypoint.new(0.667, Color3.fromHSV(0.667,1,1)), ColorSequenceKeypoint.new(0.833, Color3.fromHSV(0.833,1,1)),
        ColorSequenceKeypoint.new(1, Color3.fromHSV(1,1,1))
    })})
    
    local hueCursor = Utility.Create("Frame", {Parent = hueSlider, BackgroundColor3 = Color3.new(1,1,1), Size = UDim2.new(0, 5, 1, 2), Position = UDim2.new(h, 0, 0.5, 0), AnchorPoint = Vector2.new(0.5, 0.5), ZIndex = 302})
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = hueCursor})
    
    local pickerHeight = 140
    
    local function updateColor()
        value = Color3.fromHSV(h, s, v)
        colorBtn.BackgroundColor3 = value
        satValBox.BackgroundColor3 = Color3.fromHSV(h, 1, 1)
        if options.Callback then Utility.SafeCall(options.Callback, value) end
        if flag then iHook.Flags[flag] = value end
    end
    
    local satValDragging, hueDragging = false, false
    
    satValBox.MouseButton1Down:Connect(function() satValDragging = true end)
    hueSlider.MouseButton1Down:Connect(function() hueDragging = true end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            satValDragging = false
            hueDragging = false
        end
    end)
    
    local function updateSatVal(input)
        local pos, size = satValBox.AbsolutePosition, satValBox.AbsoluteSize
        s = math.clamp((input.Position.X - pos.X) / size.X, 0, 1)
        v = 1 - math.clamp((input.Position.Y - pos.Y) / size.Y, 0, 1)
        satValCursor.Position = UDim2.new(s, 0, 1 - v, 0)
        updateColor()
    end
    
    local function updateHue(input)
        local pos, size = hueSlider.AbsolutePosition, hueSlider.AbsoluteSize
        h = math.clamp((input.Position.X - pos.X) / size.X, 0, 1)
        hueCursor.Position = UDim2.new(h, 0, 0.5, 0)
        updateColor()
    end
    
    satValBox.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then updateSatVal(input) end end)
    hueSlider.InputBegan:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then updateHue(input) end end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            if satValDragging then updateSatVal(input) end
            if hueDragging then updateHue(input) end
        end
    end)
    
    local function togglePicker()
        isOpen = not isOpen
        if isOpen then
            pickerContainer.Visible = true
            Utility.SmoothTween(pickerContainer, {Size = UDim2.new(0, 180, 0, pickerHeight)}, 0.25)
        else
            Utility.SmoothTween(pickerContainer, {Size = UDim2.new(0, 180, 0, 0)}, 0.2)
            task.delay(0.2, function() if not isOpen then pickerContainer.Visible = false end end)
        end
    end
    
    colorBtn.MouseButton1Click:Connect(function() togglePicker() end)
    
    local colorpickerObj = {
        Type = "Colorpicker",
        Frame = container,
        Value = value,
        SetValue = function(self, newColor) value = newColor; h,s,v = Utility.RGBToHSV(value); colorBtn.BackgroundColor3 = value; satValBox.BackgroundColor3 = Color3.fromHSV(h,1,1); satValCursor.Position = UDim2.new(s,0,1-v,0); hueCursor.Position = UDim2.new(h,0,0.5,0); if flag then iHook.Flags[flag] = value end end,
        SetValueRGB = function(self, newColor) self:SetValue(newColor) end,
        OnChanged = function(self, callback) options.Callback = callback end,
        GetValue = function(self) return value end
    }
    
    if flag then iHook.Flags[flag] = value; iHook.Options[flag] = colorpickerObj end
    table.insert(self.Elements, colorpickerObj)
    return colorpickerObj
end

-- ══════════════════════════════════════
-- LABEL
-- ══════════════════════════════════════
function Tab:AddLabel(text)
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local label = Utility.Create("TextLabel", {
        Name = "Label",
        Parent = self.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Font = Enum.Font.Gotham,
        Text = text or "Label",
        TextColor3 = theme.TextDark,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UIPadding", {
        Parent = label,
        PaddingTop = UDim.new(0, 4),
        PaddingBottom = UDim.new(0, 4),
        PaddingLeft = UDim.new(0, 6),
        PaddingRight = UDim.new(0, 6)
    })
    
    table.insert(self.Elements, {Type = "Label", Frame = label})
    
    return {
        SetText = function(_, newText)
            label.Text = newText
        end,
        GetText = function(_)
            return label.Text
        end,
        Destroy = function(_)
            label:Destroy()
        end
    }
end

function Section:AddLabel(text)
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local label = Utility.Create("TextLabel", {
        Name = "Label",
        Parent = self.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Font = Enum.Font.Gotham,
        Text = text or "Label",
        TextColor3 = theme.TextDark,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UIPadding", {Parent = label, PaddingTop = UDim.new(0, 2), PaddingBottom = UDim.new(0, 2)})
    
    table.insert(self.Elements, {Type = "Label", Frame = label})
    
    return {
        SetText = function(_, newText) label.Text = newText end,
        GetText = function(_) return label.Text end
    }
end

-- ══════════════════════════════════════
-- DIVIDER / SEPARATOR
-- ══════════════════════════════════════
function Tab:AddDivider()
    local theme = iHook.Theme
    
    local divider = Utility.Create("Frame", {
        Name = "Divider",
        Parent = self.Content,
        BackgroundColor3 = theme.Divider,
        Size = UDim2.new(1, -20, 0, 1),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    table.insert(self.Elements, {Type = "Divider", Frame = divider})
    
    return {
        Destroy = function(_)
            divider:Destroy()
        end
    }
end

function Section:AddDivider()
    local theme = iHook.Theme
    
    local divider = Utility.Create("Frame", {
        Name = "Divider",
        Parent = self.Content,
        BackgroundColor3 = theme.Divider,
        Size = UDim2.new(1, -10, 0, 1),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    table.insert(self.Elements, {Type = "Divider", Frame = divider})
    
    return {Destroy = function(_) divider:Destroy() end}
end

-- ══════════════════════════════════════
-- DIALOG / MODAL
-- ══════════════════════════════════════
function Window:Dialog(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local title = options.Title or "Dialog"
    local content = options.Content or ""
    local buttons = options.Buttons or {{Title = "OK"}}
    
    -- Overlay
    local overlay = Utility.Create("Frame", {
        Name = "DialogOverlay",
        Parent = iHook.ScreenGui,
        BackgroundColor3 = Color3.new(0, 0, 0),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 500
    })
    
    -- Dialog Container
    local dialogContainer = Utility.Create("Frame", {
        Name = "Dialog",
        Parent = overlay,
        BackgroundColor3 = theme.Primary,
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ClipsDescendants = true,
        ZIndex = 501
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 12), Parent = dialogContainer})
    Utility.Create("UIStroke", {Parent = dialogContainer, Color = theme.Border, Thickness = 1})
    
    -- Shadow
    local shadowHolder = Utility.Create("Frame", {
        Name = "Shadow",
        Parent = dialogContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 50, 1, 50),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 500
    })
    
    Utility.Create("ImageLabel", {
        Parent = shadowHolder,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        Image = "rbxassetid://6014261993",
        ImageColor3 = Color3.new(0, 0, 0),
        ImageTransparency = 0.4,
        ScaleType = Enum.ScaleType.Slice,
        SliceCenter = Rect.new(49, 49, 450, 450),
        ZIndex = 500
    })
    
    -- Content
    local contentContainer = Utility.Create("Frame", {
        Name = "Content",
        Parent = dialogContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -40, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Position = UDim2.new(0, 20, 0, 20),
        ZIndex = 502
    })
    
    Utility.Create("UIListLayout", {
        Parent = contentContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 12)
    })
    
    -- Title
    local titleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        Parent = contentContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Font = Enum.Font.GothamBold,
        Text = title,
        TextColor3 = theme.Text,
        TextSize = 16 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        LayoutOrder = 1,
        ZIndex = 503
    })
    
    -- Content Text
    local contentLabel = Utility.Create("TextLabel", {
        Name = "ContentText",
        Parent = contentContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        Font = Enum.Font.Gotham,
        Text = content,
        TextColor3 = theme.TextDark,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        LayoutOrder = 2,
        ZIndex = 503
    })
    
    -- Buttons Container
    local buttonContainer = Utility.Create("Frame", {
        Name = "Buttons",
        Parent = contentContainer,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 36),
        LayoutOrder = 3,
        ZIndex = 502
    })
    
    Utility.Create("UIListLayout", {
        Parent = buttonContainer,
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Right,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Padding = UDim.new(0, 8),
        SortOrder = Enum.SortOrder.LayoutOrder
    })
    
    -- Close function
    local function closeDialog()
        Utility.SmoothTween(overlay, {BackgroundTransparency = 1}, 0.2)
        Utility.SmoothTween(dialogContainer, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1
        }, 0.25)
        
        task.delay(0.25, function()
            overlay:Destroy()
        end)
    end
    
    -- Create buttons
    for i, btn in ipairs(buttons) do
        local btnTitle = btn.Title or "Button"
        local btnCallback = btn.Callback
        local isPrimary = i == 1
        
        local button = Utility.Create("TextButton", {
            Name = "DialogButton",
            Parent = buttonContainer,
            BackgroundColor3 = isPrimary and theme.Accent or theme.Tertiary,
            Size = UDim2.new(0, 80, 0, 32),
            Font = Enum.Font.GothamBold,
            Text = btnTitle,
            TextColor3 = isPrimary and Color3.new(1, 1, 1) or theme.Text,
            TextSize = 13 * scale,
            AutoButtonColor = false,
            LayoutOrder = i,
            ZIndex = 503
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})
        
        -- Hover
        button.MouseEnter:Connect(function()
            Utility.SmoothTween(button, {
                BackgroundColor3 = isPrimary and theme.AccentHover or theme.Hover
            }, 0.15)
        end)
        
        button.MouseLeave:Connect(function()
            Utility.SmoothTween(button, {
                BackgroundColor3 = isPrimary and theme.Accent or theme.Tertiary
            }, 0.15)
        end)
        
        -- Click
        button.MouseButton1Click:Connect(function()
            Utility.Ripple(button)
            if IsMobile then Utility.Haptic(0.15) end
            
            if btnCallback then
                Utility.SafeCall(btnCallback)
            end
            
            closeDialog()
        end)
    end
    
    -- Calculate size
    task.defer(function()
        task.wait()
        local contentHeight = contentContainer.AbsoluteSize.Y
        local dialogWidth = IsMobile and 300 or 400
        local dialogHeight = contentHeight + 40
        
        -- Animate in
        Utility.SmoothTween(overlay, {BackgroundTransparency = 0.5}, 0.2)
        Utility.BounceTween(dialogContainer, {
            Size = UDim2.new(0, dialogWidth * scale, 0, dialogHeight)
        }, 0.35)
    end)
    
    return {
        Close = closeDialog,
        Destroy = function()
            overlay:Destroy()
        end
    }
end

-- ══════════════════════════════════════
-- ICON BUTTON
-- ══════════════════════════════════════
function Tab:AddIconButton(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "IconButton",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, 48),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    local button = Utility.Create("TextButton", {
        Name = "Btn",
        Parent = container,
        BackgroundColor3 = theme.Accent,
        BackgroundTransparency = 0.1,
        Size = UDim2.new(1, -20, 0, 34),
        Position = UDim2.new(0, 10, 0, 7),
        Text = "",
        AutoButtonColor = false,
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})
    
    -- Icon
    if options.Icon then
        local icon = Utility.Create("ImageLabel", {
            Name = "Icon",
            Parent = button,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 20, 0, 20),
            Position = UDim2.new(0, 12, 0.5, 0),
            AnchorPoint = Vector2.new(0, 0.5),
            Image = "rbxassetid://" .. options.Icon,
            ImageColor3 = theme.Text,
            ZIndex = 106
        })
    end
    
    -- Title
    local titleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        Parent = button,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, options.Icon and -50 or -24, 1, 0),
        Position = UDim2.new(0, options.Icon and 40 or 12, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = options.Title or "Icon Button",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        ZIndex = 106
    })
    
    -- Arrow
    if options.Arrow ~= false then
        Utility.Create("TextLabel", {
            Name = "Arrow",
            Parent = button,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 20, 1, 0),
            Position = UDim2.new(1, -24, 0, 0),
            Font = Enum.Font.GothamBold,
            Text = "›",
            TextColor3 = theme.TextDark,
            TextSize = 18,
            ZIndex = 106
        })
    end
    
    button.MouseEnter:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.Accent, BackgroundTransparency = 0}, 0.15)
    end)
    
    button.MouseLeave:Connect(function()
        Utility.SmoothTween(button, {BackgroundColor3 = theme.Accent, BackgroundTransparency = 0.1}, 0.15)
    end)
    
    button.MouseButton1Click:Connect(function()
        Utility.Ripple(button, Mouse.X, Mouse.Y)
        if IsMobile then Utility.Haptic(0.15) end
        if options.Callback then
            Utility.SafeCall(options.Callback)
        end
    end)
    
    table.insert(self.Elements, {Type = "IconButton", Frame = container, Button = button})
    
    return {
        SetText = function(_, text)
            titleLabel.Text = text
        end,
        SetCallback = function(_, callback)
            options.Callback = callback
        end,
        Fire = function(_)
            if options.Callback then Utility.SafeCall(options.Callback) end
        end
    }
end

function Section:AddIconButton(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "IconButton",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, 42),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    local button = Utility.Create("TextButton", {
        Name = "Btn",
        Parent = container,
        BackgroundColor3 = theme.Accent,
        BackgroundTransparency = 0.2,
        Size = UDim2.new(1, -16, 0, 30),
        Position = UDim2.new(0, 8, 0, 6),
        Text = "",
        AutoButtonColor = false,
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = button})
    
    if options.Icon then
        Utility.Create("ImageLabel", {
            Name = "Icon",
            Parent = button,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 18, 0, 18),
            Position = UDim2.new(0, 10, 0.5, 0),
            AnchorPoint = Vector2.new(0, 0.5),
            Image = "rbxassetid://" .. options.Icon,
            ImageColor3 = theme.Text,
            ZIndex = 106
        })
    end
    
    Utility.Create("TextLabel", {
        Name = "Title",
        Parent = button,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, options.Icon and -45 or -20, 1, 0),
        Position = UDim2.new(0, options.Icon and 35 or 10, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = options.Title or "Icon Button",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextTruncate = Enum.TextTruncate.AtEnd,
        ZIndex = 106
    })
    
    button.MouseEnter:Connect(function()
        Utility.SmoothTween(button, {BackgroundTransparency = 0}, 0.15)
    end)
    
    button.MouseLeave:Connect(function()
        Utility.SmoothTween(button, {BackgroundTransparency = 0.2}, 0.15)
    end)
    
    button.MouseButton1Click:Connect(function()
        Utility.Ripple(button, Mouse.X, Mouse.Y)
        if IsMobile then Utility.Haptic(0.15) end
        if options.Callback then Utility.SafeCall(options.Callback) end
    end)
    
    table.insert(self.Elements, {Type = "IconButton", Frame = container, Button = button})
    
    return {
        SetText = function(_, text) button:FindFirstChild("Title").Text = text end,
        Fire = function(_) if options.Callback then Utility.SafeCall(options.Callback) end end
    }
end

-- ══════════════════════════════════════
-- SPACER
-- ══════════════════════════════════════
function Tab:AddSpacer(height)
    local spacer = Utility.Create("Frame", {
        Name = "Spacer",
        Parent = self.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, height or 10),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    table.insert(self.Elements, {Type = "Spacer", Frame = spacer})
    
    return {
        Destroy = function(_)
            spacer:Destroy()
        end
    }
end

function Section:AddSpacer(height)
    local spacer = Utility.Create("Frame", {
        Name = "Spacer",
        Parent = self.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, height or 8),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    table.insert(self.Elements, {Type = "Spacer", Frame = spacer})
    
    return {Destroy = function(_) spacer:Destroy() end}
end

-- ══════════════════════════════════════
-- LOADING INDICATOR
-- ══════════════════════════════════════
local LoadingIndicator = {}

function iHook:CreateLoadingIndicator(options)
    options = options or {}
    local theme = self.Theme
    local scale = Utility.GetScale()
    
    local text = options.Text or "Loading..."
    local persistent = options.Persistent or false
    
    local overlay = Utility.Create("Frame", {
        Name = "LoadingOverlay",
        Parent = self.ScreenGui,
        BackgroundColor3 = Color3.new(0, 0, 0),
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 10000
    })
    
    local container = Utility.Create("Frame", {
        Name = "LoadingContainer",
        Parent = overlay,
        BackgroundColor3 = theme.Primary,
        Size = UDim2.new(0, 0, 0, 0),
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        ZIndex = 10001
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 12), Parent = container})
    Utility.Create("UIStroke", {Parent = container, Color = theme.Border, Thickness = 1})
    
    -- Spinner
    local spinner = Utility.Create("Frame", {
        Name = "Spinner",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 40, 0, 40),
        Position = UDim2.new(0.5, 0, 0, 25),
        AnchorPoint = Vector2.new(0.5, 0),
        ZIndex = 10002
    })
    
    for i = 1, 8 do
        local dot = Utility.Create("Frame", {
            Name = "Dot" .. i,
            Parent = spinner,
            BackgroundColor3 = theme.Accent,
            Size = UDim2.new(0, 6, 0, 6),
            Position = UDim2.new(0.5, 0, 0.5, 0),
            AnchorPoint = Vector2.new(0.5, 0.5),
            ZIndex = 10003
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = dot})
        
        local angle = (i - 1) * (360 / 8)
        local rad = math.rad(angle)
        local x = math.cos(rad) * 15
        local y = math.sin(rad) * 15
        
        dot.Position = UDim2.new(0.5, x, 0.5, y)
        
        -- Animate opacity
        task.spawn(function()
            while dot and dot.Parent do
                local delay = (i - 1) * 0.1
                task.wait(delay)
                
                while dot and dot.Parent do
                    Utility.SmoothTween(dot, {BackgroundTransparency = 0.8}, 0.4)
                    task.wait(0.4)
                    if dot and dot.Parent then
                        Utility.SmoothTween(dot, {BackgroundTransparency = 0}, 0.4)
                        task.wait(0.4)
                    else
                        break
                    end
                end
            end
        end)
    end
    
    -- Rotate spinner
    task.spawn(function()
        while spinner and spinner.Parent do
            local currentRotation = spinner.Rotation
            Utility.Tween(spinner, {Rotation = currentRotation + 360}, 2, Enum.EasingStyle.Linear)
            task.wait(2)
        end
    end)
    
    -- Text
    local loadingText = Utility.Create("TextLabel", {
        Name = "Text",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -40, 0, 20),
        Position = UDim2.new(0, 20, 0, 75),
        Font = Enum.Font.GothamMedium,
        Text = text,
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        ZIndex = 10002
    })
    
    -- Show animation
    Utility.SmoothTween(overlay, {BackgroundTransparency = 0.6}, 0.2)
    Utility.BounceTween(container, {Size = UDim2.new(0, 200, 0, 110)}, 0.3)
    
    local indicatorObj = {
        Overlay = overlay,
        Container = container,
        
        SetText = function(self, newText)
            loadingText.Text = newText
        end,
        
        Close = function(self)
            Utility.SmoothTween(overlay, {BackgroundTransparency = 1}, 0.2)
            Utility.SmoothTween(container, {Size = UDim2.new(0, 0, 0, 0)}, 0.25)
            task.delay(0.25, function()
                overlay:Destroy()
            end)
        end,
        
        Destroy = function(self)
            overlay:Destroy()
        end
    }
    
    return indicatorObj
end

-- ══════════════════════════════════════
-- CONTEXT MENU
-- ══════════════════════════════════════
function iHook:CreateContextMenu(options)
    options = options or {}
    local theme = self.Theme
    local scale = Utility.GetScale()
    
    local items = options.Items or {}
    local position = options.Position or UDim2.new(0, Mouse.X, 0, Mouse.Y)
    
    -- Overlay (transparent, just for click detection)
    local overlay = Utility.Create("Frame", {
        Name = "ContextMenuOverlay",
        Parent = self.ScreenGui,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 600
    })
    
    -- Menu
    local menu = Utility.Create("Frame", {
        Name = "ContextMenu",
        Parent = overlay,
        BackgroundColor3 = theme.Secondary,
        Size = UDim2.new(0, 0, 0, 0),
        Position = position,
        ClipsDescendants = true,
        ZIndex = 601
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = menu})
    Utility.Create("UIStroke", {Parent = menu, Color = theme.Border, Thickness = 1})
    
    local menuList = Utility.Create("Frame", {
        Name = "List",
        Parent = menu,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 1, 0),
        ZIndex = 602
    })
    
    Utility.Create("UIListLayout", {
        Parent = menuList,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 2)
    })
    
    Utility.Create("UIPadding", {
        Parent = menuList,
        PaddingTop = UDim.new(0, 4),
        PaddingBottom = UDim.new(0, 4),
        PaddingLeft = UDim.new(0, 4),
        PaddingRight = UDim.new(0, 4)
    })
    
    local function closeMenu()
        Utility.SmoothTween(menu, {Size = UDim2.new(0, 0, 0, 0)}, 0.15)
        task.delay(0.15, function()
            overlay:Destroy()
        end)
    end
    
    -- Click outside to close
    overlay.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            closeMenu()
        end
    end)
    
    -- Create items
    for i, item in ipairs(items) do
        if item.Type == "Divider" then
            Utility.Create("Frame", {
                Name = "Divider",
                Parent = menuList,
                BackgroundColor3 = theme.Divider,
                Size = UDim2.new(1, -8, 0, 1),
                LayoutOrder = i,
                ZIndex = 602
            })
        else
            local itemBtn = Utility.Create("TextButton", {
                Name = "Item",
                Parent = menuList,
                BackgroundColor3 = theme.Tertiary,
                BackgroundTransparency = 0.5,
                Size = UDim2.new(1, -4, 0, 28),
                Font = Enum.Font.Gotham,
                Text = "",
                AutoButtonColor = false,
                LayoutOrder = i,
                ZIndex = 603
            })
            
            Utility.Create("UICorner", {CornerRadius = UDim.new(0, 5), Parent = itemBtn})
            
            -- Icon
            if item.Icon then
                Utility.Create("ImageLabel", {
                    Name = "Icon",
                    Parent = itemBtn,
                    BackgroundTransparency = 1,
                    Size = UDim2.new(0, 16, 0, 16),
                    Position = UDim2.new(0, 8, 0.5, 0),
                    AnchorPoint = Vector2.new(0, 0.5),
                    Image = "rbxassetid://" .. item.Icon,
                    ImageColor3 = theme.Text,
                    ZIndex = 604
                })
            end
            
            -- Text
            Utility.Create("TextLabel", {
                Name = "Text",
                Parent = itemBtn,
                BackgroundTransparency = 1,
                Size = UDim2.new(1, item.Icon and -32 or -16, 1, 0),
                Position = UDim2.new(0, item.Icon and 28 or 8, 0, 0),
                Font = Enum.Font.Gotham,
                Text = item.Title or "Item",
                TextColor3 = item.Disabled and theme.TextDisabled or theme.Text,
                TextSize = 12 * scale,
                TextXAlignment = Enum.TextXAlignment.Left,
                ZIndex = 604
            })
            
            if not item.Disabled then
                itemBtn.MouseEnter:Connect(function()
                    Utility.SmoothTween(itemBtn, {BackgroundColor3 = theme.Hover, BackgroundTransparency = 0.3}, 0.1)
                end)
                
                itemBtn.MouseLeave:Connect(function()
                    Utility.SmoothTween(itemBtn, {BackgroundColor3 = theme.Tertiary, BackgroundTransparency = 0.5}, 0.1)
                end)
                
                itemBtn.MouseButton1Click:Connect(function()
                    if item.Callback then
                        Utility.SafeCall(item.Callback)
                    end
                    closeMenu()
                end)
            end
        end
    end
    
    -- Calculate size and animate
    task.defer(function()
        task.wait()
        local layout = menuList:FindFirstChildOfClass("UIListLayout")
        if layout then
            local height = layout.AbsoluteContentSize.Y + 8
            local width = 180
            
            -- Check if menu goes off screen
            local screenSize = Camera.ViewportSize
            local finalX = position.X.Offset
            local finalY = position.Y.Offset
            
            if finalX + width > screenSize.X then
                finalX = screenSize.X - width - 10
            end
            
            if finalY + height > screenSize.Y then
                finalY = screenSize.Y - height - 10
            end
            
            menu.Position = UDim2.new(0, finalX, 0, finalY)
            Utility.SmoothTween(menu, {Size = UDim2.new(0, width, 0, height)}, 0.2)
        end
    end)
    
    return {
        Close = closeMenu,
        Destroy = function()
            overlay:Destroy()
        end
    }
end

-- ══════════════════════════════════════
-- SEARCH BOX
-- ══════════════════════════════════════
function Tab:AddSearchBox(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local placeholder = options.Placeholder or "Search..."
    local value = ""
    
    local container = Utility.Create("Frame", {
        Name = "SearchBox",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, 48),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    local searchFrame = Utility.Create("Frame", {
        Name = "SearchFrame",
        Parent = container,
        BackgroundColor3 = theme.InputBg,
        Size = UDim2.new(1, -20, 0, 34),
        Position = UDim2.new(0, 10, 0, 7),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 6), Parent = searchFrame})
    local searchStroke = Utility.Create("UIStroke", {Parent = searchFrame, Color = theme.Border, Thickness = 1})
    
    -- Search icon
    Utility.Create("TextLabel", {
        Name = "SearchIcon",
        Parent = searchFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(0, 30, 1, 0),
        Position = UDim2.new(0, 0, 0, 0),
        Font = Enum.Font.GothamBold,
        Text = "🔍",
        TextColor3 = theme.TextDark,
        TextSize = 14,
        ZIndex = 106
    })
    
    -- TextBox
    local textBox = Utility.Create("TextBox", {
        Name = "TextBox",
        Parent = searchFrame,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, -70, 1, 0),
        Position = UDim2.new(0, 30, 0, 0),
        Font = Enum.Font.Gotham,
        Text = "",
        PlaceholderText = placeholder,
        PlaceholderColor3 = theme.TextDisabled,
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ClearTextOnFocus = false,
        ZIndex = 107
    })
    
    -- Clear button
    local clearBtn = Utility.Create("TextButton", {
        Name = "Clear",
        Parent = searchFrame,
        BackgroundColor3 = theme.Error,
        BackgroundTransparency = 0.8,
        Size = UDim2.new(0, 22, 0, 22),
        Position = UDim2.new(1, -28, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        Font = Enum.Font.GothamBold,
        Text = "×",
        TextColor3 = theme.Error,
        TextSize = 16,
        Visible = false,
        AutoButtonColor = false,
        ZIndex = 108
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = clearBtn})
    
    textBox.Focused:Connect(function()
        Utility.SmoothTween(searchStroke, {Color = theme.Accent}, 0.15)
    end)
    
    textBox.FocusLost:Connect(function()
        Utility.SmoothTween(searchStroke, {Color = theme.Border}, 0.15)
    end)
    
    textBox:GetPropertyChangedSignal("Text"):Connect(function()
        value = textBox.Text
        clearBtn.Visible = value ~= ""
        
        if options.Callback then
            Utility.SafeCall(options.Callback, value)
        end
    end)
    
    clearBtn.MouseButton1Click:Connect(function()
        textBox.Text = ""
        value = ""
        clearBtn.Visible = false
        if options.Callback then Utility.SafeCall(options.Callback, "") end
    end)
    
    clearBtn.MouseEnter:Connect(function()
        Utility.SmoothTween(clearBtn, {BackgroundTransparency = 0.5}, 0.1)
    end)
    
    clearBtn.MouseLeave:Connect(function()
        Utility.SmoothTween(clearBtn, {BackgroundTransparency = 0.8}, 0.1)
    end)
    
    table.insert(self.Elements, {Type = "SearchBox", Frame = container})
    
    return {
        SetText = function(_, text)
            textBox.Text = text
            value = text
        end,
        GetText = function(_)
            return value
        end,
        Clear = function(_)
            textBox.Text = ""
            value = ""
            clearBtn.Visible = false
        end,
        Focus = function(_)
            textBox:CaptureFocus()
        end
    }
end

-- ══════════════════════════════════════
-- PROGRESS BAR
-- ══════════════════════════════════════
function Tab:AddProgressBar(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or 0
    local max = options.Max or 100
    local showPercent = options.ShowPercent ~= false
    
    local container = Utility.Create("Frame", {
        Name = "ProgressBar",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        Size = UDim2.new(1, 0, 0, 58),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    -- Title
    local titleLabel = Utility.Create("TextLabel", {
        Name = "Title",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 0, 18),
        Position = UDim2.new(0, 12, 0, 10),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Progress",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    -- Percentage
    local percentLabel = Utility.Create("TextLabel", {
        Name = "Percent",
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.3, -12, 0, 18),
        Position = UDim2.new(0.7, 0, 0, 10),
        Font = Enum.Font.GothamBold,
        Text = showPercent and math.floor((value / max) * 100) .. "%" or "",
        TextColor3 = theme.Accent,
        TextSize = 13 * scale,
        TextXAlignment = Enum.TextXAlignment.Right,
        ZIndex = 105
    })
    
    -- Bar background
    local barBg = Utility.Create("Frame", {
        Name = "BarBg",
        Parent = container,
        BackgroundColor3 = theme.SliderTrack,
        Size = UDim2.new(1, -24, 0, 10),
        Position = UDim2.new(0, 12, 1, -20),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = barBg})
    
    -- Bar fill
    local barFill = Utility.Create("Frame", {
        Name = "BarFill",
        Parent = barBg,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(value / max, 0, 1, 0),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = barFill})
    
    Utility.Create("UIGradient", {
        Parent = barFill,
        Color = ColorSequence.new(Color3.new(1,1,1)),
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 0.9),
            NumberSequenceKeypoint.new(1, 1)
        }),
        Rotation = 90
    })
    
    table.insert(self.Elements, {Type = "ProgressBar", Frame = container})
    
    return {
        SetValue = function(self, newValue)
            value = math.clamp(newValue, 0, max)
            local percent = value / max
            
            Utility.SmoothTween(barFill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.3)
            
            if showPercent then
                percentLabel.Text = math.floor(percent * 100) .. "%"
            end
        end,
        
        SetMax = function(self, newMax)
            max = newMax
            local percent = value / max
            barFill.Size = UDim2.new(percent, 0, 1, 0)
            if showPercent then
                percentLabel.Text = math.floor(percent * 100) .. "%"
            end
        end,
        
        GetValue = function(self)
            return value
        end,
        
        SetTitle = function(self, title)
            titleLabel.Text = title
        end
    }
end

function Section:AddProgressBar(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local value = options.Default or 0
    local max = options.Max or 100
    local showPercent = options.ShowPercent ~= false
    
    local container = Utility.Create("Frame", {
        Name = "ProgressBar",
        Parent = self.Content,
        BackgroundColor3 = theme.Tertiary,
        BackgroundTransparency = 0.5,
        Size = UDim2.new(1, 0, 0, 48),
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = container})
    
    local titleLabel = Utility.Create("TextLabel", {
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.7, 0, 0, 16),
        Position = UDim2.new(0, 10, 0, 6),
        Font = Enum.Font.GothamMedium,
        Text = options.Title or "Progress",
        TextColor3 = theme.Text,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 105
    })
    
    local percentLabel = Utility.Create("TextLabel", {
        Parent = container,
        BackgroundTransparency = 1,
        Size = UDim2.new(0.3, -10, 0, 16),
        Position = UDim2.new(0.7, 0, 0, 6),
        Font = Enum.Font.GothamBold,
        Text = showPercent and math.floor((value / max) * 100) .. "%" or "",
        TextColor3 = theme.Accent,
        TextSize = 12 * scale,
        TextXAlignment = Enum.TextXAlignment.Right,
        ZIndex = 105
    })
    
    local barBg = Utility.Create("Frame", {
        Parent = container,
        BackgroundColor3 = theme.SliderTrack,
        Size = UDim2.new(1, -20, 0, 8),
        Position = UDim2.new(0, 10, 1, -16),
        ZIndex = 105
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = barBg})
    
    local barFill = Utility.Create("Frame", {
        Parent = barBg,
        BackgroundColor3 = theme.Accent,
        Size = UDim2.new(value / max, 0, 1, 0),
        ZIndex = 106
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = barFill})
    
    table.insert(self.Elements, {Type = "ProgressBar", Frame = container})
    
    return {
        SetValue = function(self, newValue)
            value = math.clamp(newValue, 0, max)
            local percent = value / max
            Utility.SmoothTween(barFill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.3)
            if showPercent then percentLabel.Text = math.floor(percent * 100) .. "%" end
        end,
        GetValue = function(self) return value end
    }
end

-- ══════════════════════════════════════
-- CHIP / TAG
-- ══════════════════════════════════════
function Tab:AddChip(options)
    options = options or {}
    local theme = iHook.Theme
    local scale = Utility.GetScale()
    
    local container = Utility.Create("Frame", {
        Name = "ChipContainer",
        Parent = self.Content,
        BackgroundTransparency = 1,
        Size = UDim2.new(1, 0, 0, 0),
        AutomaticSize = Enum.AutomaticSize.Y,
        LayoutOrder = #self.Elements + 1,
        ZIndex = 104
    })
    
    Utility.Create("UIListLayout", {
        Parent = container,
        FillDirection = Enum.FillDirection.Horizontal,
        HorizontalAlignment = Enum.HorizontalAlignment.Left,
        VerticalAlignment = Enum.VerticalAlignment.Top,
        Padding = UDim.new(0, 6),
        SortOrder = Enum.SortOrder.LayoutOrder,
        Wraps = true
    })
    
    Utility.Create("UIPadding", {
        Parent = container,
        PaddingTop = UDim.new(0, 4),
        PaddingBottom = UDim.new(0, 4),
        PaddingLeft = UDim.new(0, 4),
        PaddingRight = UDim.new(0, 4)
    })
    
    local chips = options.Chips or {"Chip"}
    
    for i, chipText in ipairs(chips) do
        local chip = Utility.Create("Frame", {
            Name = "Chip",
            Parent = container,
            BackgroundColor3 = theme.Accent,
            BackgroundTransparency = 0.8,
            Size = UDim2.new(0, 0, 0, 26),
            AutomaticSize = Enum.AutomaticSize.X,
            LayoutOrder = i,
            ZIndex = 105
        })
        
        Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = chip})
        
        local chipLabel = Utility.Create("TextLabel", {
            Parent = chip,
            BackgroundTransparency = 1,
            Size = UDim2.new(0, 0, 1, 0),
            AutomaticSize = Enum.AutomaticSize.X,
            Font = Enum.Font.GothamMedium,
            Text = chipText,
            TextColor3 = theme.Accent,
            TextSize = 11 * scale,
            ZIndex = 106
        })
        
        Utility.Create("UIPadding", {
            Parent = chipLabel,
            PaddingLeft = UDim.new(0, 12),
            PaddingRight = UDim.new(0, 12)
        })
    end
    
    table.insert(self.Elements, {Type = "Chip", Frame = container})
    
    return {
        AddChip = function(_, text)
            local chip = Utility.Create("Frame", {
                Parent = container,
                BackgroundColor3 = theme.Accent,
                BackgroundTransparency = 0.8,
                Size = UDim2.new(0, 0, 0, 26),
                AutomaticSize = Enum.AutomaticSize.X,
                ZIndex = 105
            })
            Utility.Create("UICorner", {CornerRadius = UDim.new(1, 0), Parent = chip})
            local label = Utility.Create("TextLabel", {Parent = chip, BackgroundTransparency = 1, Size = UDim2.new(0, 0, 1, 0), AutomaticSize = Enum.AutomaticSize.X, Font = Enum.Font.GothamMedium, Text = text, TextColor3 = theme.Accent, TextSize = 11 * scale, ZIndex = 106})
            Utility.Create("UIPadding", {Parent = label, PaddingLeft = UDim.new(0, 12), PaddingRight = UDim.new(0, 12)})
        end,
        Clear = function(_)
            for _, child in pairs(container:GetChildren()) do
                if child:IsA("Frame") then child:Destroy() end
            end
        end
    }
end

-- ══════════════════════════════════════
-- UPDATE THEME METHOD
-- ══════════════════════════════════════
function Window:UpdateTheme()
    local theme = iHook.Theme
    
    -- Update main frame colors
    if self.Frame then
        self.Frame.BackgroundColor3 = theme.Primary
        self.Frame:FindFirstChild("UIStroke").Color = theme.Border
    end
    
    if self.TitleBar then
        self.TitleBar.BackgroundColor3 = theme.Secondary
    end
    
    if self.TabContainer then
        self.TabContainer.BackgroundColor3 = theme.Secondary
    end
    
    if self.ContentContainer then
        self.ContentContainer.BackgroundColor3 = theme.Background
    end
    
    -- Update all tabs
    for _, tab in pairs(self.Tabs) do
        if tab.Button then
            if tab.Selected then
                tab.Button.BackgroundColor3 = theme.TabActive
            else
                tab.Button.BackgroundColor3 = theme.TabInactive
            end
        end
        
        if tab.Indicator then
            tab.Indicator.BackgroundColor3 = theme.Accent
        end
    end
end
-- ══════════════════════════════════════
-- CLEANUP & DESTROY METHODS
-- ══════════════════════════════════════
function iHook:Unload()
    if self.Unloaded then return end
    self.Unloaded = true
    
    -- Disconnect all connections
    for _, conn in pairs(self.Connections) do
        if conn and conn.Disconnect then
            pcall(function() conn:Disconnect() end)
        end
    end
    
    -- Destroy all windows
    for _, window in pairs(self.Windows) do
        if window and window.Close then
            pcall(function() window:Close() end)
        end
    end
    
    -- Destroy ScreenGui
    if self.ScreenGui then
        pcall(function() self.ScreenGui:Destroy() end)
    end
    
    -- Clear tables
    self.Options = {}
    self.Flags = {}
    self.Windows = {}
    self.Connections = {}
    
    -- Notification
    print("[iHook] Library unloaded successfully")
end

function Window:Destroy()
    self:Close()
end

function Tab:Destroy()
    if self.Content then
        self.Content:Destroy()
    end
    
    if self.Button then
        self.Button:Destroy()
    end
    
    for i, tab in pairs(self.Window.Tabs) do
        if tab.ID == self.ID then
            table.remove(self.Window.Tabs, i)
            break
        end
    end
end

function Section:Destroy()
    if self.Frame then
        self.Frame:Destroy()
    end
    
    for i, section in pairs(self.Tab.Sections) do
        if section.ID == self.ID then
            table.remove(self.Tab.Sections, i)
            break
        end
    end
end

-- ══════════════════════════════════════
-- SAVE/LOAD CONFIG SYSTEM
-- ══════════════════════════════════════
local ConfigManager = {}

function ConfigManager:SaveConfig(configName)
    configName = configName or "default"
    
    local config = {}
    
    for flag, value in pairs(iHook.Flags) do
        if type(value) == "Color3" then
            config[flag] = {
                Type = "Color3",
                R = value.R,
                G = value.G,
                B = value.B
            }
        elseif type(value) == "table" then
            config[flag] = {
                Type = "Table",
                Value = Utility.DeepCopy(value)
            }
        else
            config[flag] = {
                Type = type(value),
                Value = value
            }
        end
    end
    
    local success, encoded = pcall(function()
        return HttpService:JSONEncode(config)
    end)
    
    if success then
        local folderName = "iHook_Configs"
        local fileName = configName .. ".json"
        
        if writefile then
            if not isfolder(folderName) then
                makefolder(folderName)
            end
            writefile(folderName .. "/" .. fileName, encoded)
            
            iHook:Notify({
                Title = "Config Saved",
                Content = "Configuration '" .. configName .. "' saved successfully",
                Type = "Success",
                Duration = 3
            })
            
            return true
        else
            warn("[iHook] writefile not supported")
            return false
        end
    else
        warn("[iHook] Failed to encode config:", encoded)
        return false
    end
end

function ConfigManager:LoadConfig(configName)
    configName = configName or "default"
    
    local folderName = "iHook_Configs"
    local fileName = configName .. ".json"
    local filePath = folderName .. "/" .. fileName
    
    if readfile and isfile and isfile(filePath) then
        local success, content = pcall(function()
            return readfile(filePath)
        end)
        
        if success then
            local decoded = HttpService:JSONDecode(content)
            
            for flag, data in pairs(decoded) do
                local value
                
                if data.Type == "Color3" then
                    value = Color3.new(data.R, data.G, data.B)
                elseif data.Type == "Table" then
                    value = data.Value
                else
                    value = data.Value
                end
                
                -- Update flag
                iHook.Flags[flag] = value
                
                -- Update element if exists
                if iHook.Options[flag] then
                    local element = iHook.Options[flag]
                    if element.SetValue then
                        pcall(function()
                            element:SetValue(value, true) -- Skip callback
                        end)
                    end
                end
            end
            
            iHook:Notify({
                Title = "Config Loaded",
                Content = "Configuration '" .. configName .. "' loaded successfully",
                Type = "Success",
                Duration = 3
            })
            
            return true
        else
            warn("[iHook] Failed to read config file:", content)
            return false
        end
    else
        warn("[iHook] Config file not found:", filePath)
        return false
    end
end

function ConfigManager:DeleteConfig(configName)
    configName = configName or "default"
    
    local folderName = "iHook_Configs"
    local fileName = configName .. ".json"
    local filePath = folderName .. "/" .. fileName
    
    if delfile and isfile and isfile(filePath) then
        delfile(filePath)
        
        iHook:Notify({
            Title = "Config Deleted",
            Content = "Configuration '" .. configName .. "' deleted successfully",
            Type = "Warning",
            Duration = 3
        })
        
        return true
    else
        warn("[iHook] Config file not found:", filePath)
        return false
    end
end

function ConfigManager:ListConfigs()
    local folderName = "iHook_Configs"
    local configs = {}
    
    if listfiles and isfolder and isfolder(folderName) then
        local files = listfiles(folderName)
        
        for _, file in pairs(files) do
            local fileName = file:gsub(folderName .. "/", ""):gsub(".json", "")
            table.insert(configs, fileName)
        end
    end
    
    return configs
end

function ConfigManager:AutoSave(interval)
    interval = interval or 300 -- 5 minutes default
    
    task.spawn(function()
        while not iHook.Unloaded do
            task.wait(interval)
            ConfigManager:SaveConfig("autosave")
        end
    end)
end

iHook.ConfigManager = ConfigManager

-- ══════════════════════════════════════
-- SETTINGS TAB BUILDER
-- ══════════════════════════════════════
function iHook:BuildSettingsTab(tab)
    local section = tab:AddSection({Title = "UI Settings"})
    
    -- Theme selector
    local themes = self:GetAvailableThemes()
    section:AddDropdown("Theme", {
        Title = "Theme",
        Description = "Change UI theme",
        Values = themes,
        Default = self.CurrentTheme,
        Callback = function(value)
            self:SetTheme(value)
        end
    })
    
    -- Config section
    local configSection = tab:AddSection({Title = "Configuration"})
    
    local configName = "default"
    
    configSection:AddInput("ConfigName", {
        Title = "Config Name",
        Default = "default",
        Placeholder = "Enter config name...",
        Callback = function(value)
            configName = value
        end
    })
    
    configSection:AddButton({
        Title = "Save Config",
        Description = "Save current settings",
        Callback = function()
            ConfigManager:SaveConfig(configName)
        end
    })
    
    configSection:AddButton({
        Title = "Load Config",
        Description = "Load saved settings",
        Callback = function()
            ConfigManager:LoadConfig(configName)
        end
    })
    
    configSection:AddButton({
        Title = "Delete Config",
        Description = "Delete saved config",
        Callback = function()
            ConfigManager:DeleteConfig(configName)
        end
    })
    
    -- List configs
    local configs = ConfigManager:ListConfigs()
    if #configs > 0 then
        configSection:AddDropdown("SavedConfigs", {
            Title = "Saved Configs",
            Values = configs,
            Callback = function(value)
                configName = value
                iHook.Options.ConfigName:SetValue(value)
            end
        })
    end
    
    -- Performance section
    local perfSection = tab:AddSection({Title = "Performance"})
    
    perfSection:AddToggle("ReducedMotion", {
        Title = "Reduced Motion",
        Description = "Reduce animations for better performance",
        Default = false,
        Callback = function(value)
            -- Could implement animation speed modifications
        end
    })
    
    perfSection:AddToggle("LowQuality", {
        Title = "Low Quality Mode",
        Description = "Disable shadows and effects",
        Default = false,
        Callback = function(value)
            -- Could implement quality settings
        end
    })
end

-- ══════════════════════════════════════
-- UTILITY: ANTI-AFK
-- ══════════════════════════════════════
function iHook:EnableAntiAFK()
    local VirtualUser = game:GetService("VirtualUser")
    
    local antiAfkConnection = Player.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
    
    table.insert(self.Connections, antiAfkConnection)
    
    return {
        Disable = function()
            if antiAfkConnection then
                antiAfkConnection:Disconnect()
            end
        end
    }
end

-- ══════════════════════════════════════
-- UTILITY: FPS COUNTER
-- ══════════════════════════════════════
function iHook:CreateFPSCounter()
    local theme = self.Theme
    
    local fpsLabel = Utility.Create("TextLabel", {
        Name = "FPSCounter",
        Parent = self.ScreenGui,
        BackgroundColor3 = theme.Primary,
        BackgroundTransparency = 0.3,
        Size = UDim2.new(0, 80, 0, 30),
        Position = UDim2.new(1, -90, 0, SafeAreaInsets.Top + 10),
        Font = Enum.Font.GothamBold,
        Text = "0 FPS",
        TextColor3 = theme.Text,
        TextSize = 14,
        ZIndex = 99998
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = fpsLabel})
    Utility.Create("UIStroke", {Parent = fpsLabel, Color = theme.Border, Thickness = 1, Transparency = 0.5})
    
    local lastUpdate = tick()
    local fps = 0
    
    local connection = RunService.RenderStepped:Connect(function()
        local now = tick()
        fps = math.floor(1 / (now - lastUpdate))
        lastUpdate = now
        
        fpsLabel.Text = fps .. " FPS"
        
        -- Color based on FPS
        if fps >= 55 then
            fpsLabel.TextColor3 = theme.Success
        elseif fps >= 30 then
            fpsLabel.TextColor3 = theme.Warning
        else
            fpsLabel.TextColor3 = theme.Error
        end
    end)
    
    table.insert(self.Connections, connection)
    
    return {
        Destroy = function()
            if connection then connection:Disconnect() end
            fpsLabel:Destroy()
        end,
        GetFPS = function()
            return fps
        end
    }
end

-- ══════════════════════════════════════
-- UTILITY: WATERMARK
-- ══════════════════════════════════════
function iHook:CreateWatermark(text)
    local theme = self.Theme
    local scale = Utility.GetScale()
    
    local watermark = Utility.Create("TextLabel", {
        Name = "Watermark",
        Parent = self.ScreenGui,
        BackgroundColor3 = theme.Primary,
        BackgroundTransparency = 0.2,
        Size = UDim2.new(0, 0, 0, 28),
        AutomaticSize = Enum.AutomaticSize.X,
        Position = UDim2.new(0, 10, 0, SafeAreaInsets.Top + 10),
        Font = Enum.Font.GothamBold,
        Text = text or "iHook",
        TextColor3 = theme.Text,
        TextSize = 13 * scale,
        ZIndex = 99998
    })
    
    Utility.Create("UICorner", {CornerRadius = UDim.new(0, 8), Parent = watermark})
    Utility.Create("UIStroke", {Parent = watermark, Color = theme.Accent, Thickness = 1, Transparency = 0.5})
    Utility.Create("UIPadding", {Parent = watermark, PaddingLeft = UDim.new(0, 12), PaddingRight = UDim.new(0, 12)})
    
    -- Gradient effect
    Utility.Create("UIGradient", {
        Parent = watermark,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, theme.Accent),
            ColorSequenceKeypoint.new(1, theme.AccentDark)
        }),
        Rotation = 45,
        Transparency = NumberSequence.new({
            NumberSequenceKeypoint.new(0, 0.95),
            NumberSequenceKeypoint.new(1, 1)
        })
    })
    
    return {
        SetText = function(_, newText)
            watermark.Text = newText
        end,
        Destroy = function()
            watermark:Destroy()
        end
    }
end

-- ══════════════════════════════════════
-- FINALIZATION
-- ══════════════════════════════════════

-- Set default values
iHook.DefaultWindow = nil

-- Create default window method
function iHook:MakeDefault(window)
    self.DefaultWindow = window
end

-- Quick access to default window
function iHook:GetDefaultWindow()
    return self.DefaultWindow
end

-- Version info
function iHook:GetVersion()
    return self.Version
end

function iHook:GetPlatform()
    return self.Platform
end

-- Global expose
getgenv().iHook = iHook
_G.iHook = iHook

-- Success message
print([[
╔════════════════════════════════════════════════════════════╗
║                    iHook UI Library                        ║
║                      Version 1.0.0                         ║
║                                                            ║
║  Premium Roblox Executor UI Framework                     ║
║  PC + Mobile Fully Optimized                              ║
║                                                            ║
║  Loaded Successfully!                                      ║
╚════════════════════════════════════════════════════════════╝
]])

-- Return library
return iHook

--[[
════════════════════════════════════════════════════════════════
                        USAGE EXAMPLE
════════════════════════════════════════════════════════════════

-- Load library
local iHook = loadstring(game:HttpGet("YOUR_URL_HERE"))()

-- Create window
local Window = iHook:CreateWindow({
    Title = "iHook Example",
    SubTitle = "by YourName",
    Size = UDim2.fromOffset(580, 460),
    TabWidth = 60
})

-- Create tabs
local MainTab = Window:AddTab({
    Title = "Main",
    Icon = "home"
})

local SettingsTab = Window:AddTab({
    Title = "Settings",
    Icon = "settings"
})

-- Add elements to Main tab
MainTab:AddParagraph({
    Title = "Welcome!",
    Content = "This is iHook UI Library.\nFull featured and mobile optimized!"
})

MainTab:AddButton({
    Title = "Click Me",
    Description = "Test button",
    Callback = function()
        print("Button clicked!")
    end
})

local MyToggle = MainTab:AddToggle("MyToggle", {
    Title = "Toggle",
    Description = "Enable or disable feature",
    Default = false,
    Callback = function(value)
        print("Toggle:", value)
    end
})

local MySlider = MainTab:AddSlider("MySlider", {
    Title = "Slider",
    Description = "Adjust value",
    Min = 0,
    Max = 100,
    Default = 50,
    Rounding = 0,
    Callback = function(value)
        print("Slider:", value)
    end
})

local MyDropdown = MainTab:AddDropdown("MyDropdown", {
    Title = "Dropdown",
    Values = {"Option 1", "Option 2", "Option 3"},
    Default = "Option 1",
    Callback = function(value)
        print("Selected:", value)
    end
})

local MyInput = MainTab:AddInput("MyInput", {
    Title = "Input",
    Placeholder = "Enter text...",
    Default = "",
    Callback = function(value)
        print("Input:", value)
    end
})

local MyKeybind = MainTab:AddKeybind("MyKeybind", {
    Title = "Keybind",
    Default = "E",
    Mode = "Toggle",
    Callback = function(value)
        print("Keybind pressed:", value)
    end
})

local MyColorpicker = MainTab:AddColorpicker("MyColorpicker", {
    Title = "Color",
    Default = Color3.fromRGB(255, 255, 255),
    Callback = function(color)
        print("Color:", color)
    end
})

-- Section example
local MySection = MainTab:AddSection({
    Title = "Section Example"
})

MySection:AddButton({
    Title = "Section Button",
    Callback = function()
        print("Section button clicked!")
    end
})

MySection:AddToggle("SectionToggle", {
    Title = "Section Toggle",
    Default = false
})

-- Build settings tab
iHook:BuildSettingsTab(SettingsTab)

-- Notifications
iHook:Notify({
    Title = "Script Loaded",
    Content = "iHook UI loaded successfully!",
    Type = "Success",
    Duration = 5
})

-- Dialog example
Window:Dialog({
    Title = "Confirmation",
    Content = "Do you want to proceed?",
    Buttons = {
        {
            Title = "Yes",
            Callback = function()
                print("Confirmed")
            end
        },
        {
            Title = "No",
            Callback = function()
                print("Cancelled")
            end
        }
    }
})

-- FPS Counter (optional)
local FPSCounter = iHook:CreateFPSCounter()

-- Watermark (optional)
local Watermark = iHook:CreateWatermark("iHook v1.0.0")

-- Anti-AFK (optional)
local AntiAFK = iHook:EnableAntiAFK()

-- Select first tab
Window:SelectTab(1)

-- Access flags
print(iHook.Flags.MyToggle) -- true/false
print(iHook.Flags.MySlider) -- number

-- Access options
iHook.Options.MyToggle:SetValue(true)
iHook.Options.MySlider:SetValue(75)

-- Save/Load configs
iHook.ConfigManager:SaveConfig("myconfig")
iHook.ConfigManager:LoadConfig("myconfig")

-- Auto-save every 5 minutes
iHook.ConfigManager:AutoSave(300)

-- Unload library
-- iHook:Unload()

════════════════════════════════════════════════════════════════
                        ADVANCED EXAMPLES
════════════════════════════════════════════════════════════════

-- Multi-dropdown
local MultiDrop = MainTab:AddDropdown("Multi", {
    Title = "Multi Select",
    Values = {"A", "B", "C", "D"},
    Multi = true,
    Default = {"A", "C"},
    Callback = function(selected)
        for option, state in pairs(selected) do
            print(option, state)
        end
    end
})

-- Colorpicker with transparency
local ColorWithAlpha = MainTab:AddColorpicker("ColorAlpha", {
    Title = "Color + Alpha",
    Default = Color3.fromRGB(255, 0, 0),
    Transparency = 0,
    Callback = function(color, transparency)
        print("Color:", color, "Alpha:", transparency)
    end
})

-- Progress bar
local Progress = MainTab:AddProgressBar({
    Title = "Loading",
    Default = 0,
    Max = 100
})

-- Update progress
for i = 0, 100, 10 do
    wait(0.1)
    Progress:SetValue(i)
end

-- Icon button
MainTab:AddIconButton({
    Title = "Open Link",
    Icon = "1234567890", -- Roblox asset ID
    Callback = function()
        print("Icon button clicked")
    end
})

-- Search box
local SearchBox = MainTab:AddSearchBox({
    Placeholder = "Search...",
    Callback = function(query)
        print("Searching:", query)
    end
})

-- Context menu
local ContextMenu = iHook:CreateContextMenu({
    Position = UDim2.new(0, 100, 0, 100),
    Items = {
        {Title = "Copy", Icon = "1234567890", Callback = function() print("Copy") end},
        {Title = "Paste", Icon = "1234567890", Callback = function() print("Paste") end},
        {Type = "Divider"},
        {Title = "Delete", Icon = "1234567890", Callback = function() print("Delete") end}
    }
})

-- Loading indicator
local Loading = iHook:CreateLoadingIndicator({
    Text = "Please wait..."
})

wait(3)
Loading:Close()

-- Chips/Tags
local Chips = MainTab:AddChip({
    Chips = {"Tag1", "Tag2", "Tag3"}
})

Chips:AddChip("NewTag")

-- Theme management
iHook:SetTheme("Midnight") -- Dark, Midnight, Ocean, Rose
iHook:AddTheme("Custom", {
    Primary = Color3.fromRGB(20, 20, 25),
    Accent = Color3.fromRGB(255, 100, 200),
    -- ... all other colors
})

════════════════════════════════════════════════════════════════
                        MOBILE OPTIMIZATIONS
════════════════════════════════════════════════════════════════

-- Library automatically detects mobile and applies:
-- - Larger hitboxes for touch
-- - Haptic feedback on interactions
-- - Responsive scaling
-- - Touch-friendly sliders and color pickers
-- - Safe area detection (notch support)
-- - Reduced element sizes
-- - Touch gesture support

-- Manual platform check
if iHook.IsMobile then
    print("Running on mobile device")
elseif iHook.IsTablet then
    print("Running on tablet")
else
    print("Running on PC")
end

════════════════════════════════════════════════════════════════
                        TIPS & BEST PRACTICES
════════════════════════════════════════════════════════════════

1. Always use flags for values you need to access later:
   MainTab:AddToggle("MyFlag", {...})
   local value = iHook.Flags.MyFlag

2. Use sections to organize related elements

3. Save configs regularly:
   iHook.ConfigManager:AutoSave(300)

4. Use OnChanged for real-time updates:
   Toggle:OnChanged(function(value)
       -- Update instantly
   end)

5. Clean up when done:
   iHook:Unload()

6. Use descriptions to help users understand elements

7. Group similar functionality in the same tab

8. Use dialogs for important confirmations

9. Provide visual feedback with notifications

10. Test on both PC and mobile if possible

════════════════════════════════════════════════════════════════

SUPPORT & DOCUMENTATION
- Full API reference available
- All elements support Callback, OnChanged, SetValue
- Mobile gestures automatically handled
- Cross-platform compatibility guaranteed
- Regular updates and bug fixes

════════════════════════════════════════════════════════════════
]]

